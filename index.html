<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CPT+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"fang0407.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.18.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="NOTE">
<meta property="og:url" content="https://fang0407.github.io/index.html">
<meta property="og:site_name" content="NOTE">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Fang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://fang0407.github.io/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>NOTE</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">NOTE</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Fang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">79</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2024/04/19/RTC%E6%8E%A8%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/" class="post-title-link" itemprop="url">RTC推流</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-04-19 20:13:12" itemprop="dateCreated datePublished" datetime="2024-04-19T20:13:12+08:00">2024-04-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-04-24 22:15:44" itemprop="dateModified" datetime="2024-04-24T22:15:44+08:00">2024-04-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebRTC/" itemprop="url" rel="index"><span itemprop="name">WebRTC</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="动态链接库导出"><a href="#动态链接库导出" class="headerlink" title="动态链接库导出"></a>动态链接库导出</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> STATIC_LIB</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MY_API</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> MY_API_EXPORT</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(_MSC_VER)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MY_API __declspec(dllexport)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MY_API</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(_MSC_VER)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MY_API __declspec(dllimport)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MY_API</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<h1 id="线程模型"><a href="#线程模型" class="headerlink" title="线程模型"></a>线程模型</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;rtc_base/thread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;rtc_base/task_utils/to_queued_task.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;rtc_base/task_utils/pending_task_safety_flag.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::unique_ptr&lt;rtc::Thread&gt; <span class="title">thread</span><span class="params">(rtc::Thread::Create())</span></span>;</span><br><span class="line">    thread_-&gt;<span class="built_in">SetName</span>(<span class="string">&quot;my_thread&quot;</span>, <span class="literal">nullptr</span>);</span><br><span class="line">    thread_-&gt;<span class="built_in">Start</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 两个线程之间的同步调用</span></span><br><span class="line">    thread-&gt;<span class="built_in">Invoke</span>&lt;<span class="type">void</span>&gt;(RTC_FROM_HERE, []() -&gt; <span class="type">void</span> &#123; std::cout &lt;&lt; <span class="string">&quot;Invoke Call&quot;</span> &lt;&lt; std::endl; &#125;);</span><br><span class="line">    <span class="comment">// 两个线程之间的异步调用</span></span><br><span class="line">    thread_-&gt;<span class="built_in">PostTask</span>(webrtc::<span class="built_in">ToQueuedTask</span>([]()&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;PostTask Call&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">      &#125;));</span><br><span class="line">    <span class="comment">// PostDelayedTask</span></span><br><span class="line">    <span class="type">uint32_t</span> milliseconds = <span class="number">10</span>;</span><br><span class="line">    webrtc::ScopedTaskSafety task_safety;</span><br><span class="line">    <span class="comment">// 如果task_safety被111销毁就不会触发里面的函数执行</span></span><br><span class="line">    thread_-&gt;<span class="built_in">PostDelayedTask</span>(webrtc::<span class="built_in">ToQueuedTask</span>(task_safety, []()&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;PostDelayedTask Call&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">      &#125;), milliseconds);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取指向当前线程类的指针</span></span><br><span class="line">    rtc::Thread* current_thread = rtc::Thread::<span class="built_in">Current</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>定时器 crash 问题解决</p>
<ul>
<li>原因：因为定时器是利用了线程提供的延迟调用功能，由于线程是全局的，定时器所在的对象可能已经被销毁了，但是定时器还在运转，此时定时器触发的方法里面还在访问这些对象，就会引发 crash</li>
<li>引入 <code>webrtc::ScopedTaskSafety task_safety</code></li>
</ul>
<h1 id="视频采集"><a href="#视频采集" class="headerlink" title="视频采集"></a>视频采集</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;atomic&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;modules/video_capture/video_capture.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;modules/video_capture/video_capture_factory.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">MainMediaType</span> &#123;</span><br><span class="line">    kMainTypeCommon,</span><br><span class="line">    kMainTypeAudio,</span><br><span class="line">    kMainTypeVideo,</span><br><span class="line">    kMainTypeData</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum class</span> <span class="title class_">SubMediaType</span> &#123;</span><br><span class="line">    kSubTypeCommon,</span><br><span class="line">    kSubTypeI420,</span><br><span class="line">    kSubTypeH264,</span><br><span class="line">    kSubTypePcm,</span><br><span class="line">    kSubTypeOpus,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">AudioFormat</span> &#123;</span><br><span class="line">    SubMediaType type;</span><br><span class="line">    <span class="type">size_t</span> nbytes_per_sample; <span class="comment">// 16bit</span></span><br><span class="line">    <span class="type">size_t</span> samples_per_channel; <span class="comment">// 每个声道的采样数</span></span><br><span class="line">    <span class="type">size_t</span> channels;</span><br><span class="line">    <span class="type">uint32_t</span> samples_per_sec;</span><br><span class="line">    <span class="type">uint32_t</span> total_delay_ms;</span><br><span class="line">    <span class="type">bool</span> key_pressed;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">VideoFormat</span> &#123;</span><br><span class="line">    SubMediaType type;</span><br><span class="line">    <span class="type">int</span> width;</span><br><span class="line">    <span class="type">int</span> height;</span><br><span class="line">    <span class="type">bool</span> idr;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MediaFormat</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    MainMediaType media_type;</span><br><span class="line">    <span class="keyword">union</span> &#123;</span><br><span class="line">        AudioFormat audio_fmt;</span><br><span class="line">        VideoFormat video_fmt;</span><br><span class="line">    &#125; sub_fmt;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MediaFrame</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MediaFrame</span>(<span class="type">int</span> size) : <span class="built_in">max_size</span>(size) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(data, <span class="number">0</span>, <span class="built_in">sizeof</span>(data));</span><br><span class="line">        <span class="built_in">memset</span>(data_len, <span class="number">0</span>, <span class="built_in">sizeof</span>(data_len));</span><br><span class="line">        <span class="built_in">memset</span>(stride, <span class="number">0</span>, <span class="built_in">sizeof</span>(stride));</span><br><span class="line">        data[<span class="number">0</span>] = <span class="keyword">new</span> <span class="type">char</span>[size];</span><br><span class="line">        data_len[<span class="number">0</span>] = size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">MediaFrame</span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> (data[<span class="number">0</span>]) &#123;</span><br><span class="line">            <span class="keyword">delete</span>[] data[<span class="number">0</span>];</span><br><span class="line">            data[<span class="number">0</span>] = <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> max_size;</span><br><span class="line">    MediaFormat fmt;</span><br><span class="line">    <span class="type">char</span>* data[<span class="number">4</span>];</span><br><span class="line">    <span class="type">int</span> data_len[<span class="number">4</span>];</span><br><span class="line">    <span class="type">int</span> stride[<span class="number">4</span>];</span><br><span class="line">    <span class="type">uint32_t</span> ts = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int64_t</span> capture_time_ms = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 回调获取采集数据</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyVideoSink</span> : <span class="keyword">public</span> rtc::VideoSinkInterface&lt;webrtc::VideoFrame&gt;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">OnFrame</span><span class="params">(<span class="type">const</span> webrtc::VideoFrame&amp; frame)</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="number">0</span> == last_frame_ts_) &#123;</span><br><span class="line">             last_frame_ts_ = rtc::<span class="built_in">Time</span>();</span><br><span class="line">         &#125;</span><br><span class="line">        </span><br><span class="line">        fps_++;</span><br><span class="line">        <span class="type">int64_t</span> now = rtc::<span class="built_in">Time</span>();</span><br><span class="line">        <span class="keyword">if</span> (now - last_frame_ts_ &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;fps: &quot;</span> &lt;&lt; fps_ &lt;&lt; std::endl;</span><br><span class="line">            fps_ = <span class="number">0</span>;</span><br><span class="line">            last_frame_ts_ = now;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">int</span> src_width = frame.<span class="built_in">width</span>();</span><br><span class="line">        <span class="type">int</span> src_height = frame.<span class="built_in">height</span>();</span><br><span class="line">        <span class="comment">// 对于640x480的图像，stridey为640，strideu和stridev为320</span></span><br><span class="line">        <span class="type">int</span> stridey = frame.<span class="built_in">video_frame_buffer</span>()-&gt;<span class="built_in">GetI420</span>()-&gt;<span class="built_in">StrideY</span>();</span><br><span class="line">        <span class="type">int</span> strideu = frame.<span class="built_in">video_frame_buffer</span>()-&gt;<span class="built_in">GetI420</span>()-&gt;<span class="built_in">StrideU</span>();</span><br><span class="line">        <span class="type">int</span> stridev = frame.<span class="built_in">video_frame_buffer</span>()-&gt;<span class="built_in">GetI420</span>()-&gt;<span class="built_in">StrideV</span>();</span><br><span class="line">       </span><br><span class="line">        <span class="comment">// Y + U + V</span></span><br><span class="line">        <span class="type">int</span> size = stridey * src_height + (strideu + stridev) * ((src_height + <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">    </span><br><span class="line">        std::shared_ptr&lt;MediaFrame&gt; video_frame = std::<span class="built_in">make_shared</span>&lt;MediaFrame&gt;(size);</span><br><span class="line">        video_frame-&gt;fmt.media_type = MainMediaType::kMainTypeVideo;</span><br><span class="line">        video_frame-&gt;fmt.sub_fmt.video_fmt.type = SubMediaType::kSubTypeI420;</span><br><span class="line">        video_frame-&gt;fmt.sub_fmt.video_fmt.width = src_width;</span><br><span class="line">        video_frame-&gt;fmt.sub_fmt.video_fmt.height = src_height;</span><br><span class="line">        video_frame-&gt;stride[<span class="number">0</span>] = stridey;</span><br><span class="line">        video_frame-&gt;stride[<span class="number">1</span>] = strideu;</span><br><span class="line">        video_frame-&gt;stride[<span class="number">2</span>] = stridev;</span><br><span class="line">        <span class="comment">// 每个平面大小</span></span><br><span class="line">        video_frame-&gt;data_len[<span class="number">0</span>] = stridey * src_height;</span><br><span class="line">        video_frame-&gt;data_len[<span class="number">1</span>] = strideu * ((src_height + <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">        video_frame-&gt;data_len[<span class="number">2</span>] = stridev * ((src_height + <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">        <span class="comment">// 拷贝每个分量数据</span></span><br><span class="line">        video_frame-&gt;data[<span class="number">1</span>] = video_frame-&gt;data[<span class="number">0</span>] + video_frame-&gt;data_len[<span class="number">0</span>];</span><br><span class="line">        video_frame-&gt;data[<span class="number">2</span>] = video_frame-&gt;data[<span class="number">1</span>] + video_frame-&gt;data_len[<span class="number">1</span>];</span><br><span class="line">        <span class="built_in">memcpy</span>(video_frame-&gt;data[<span class="number">0</span>], </span><br><span class="line">               frame.<span class="built_in">video_frame_buffer</span>()-&gt;<span class="built_in">GetI420</span>()-&gt;<span class="built_in">DataY</span>(), </span><br><span class="line">               video_frame-&gt;data_len[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">memcpy</span>(video_frame-&gt;data[<span class="number">1</span>], </span><br><span class="line">               frame.<span class="built_in">video_frame_buffer</span>()-&gt;<span class="built_in">GetI420</span>()-&gt;<span class="built_in">DataU</span>(), </span><br><span class="line">               video_frame-&gt;data_len[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">memcpy</span>(video_frame-&gt;data[<span class="number">2</span>], </span><br><span class="line">               frame.<span class="built_in">video_frame_buffer</span>()-&gt;<span class="built_in">GetI420</span>()-&gt;<span class="built_in">DataV</span>(),</span><br><span class="line">               video_frame-&gt;data_len[<span class="number">2</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span> == start_time_) &#123;</span><br><span class="line">            start_time_ = frame.<span class="built_in">render_time_ms</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        video_frame-&gt;ts = <span class="built_in">static_cast</span>&lt;<span class="type">uint32_t</span>&gt;(frame.<span class="built_in">render_time_ms</span>() - start_time_);</span><br><span class="line">        video_frame-&gt;capture_time_ms = frame.<span class="built_in">render_time_ms</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::atomic&lt;<span class="type">int</span>&gt; fps_&#123; <span class="number">0</span> &#125;;</span><br><span class="line">    std::atomic&lt;<span class="type">int64_t</span>&gt; last_frame_ts_&#123; <span class="number">0</span> &#125;;</span><br><span class="line">    std::atomic&lt;<span class="type">int64_t</span>&gt; start_time_&#123; <span class="number">0</span> &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::unique_ptr&lt;webrtc::VideoCaptureModule::DeviceInfo&gt;</span></span><br><span class="line"><span class="function">        <span class="title">video_device_info</span><span class="params">(webrtc::VideoCaptureFactory::CreateDeviceInfo())</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取摄像头的数量</span></span><br><span class="line">    <span class="type">uint32_t</span> count = video_device_info-&gt;<span class="built_in">NumberOfDevices</span>();</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Video device count:&quot;</span> &lt;&lt; count &lt;&lt; std::endl;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取第一个摄像头的信息</span></span><br><span class="line">    <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">128</span>];</span><br><span class="line">    <span class="type">char</span> id[<span class="number">128</span>];</span><br><span class="line">    <span class="type">int32_t</span> res = video_device_info-&gt;<span class="built_in">GetDeviceName</span>(</span><br><span class="line">        index, name, <span class="built_in">sizeof</span>(name), id, <span class="built_in">sizeof</span>(id));</span><br><span class="line">    <span class="keyword">if</span> (res) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Device name:&quot;</span> &lt;&lt; std::<span class="built_in">string</span>(name) &lt;&lt; </span><br><span class="line">            <span class="string">&quot;; device id: &quot;</span> &lt;&lt; std::<span class="built_in">string</span>(id) </span><br><span class="line">            &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建VideoCapture</span></span><br><span class="line">    rtc::scoped_refptr&lt;webrtc::VideoCaptureModule&gt; video_capture = </span><br><span class="line">        webrtc::VideoCaptureFactory::<span class="built_in">Create</span>(id);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 判断摄像头采集的能力</span></span><br><span class="line">    <span class="keyword">if</span> (video_device_info-&gt;<span class="built_in">NumberOfCapabilities</span>(id) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Capture no capabilites.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取一个最佳匹配的摄像头能力</span></span><br><span class="line">    webrtc::VideoCaptureCapability request_cap;</span><br><span class="line">    request_cap.width = <span class="number">640</span>;</span><br><span class="line">    request_cap.height = <span class="number">480</span>;</span><br><span class="line">    request_cap.maxFPS = <span class="number">20</span>;</span><br><span class="line">    webrtc::VideoCaptureCapability best_cap;</span><br><span class="line">    <span class="keyword">if</span> (device_info_-&gt;<span class="built_in">GetBestMatchedCapability</span>(id, request_cap, best_cap) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Capture no best capability.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 注册回调接口用于采集数据</span></span><br><span class="line">    MyVideoSink vsink;</span><br><span class="line">    video_capture-&gt;<span class="built_in">RegisterCaptureDataCallback</span>(&amp;vsink);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 启动摄像头采集</span></span><br><span class="line">    <span class="keyword">if</span> (video_capture-&gt;<span class="built_in">StartCapture</span>(best_cap) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    	std::cout &lt;&lt; <span class="string">&quot;Start capture failed.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    <span class="comment">// 停止摄像头采集</span></span><br><span class="line">    <span class="keyword">if</span> (video_capture-&gt;<span class="built_in">CaptureStarted</span>()) &#123;</span><br><span class="line">        video_capture-&gt;<span class="built_in">StopCapture</span>();</span><br><span class="line">        video_capture = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="RGB、YUV采样和存储"><a href="#RGB、YUV采样和存储" class="headerlink" title="RGB、YUV采样和存储"></a>RGB、YUV采样和存储</h1><h2 id="RGB的采样和存储"><a href="#RGB的采样和存储" class="headerlink" title="RGB的采样和存储"></a>RGB的采样和存储</h2><ul>
<li><p>RGB 模型下的每个像素都会完整的采样三个分量，具体的存储可以有多种方式，比如按照 RGB 的顺序存储，也可以按照 BGR 的方式存储。</p>
</li>
<li><p>特别需要注意的是，处理图像数据时，一定要按照正确的存储字节序进行处理，否则图像会失真。</p>
</li>
</ul>
<h2 id="YUV的采样格式"><a href="#YUV的采样格式" class="headerlink" title="YUV的采样格式"></a>YUV的采样格式</h2><ul>
<li><p>RGB 的采样格式和存储格式，相对来说很容易理解。但是在视频处理领域，我们使用的更多的是 YUV 这种格式，相比 RGB 它占用的存储空间更小，更利于网络传输和存储。</p>
</li>
<li><p>YUV 格式，Y 代表的是亮度，UV 代表的是色度。如果只采样 Y 数据，不采用 UV 数据，也能够呈现图像的整体轮廓，只不过是一张黑白的图像。</p>
</li>
<li><p>因为人眼感知亮度的视杆细胞（约 1.25 亿个）要远远多于感知色度的视锥细胞（约 700w 个），所以人眼对亮度的敏感程度要高于色度。所以尽可能的保留人眼敏感的Y分量采样，减少不那么敏感 UV 分量的采样，从而能最大限度的压缩数据，还能保证人眼视觉失真度小。</p>
</li>
<li><p>YUV 按照采样方式的不同，可以分为 YUV444，YUV422，YUV420 等几种方式。注意这里的数值不是代表每个分量的比值。</p>
</li>
<li><p>YUVABC 的解读规则：</p>
<ul>
<li><p>对于一个宽度为 A，高度为 2 个像素的采集区域</p>
</li>
<li><p>第一行需要采集 A 个 Y，B 个 UV</p>
</li>
<li><p>第二行需要采集 A 个 Y，C 个 UV</p>
</li>
<li><p>如果 C 为 0，表示第二行不采集 UV，而是复用第一行的 UV</p>
</li>
</ul>
</li>
<li><p>YUV 的存储格式</p>
<p>  引入数组来表示 YUV 的存储结构，我们称为平面。一个数组表示存储一个平面，N 个数组表示存储 N 个平面，根据各分量排列顺序和存储平面个数的不同，YUV 的存储格式分为三大类：</p>
<ul>
<li>打包模式（packed），使用一个平面进行存储，在平面 1 上，将像素的 YUV 分量打包后连续、交错存储。</li>
<li>平面模式（planar），使用三个平面进行存储，平面 1，连续存储所有的 Y 分量，平面2 连续存储所有的 U 分量，平面3连续存储所有的 V 分量（ U 和 V 的顺序可以交换）。</li>
<li>半平面模式（semi-planar），使用两个平面进行存储，平面 1 连续存储所有的 Y 分量，平面 2 上连续、交错存储 UV 分量（ U 和 V 的顺序可以交换）。</li>
</ul>
</li>
</ul>
<h1 id="链式架构设计"><a href="#链式架构设计" class="headerlink" title="链式架构设计"></a>链式架构设计</h1><ul>
<li><p>每个逻辑功能都会抽象成一个处理链条 MediaChain</p>
<ul>
<li>比如预览、推流、拉流等</li>
</ul>
</li>
<li><p>每个 MediaChain 上的处理节点 MediaObject，主要有以下三种结构组成</p>
<ul>
<li>MediaSrc，只有输出，没有输入</li>
<li>MediaFilter，既有输入，也有输出</li>
<li>MediaSink，只有输入，没有输出</li>
</ul>
</li>
<li><p>链式架构 InPin 和 OutPin，MediaObject 通过回形针链接成一个链条</p>
</li>
</ul>
<h1 id="Direct3D"><a href="#Direct3D" class="headerlink" title="Direct3D"></a>Direct3D</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;d3d9.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;libyuv.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span>  <span class="comment">//添加宏WIN32_LEAN_AND_MEAN，避免 windows 库冲突</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 窗口句柄，需要赋值</span></span><br><span class="line">HWND hwnd = <span class="literal">nullptr</span>;</span><br><span class="line">RECT rt_viewport;</span><br><span class="line"></span><br><span class="line">IDirect3D9* d3d9 = <span class="literal">nullptr</span>;</span><br><span class="line">IDirect3DDevice9* d3d9_device = <span class="literal">nullptr</span>;</span><br><span class="line">IDirect3DSurface9* d3d9_surface = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* rgb_buffer = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="type">int</span> rgb_buffer_size = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> width;</span><br><span class="line"><span class="type">int</span> height;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Init</span><span class="params">(std::shared_ptr&lt;MediaFrame&gt; frame)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">IsWindow</span>(hwnd_)) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Invalid hwnd&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">GetClientRect</span>(hwnd, &amp;rt_viewport)) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;GetClientRect failed, hwnd: &quot;</span> &lt;&lt; hwnd &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 1. 创建d3d9对象</span></span><br><span class="line">    <span class="keyword">if</span> (!d3d9) &#123;</span><br><span class="line">        d3d9 = <span class="built_in">Direct3DCreate9</span>(D3D_SDK_VERSION);</span><br><span class="line">        <span class="keyword">if</span> (!d3d9) &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;d3d9 create failed&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. 创建一个d3d9 device</span></span><br><span class="line">    <span class="keyword">if</span> (!d3d9_device) &#123;</span><br><span class="line">        D3DPRESENT_PARAMETERS d3dpp;</span><br><span class="line">        <span class="built_in">ZeroMemory</span>(&amp;d3dpp, <span class="built_in">sizeof</span>(d3dpp));</span><br><span class="line">        d3dpp.Windowed = <span class="literal">true</span>; <span class="comment">// 窗口模式</span></span><br><span class="line">        <span class="comment">// 一旦后台缓冲表面的数据被复制到屏幕，那么这个表面的数据就没有用了</span></span><br><span class="line">        d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD;</span><br><span class="line">        d3dpp.BackBufferFormat = D3DFMT_UNKNOWN;</span><br><span class="line"></span><br><span class="line">        HRESULT res = d3d9-&gt;<span class="built_in">CreateDevice</span>(</span><br><span class="line">            D3DADAPTER_DEFAULT, <span class="comment">// 指定要表示的物理设备，默认主显示器</span></span><br><span class="line">            D3DDEVTYPE_HAL, <span class="comment">// 支持硬件加速</span></span><br><span class="line">            hwnd, <span class="comment">// 渲染窗口句柄</span></span><br><span class="line">            <span class="comment">// 定点处理方式，多线程处理</span></span><br><span class="line">            D3DCREATE_MIXED_VERTEXPROCESSING | D3DCREATE_MULTITHREADED,</span><br><span class="line">            &amp;d3dpp,</span><br><span class="line">            &amp;d3d9_device</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">FAILED</span>(res)) &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;d3d9 create device failed: &quot;</span> &lt;&lt; res &lt;&lt; std::endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. 创建离屏表面</span></span><br><span class="line">    <span class="keyword">if</span> (d3d9_surface) &#123;</span><br><span class="line">        d3d9_surface-&gt;<span class="built_in">Release</span>();</span><br><span class="line">        d3d9_surface = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    HRESULT res = d3d9_device-&gt;<span class="built_in">CreateOffscreenPlainSurface</span>(</span><br><span class="line">        frame-&gt;fmt.sub_fmt.video_fmt.width,</span><br><span class="line">        frame-&gt;fmt.sub_fmt.video_fmt.height,</span><br><span class="line">        D3DFMT_X8R8G8B8,</span><br><span class="line">        D3DPOOL_DEFAULT,</span><br><span class="line">        &amp;d3d9_surface,</span><br><span class="line">        <span class="literal">NULL</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">FAILED</span>(res)) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;d3d9 create offscreen surface failed: &quot;</span> &lt;&lt; res &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    width = frame-&gt;fmt.sub_fmt.video_fmt.width;</span><br><span class="line">    height = frame-&gt;fmt.sub_fmt.video_fmt.height;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DoRender</span><span class="params">(std::shared_ptr&lt;MediaFrame&gt; frame)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. 创建RGB buffer，将YUV格式转换成RGB格式</span></span><br><span class="line">    <span class="keyword">if</span> (SubMediaType::kSubTypeI420 == frame-&gt;fmt.sub_fmt.video_fmt.type) &#123;</span><br><span class="line">        <span class="type">int</span> size = frame-&gt;fmt.sub_fmt.video_fmt.width *</span><br><span class="line">            frame-&gt;fmt.sub_fmt.video_fmt.height * <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">if</span> (rgb_buffer_size != size) &#123;</span><br><span class="line">            <span class="keyword">if</span> (rgb_buffer) &#123;</span><br><span class="line">                <span class="keyword">delete</span>[] rgb_buffer;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            rgb_buffer = <span class="keyword">new</span> <span class="type">char</span>[size];</span><br><span class="line">            rgb_buffer_size = size;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// YUV格式转换成RGB</span></span><br><span class="line">        libyuv::<span class="built_in">I420ToARGB</span>((<span class="type">const</span> <span class="type">uint8_t</span>*)frame-&gt;data[<span class="number">0</span>], frame-&gt;stride[<span class="number">0</span>],</span><br><span class="line">            (<span class="type">const</span> <span class="type">uint8_t</span>*)frame-&gt;data[<span class="number">1</span>], frame-&gt;stride[<span class="number">1</span>],</span><br><span class="line">            (<span class="type">const</span> <span class="type">uint8_t</span>*)frame-&gt;data[<span class="number">2</span>], frame-&gt;stride[<span class="number">2</span>],</span><br><span class="line">            (<span class="type">uint8_t</span>*)rgb_buffer,</span><br><span class="line">            width * <span class="number">4</span>,  <span class="comment">// RGB每一行的大小</span></span><br><span class="line">            width, height);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 将RGB数据拷贝到离屏表面</span></span><br><span class="line">    <span class="comment">// 2.1 锁定区域</span></span><br><span class="line">    HRESULT res;</span><br><span class="line">    D3DLOCKED_RECT d3d9_rect;</span><br><span class="line">    res = d3d9_surface-&gt;<span class="built_in">LockRect</span>(</span><br><span class="line">        &amp;d3d9_rect, <span class="comment">// 指向描述锁定区域的矩形结构指针</span></span><br><span class="line">        <span class="literal">NULL</span>, <span class="comment">// 需要锁定的区域，如果NULL，表示整个表面</span></span><br><span class="line">        D3DLOCK_DONOTWAIT <span class="comment">// 当显卡锁定区域失败的时候，不阻塞应用程序</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">FAILED</span>(res)) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;d3d9 surface LockRect failed: &quot;</span> &lt;&lt; res &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.2 将RGB数据拷贝到离屏表面</span></span><br><span class="line">    <span class="comment">// 锁定区域的地址</span></span><br><span class="line">    byte* pdest = (byte*)d3d9_rect.pBits;</span><br><span class="line">    <span class="comment">// 锁定区域每一行的数据大小</span></span><br><span class="line">    <span class="type">int</span> stride = d3d9_rect.Pitch;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (SubMediaType::kSubTypeI420 == frame-&gt;fmt.sub_fmt.video_fmt.type) &#123;</span><br><span class="line">        <span class="type">int</span> video_width = frame-&gt;fmt.sub_fmt.video_fmt.width;</span><br><span class="line">        <span class="type">int</span> video_height = frame-&gt;fmt.sub_fmt.video_fmt.height;</span><br><span class="line">        <span class="type">int</span> video_stride = video_width * <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (video_stride == stride) &#123;</span><br><span class="line">            <span class="built_in">memcpy</span>(pdest, rgb_buffer, rgb_buffer_size);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (video_stride &lt; stride) &#123;</span><br><span class="line">            <span class="type">char</span>* src = rgb_buffer;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; video_height; ++i) &#123;</span><br><span class="line">                <span class="built_in">memcpy</span>(pdest, src, video_stride);</span><br><span class="line">                pdest += stride;</span><br><span class="line">                src += video_stride;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.3 解除锁定</span></span><br><span class="line">    d3d9_surface-&gt;<span class="built_in">UnlockRect</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 清除后台缓冲</span></span><br><span class="line">    d3d9_device-&gt;<span class="built_in">Clear</span>(</span><br><span class="line">        <span class="number">0</span>, <span class="comment">// 第二个矩形数组参数的大小</span></span><br><span class="line">        <span class="literal">NULL</span>, <span class="comment">// 需要清除的矩形数组，如果是NULL，表示清除所有</span></span><br><span class="line">        D3DCLEAR_TARGET, <span class="comment">// 清除渲染目标</span></span><br><span class="line">        <span class="built_in">D3DCOLOR_XRGB</span>(<span class="number">30</span>, <span class="number">30</span>, <span class="number">30</span>), <span class="comment">// 使用的颜色值</span></span><br><span class="line">        <span class="number">1.0f</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. 将离屏表面的数据拷贝到后台缓冲表面</span></span><br><span class="line">    d3d9_device-&gt;<span class="built_in">BeginScene</span>();</span><br><span class="line">    <span class="comment">// 获取后台缓冲表面</span></span><br><span class="line">    IDirect3DSurface9* pback_buffer = <span class="literal">nullptr</span>;</span><br><span class="line">    d3d9_device-&gt;<span class="built_in">GetBackBuffer</span>(</span><br><span class="line">        <span class="number">0</span>, <span class="comment">// 正在使用的交换链的索引</span></span><br><span class="line">        <span class="number">0</span>, <span class="comment">// 后台缓冲表面的索引</span></span><br><span class="line">        D3DBACKBUFFER_TYPE_MONO, <span class="comment">// 后台缓冲表面的类型</span></span><br><span class="line">        &amp;pback_buffer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 显示区域的宽高</span></span><br><span class="line">    <span class="type">float</span> w1 = rt_viewport.right - rt_viewport.left;</span><br><span class="line">    <span class="type">float</span> h1 = rt_viewport.bottom - rt_viewport.top;</span><br><span class="line">    <span class="comment">// 图像的宽高</span></span><br><span class="line">    <span class="type">float</span> w2 = (<span class="type">float</span>)width;</span><br><span class="line">    <span class="type">float</span> h2 = (<span class="type">float</span>)height;</span><br><span class="line">    <span class="comment">// 计算目标区域的大小</span></span><br><span class="line">    <span class="type">int</span> dst_w = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> dst_h = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> x, y = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (w1 &gt; (w2 * h1) / h2) &#123; <span class="comment">// 原始的显示区域，宽度更宽一些</span></span><br><span class="line">        dst_w = (w2 * h1) / h2;</span><br><span class="line">        dst_h = h1;</span><br><span class="line">        x = (w1 - dst_w) / <span class="number">2</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        dst_w = w1;</span><br><span class="line">        dst_h = (h2 * w1) / w2;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        y = (h1 - dst_h) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    RECT dest_rect&#123; x, y, x + dst_w, y + dst_h &#125;;</span><br><span class="line"></span><br><span class="line">    d3d9_device-&gt;<span class="built_in">StretchRect</span>(</span><br><span class="line">        d3d9_surface, <span class="comment">// 源表面</span></span><br><span class="line">        <span class="literal">NULL</span>, <span class="comment">// 源表面的矩形区域，如果是NULL，表示所有区域</span></span><br><span class="line">        pback_buffer, <span class="comment">// 目标表面</span></span><br><span class="line">        &amp;dest_rect, <span class="comment">// 目标表面的矩形区域，如果NULL，表示所有区域</span></span><br><span class="line">        D3DTEXF_LINEAR <span class="comment">// 缩放算法，线性插值</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    d3d9_device-&gt;<span class="built_in">EndScene</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. 显示图像，表面翻转</span></span><br><span class="line">    d3d9_device-&gt;<span class="built_in">Present</span>(<span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. 释放后台缓冲</span></span><br><span class="line">    pback_buffer-&gt;<span class="built_in">Release</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Release</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (d3d9_surface) &#123;</span><br><span class="line">        d3d9_surface-&gt;<span class="built_in">Release</span>();</span><br><span class="line">        d3d9_surface = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (d3d9_device &#123;</span><br><span class="line">        d3d9_device-&gt;<span class="built_in">Release</span>();</span><br><span class="line">        d3d9_device = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (d3d9) &#123;</span><br><span class="line">        d3d9-&gt;<span class="built_in">Release</span>();</span><br><span class="line">        d3d9 = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rgb_buffer) &#123;</span><br><span class="line">        <span class="keyword">delete</span>[] rgb_buffer;</span><br><span class="line">        rgb_buffer = <span class="literal">nullptr</span>;</span><br><span class="line">        rgb_buffer_size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="编译x264库"><a href="#编译x264库" class="headerlink" title="编译x264库"></a>编译x264库</h1><p><strong>通用流程，也可以编译其它的库</strong></p>
<ul>
<li><p>msys2 是一种在 windows 平台模拟 Linux 运行环境的技术，你可以在该环境运行 Linux 命令来编译 windows 平台的库</p>
</li>
<li><p>下载msys2,下载地址: <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/msys2/distrib/x86_64/">https://mirrors.tuna.tsinghua.edu.cn/msys2/distrib/x86_64/</a></p>
</li>
<li><p>下载完毕之后，正常安装即可</p>
</li>
<li><p>同步软件包数据，<code>pacman -Sy</code></p>
<ul>
<li>如果同步软件包数据比较慢，可使用清华的镜像，具体配置方法可参考:</li>
<li><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/msys2/">https://mirrors.tuna.tsinghua.edu.cn/help/msys2/</a></li>
</ul>
</li>
<li><p>安装MinGW-x64和MinGW-x86 工具链</p>
<ul>
<li><code>pacman -S mingw-w64-i686-toolchain</code></li>
<li><code>pacman -S mingw-w64-x86_64-toolchain</code></li>
<li>也可以单独安装 MinGW，然后拷贝到 msys2 下的 mingw64 和 mingw32 目录</li>
</ul>
</li>
<li><p>安装必备的工具</p>
<ul>
<li><code>pacman -S nasm</code> # 汇编工具</li>
<li><code>pacman -S yasm</code> # 汇编工具</li>
<li><code>pacman -S make</code></li>
<li><code>pacman -S cmake</code></li>
<li><code>pacman -S diffutils</code> # 比较工具，ffmpeg configure 生成 makefile 时用到</li>
<li><code>pacman -S pkg-config</code> # 库配置工具，方便引用依赖库</li>
</ul>
</li>
<li><p>打开 <code>C:\msys64\msys2_shell.cmd</code>，按照下图进行编辑 （可以保证继承父窗口的环境变量）</p>
<ul>
<li>启动 x64 Native Tools Command Prompt for VS2019</li>
<li>进入 msys2 安装目录，执行 <code>msys2_shell.cmd -mingw64</code></li>
<li>测试输入 <code>cl</code> 命令，是否继承了 MSVC 的编译环境</li>
</ul>
</li>
</ul>
<img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/msys2继承.png" alt="msys2继承" style="zoom:50%;">

<p><strong>编译x264库</strong></p>
<ul>
<li>获取源代码，通过命令获取：<code>git clone https://code.videolan.org/videolan/x264.git</code></li>
<li>编译 Debug 版本：<code>CC=cl ./configure --prefix=/d/third_party/x264_lib --enable-shared --enable-static --enable-debug &amp;&amp; make &amp;&amp; make install</code></li>
<li>编译 Release 版本：<code>CC=cl ./configure --prefix=/d/third_party/x264_lib --enable-shared --enable-static &amp;&amp; make &amp;&amp; make install</code></li>
</ul>
<h1 id="x264编码原理"><a href="#x264编码原理" class="headerlink" title="x264编码原理"></a>x264编码原理</h1><ul>
<li>I 帧和 IDR 帧都是可以独立解码的，不需要参考其它的帧</li>
<li>IDR 帧，即立即刷新帧，当遇到 IDR 帧时，解码器会清空之前所有的帧参考关系，而I帧则不会。IDR 帧一定是 I 帧，但 I 帧不一定是 IDR 帧。一个图像序列中，可以有很多的 I 帧，I 帧之后的图像可以参考 I 帧之前的图像。但是对于 IDR 帧来说，IDR 帧之后的所有帧都不会参考 IDR 帧之前的任何帧</li>
<li>P帧，需要参考之前的帧，才能解码</li>
<li>B帧，需要参考前一帧和后一帧才能解码</li>
<li>GOP，在 H264 中，图像是以系列为单位进行组织的，通常以一个IDR 帧开始，到下一个 IDR 帧结束，这个图像系列称为一个 GOP。一个 GOP 通常包含一个 IDR 帧和若干个 P 帧和 B 帧</li>
</ul>
<h1 id="x264编码参数"><a href="#x264编码参数" class="headerlink" title="x264编码参数"></a>x264编码参数</h1><ul>
<li>由于 x264 编码原理复杂，参数众多，为了方便开发者使用，x264 根据编码速度和应用场景，预设了一些参数模型，以简化使用。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 编码速度越快，压缩效果会变差</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span> * <span class="type">const</span> x264_preset_names[] = &#123; </span><br><span class="line">    <span class="string">&quot;ultrafast&quot;</span>,</span><br><span class="line">    <span class="string">&quot;superfast&quot;</span>,</span><br><span class="line">    <span class="string">&quot;veryfast&quot;</span>,</span><br><span class="line">    <span class="string">&quot;faster&quot;</span>,</span><br><span class="line">    <span class="string">&quot;fast&quot;</span>,</span><br><span class="line">    <span class="string">&quot;medium&quot;</span>,</span><br><span class="line">    <span class="string">&quot;slow&quot;</span>,</span><br><span class="line">    <span class="string">&quot;slower&quot;</span>,</span><br><span class="line">    <span class="string">&quot;veryslow&quot;</span>,</span><br><span class="line">    <span class="string">&quot;placebo&quot;</span>, <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 场景，因为我们是低延迟推流，选择 zerolatency</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span> * <span class="type">const</span> x264_tune_names[] = &#123;</span><br><span class="line">    <span class="string">&quot;film&quot;</span>,</span><br><span class="line">    <span class="string">&quot;animation&quot;</span>,</span><br><span class="line">    <span class="string">&quot;grain&quot;</span>,</span><br><span class="line">    <span class="string">&quot;stillimage&quot;</span>,</span><br><span class="line">    <span class="string">&quot;psnr&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ssim&quot;</span>,</span><br><span class="line">    <span class="string">&quot;fastdecode&quot;</span>,</span><br><span class="line">    <span class="string">&quot;zerolatency&quot;</span>, <span class="number">0</span> &#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Profile 设置</p>
<ul>
<li>Baseline，通常用于实时通信领域，支持 I 帧，P 帧，不支持 B 帧，只支持逐行扫描和 CAVLC</li>
<li>Main，通常用于消费电子应用，比如数字视频存储等，支持 I 帧、P 帧、B 帧，支持逐行扫描和隔行扫描，支持  CAVLC 和 CABAC</li>
<li>High，通常用于高分辨率和高清晰度有要求的场景，在 Main 的基础上，又增加了8 * 8 帧内预测，自定义量化，无损视频编码，更多的 YUV 格式，像素精度提高到 10 位或者12 位</li>
</ul>
</li>
<li><p>X264 码率控制</p>
<ul>
<li><p>CQP-恒定QP</p>
<ul>
<li>QP 值越小，图像的质量越高，QP&#x3D;0 表示无损压缩，取值范围[0, 51]</li>
<li>每帧图像都用一个特定的 QP 值进行编码，编码出来的大小是未知的</li>
<li>CQP 码率波动较大，相同的图像质量，CQP 比 CRF 的输出文件更大，实际应用中 CRF 取代了 CQP，CQP因为不需要预测，编码速度要快些，另外 CQP 通常可以用在算法研究上，来比较不同算法的优劣</li>
</ul>
</li>
<li><p>CRF-恒定码率因子</p>
<ul>
<li>相同视觉质量的情况下，CRF 的输出文件比 CQP 更小，CRF 通过降低不太重要的帧的质量，把省下来的码率分配给其它更有效的帧，来达到此效果</li>
<li>不太重要的帧指的是过于耗费码率但是又不容易被人眼察觉的帧，比如高速运行的场景</li>
<li>CRF 同样有一个范围[0, 51]，值越小质量越好，0 表示无损压缩，51 质量最差，23 为默认值。通常情况下，18 ~ 28 是一个合理的范围，18 往往被认为从视觉上看是近似无损的</li>
<li>RF 值加 6，输出码率减少一半；反之则增加一倍</li>
</ul>
</li>
<li><p>ABR-恒定平均码率</p>
<ul>
<li>简单场景分配较低 bit，复杂场景分配足够 bit，使得有限的 bit 数能够在不同的场景下合理分配</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;x264.h&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">X264EncoderParam</span> &#123;</span><br><span class="line">    <span class="comment">// 编码速率</span></span><br><span class="line">    std::string preset = <span class="string">&quot;veryfast&quot;</span>;</span><br><span class="line">    <span class="comment">// 编码场景</span></span><br><span class="line">    std::string tune = <span class="string">&quot;zerolatency&quot;</span>;</span><br><span class="line">    <span class="comment">// profile</span></span><br><span class="line">    std::string profile = <span class="string">&quot;baseline&quot;</span>;</span><br><span class="line">    <span class="comment">// 码率控制，CQP、CRF、ABR</span></span><br><span class="line">    std::string rate_control = <span class="string">&quot;CRF&quot;</span>;</span><br><span class="line">    <span class="comment">// 目标码率, 单位kbps</span></span><br><span class="line">    <span class="type">int</span> bitrate = <span class="number">1000</span>;</span><br><span class="line">    <span class="type">int</span> max_bitrate = <span class="number">1500</span>;</span><br><span class="line">    <span class="type">int</span> buffer_size = <span class="number">1500</span>;</span><br><span class="line">    <span class="type">int</span> cf = <span class="number">25</span>;</span><br><span class="line">    <span class="comment">// 图像的宽高</span></span><br><span class="line">    <span class="type">int</span> width = <span class="number">640</span>;</span><br><span class="line">    <span class="type">int</span> height = <span class="number">480</span>;</span><br><span class="line">    <span class="comment">// 帧率</span></span><br><span class="line">    <span class="type">int</span> fps = <span class="number">30</span>;</span><br><span class="line">    <span class="comment">// GOP</span></span><br><span class="line">    <span class="type">int</span> gop = <span class="number">60</span>; <span class="comment">// 2s</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">X264EncoderParam encoder_param;</span><br><span class="line"><span class="type">x264_param_t</span>* x264_param = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="type">x264_t</span>* x264 = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="type">x264_picture_t</span>* x264_picture = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">LogX264</span><span class="params">(<span class="type">void</span>*, <span class="type">int</span> level, <span class="type">const</span> <span class="type">char</span>* format, va_list args)</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">1024</span>];</span><br><span class="line">    va_list args2;</span><br><span class="line">    <span class="built_in">va_copy</span>(args2, args);</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">vsnprintf</span>(buf, <span class="built_in">sizeof</span>(buf), format, args2);</span><br><span class="line">    <span class="keyword">if</span> (len &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        buf[len - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">va_end</span>(args2);</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;x264 log, level: &quot;</span> &lt;&lt; level </span><br><span class="line">        &lt;&lt; <span class="string">&quot;, msg: &quot;</span> &lt;&lt; std::<span class="built_in">to_string</span>(buf) &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">InitEncoder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    x264_param = <span class="keyword">new</span> <span class="built_in">x264_param_t</span>();</span><br><span class="line">    <span class="built_in">memset</span>(x264_param, <span class="number">0</span>, <span class="built_in">sizeof</span>(<span class="type">x264_param_t</span>));</span><br><span class="line">    <span class="comment">// 设置速率和场景</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">x264_param_default_preset</span>(x264_param, encoder_param.preset.<span class="built_in">c_str</span>(),</span><br><span class="line">        encoder_param.tune.<span class="built_in">c_str</span>())) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置图像的宽高</span></span><br><span class="line">    x264_param-&gt;i_width = encoder_param.width;</span><br><span class="line">    x264_param-&gt;i_height = encoder_param.height;</span><br><span class="line">    <span class="comment">// 设置帧率</span></span><br><span class="line">    x264_param-&gt;i_fps_num = encoder_param.fps;</span><br><span class="line">    x264_param-&gt;i_fps_den = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 设置GOP</span></span><br><span class="line">    <span class="keyword">if</span> (encoder_param.gop &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        x264_param-&gt;i_keyint_max = encoder_param.gop;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 需要图像的格式</span></span><br><span class="line">    x264_param-&gt;i_csp = X264_CSP_I420;</span><br><span class="line">    <span class="comment">// 不使用B帧, B帧会增大延迟</span></span><br><span class="line">    x264_param-&gt;i_bframe = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 设置单Slice</span></span><br><span class="line">    x264_param-&gt;i_slice_count = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 使用单线程</span></span><br><span class="line">    x264_param-&gt;i_threads = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 每个I帧前面都携带SPS PPS</span></span><br><span class="line">    x264_param-&gt;b_repeat_headers = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置码率控制参数</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;ABR&quot;</span> == x264_param.rate_control) &#123;</span><br><span class="line">        x264_param-&gt;rc.i_rc_method = X264_RC_ABR;</span><br><span class="line">        x264_param-&gt;rc.f_rf_constant = <span class="number">0.0</span>;</span><br><span class="line">        x264_param-&gt;rc.i_bitrate = x264_param.bitrate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        x264_param-&gt;rc.i_rc_method = X264_RC_CRF;</span><br><span class="line">        x264_param-&gt;rc.f_rf_constant = (<span class="type">float</span>)encoder_param.cf;</span><br><span class="line">        x264_param-&gt;rc.i_bitrate = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置最大码率</span></span><br><span class="line">    <span class="keyword">if</span> (encoder_param.max_bitrate &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        x264_param-&gt;rc.i_vbv_max_bitrate = encoder_param.max_bitrate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置码率控制缓冲区</span></span><br><span class="line">    <span class="keyword">if</span> (encoder_param_.buffer_size &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        x264_param-&gt;rc.i_vbv_buffer_size = encoder_param.buffer_size;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 根据fps来计算两帧间隔，如果是1，表示使用时间戳来计算间隔</span></span><br><span class="line">    x264_param-&gt;b_vfr_input = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置log参数</span></span><br><span class="line">    x264_param-&gt;pf_log = LogX264;</span><br><span class="line">    x264_param-&gt;p_log_private = <span class="literal">nullptr</span>;</span><br><span class="line">    x264_param-&gt;i_log_level = X264_LOG_DEBUG;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置profile</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">x264_param_apply_profile</span>(x264_param, encoder_param.profile.<span class="built_in">c_str</span>())) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开编码器</span></span><br><span class="line">    x264 = <span class="built_in">x264_encoder_open</span>(x264_param);</span><br><span class="line">    <span class="keyword">if</span> (!x264) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;x264_encoder_open failed&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建pictrue</span></span><br><span class="line">    x264_picture = <span class="keyword">new</span> <span class="built_in">x264_picture_t</span>();</span><br><span class="line">    <span class="built_in">memset</span>(x264_picture, <span class="number">0</span>, <span class="built_in">sizeof</span>(<span class="type">x264_picture_t</span>));</span><br><span class="line">    <span class="comment">// 给picture分配空间</span></span><br><span class="line">    <span class="type">int</span> res = <span class="built_in">x264_picture_alloc</span>(x264_picture, x264_param-&gt;i_csp,</span><br><span class="line">        x264_param-&gt;i_width, x264_param-&gt;i_height);</span><br><span class="line">    <span class="keyword">if</span> (res &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;x264_picture_alloc failed&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置编码帧的类型</span></span><br><span class="line">    x264_picture-&gt;i_type = X264_TYPE_AUTO;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ReleaseEncoder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x264_param) &#123;</span><br><span class="line">        <span class="keyword">delete</span> x264_param;</span><br><span class="line">        x264_param = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x264_picture) &#123;</span><br><span class="line">        <span class="built_in">x264_picture_clean</span>(x264_picture);</span><br><span class="line">        <span class="keyword">delete</span> x264_picture;</span><br><span class="line">        x264_picture = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x264) &#123;</span><br><span class="line">        <span class="built_in">x264_encoder_close</span>(x264);</span><br><span class="line">        x264 = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Encode</span><span class="params">(std::shared_ptr&lt;MediaFrame&gt; frame, std::shared_ptr&lt;MediaFrame&gt;&amp; out_frame)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 设置时间戳</span></span><br><span class="line">    x264_picture_-&gt;i_pts = frame-&gt;ts;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> nal_num;</span><br><span class="line">    <span class="type">x264_nal_t</span>* nal_out;</span><br><span class="line">    <span class="type">x264_picture_t</span> pic_out;</span><br><span class="line">    <span class="type">int</span> size = <span class="built_in">x264_encoder_encode</span>(x264, &amp;nal_out, &amp;nal_num, x264_picture, &amp;pic_out);</span><br><span class="line">    <span class="keyword">if</span> (size &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;x264_encoder_encode failed: &quot;</span> &lt;&lt; size &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (size == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> data_size = <span class="number">0</span>;</span><br><span class="line">    std::vector&lt;<span class="type">x264_nal_t</span>&gt; nals;</span><br><span class="line">    <span class="type">bool</span> idr = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">int</span> sps_length = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> sps[<span class="number">1024</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">int</span> pps_length = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> pps[<span class="number">1024</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nal_num; ++i) &#123;</span><br><span class="line">        <span class="type">x264_nal_t</span>&amp; nal = nal_out[i];</span><br><span class="line">        <span class="type">int</span> nal_type = nal.i_type;</span><br><span class="line">        <span class="comment">// 如果NALU是I帧或者P帧</span></span><br><span class="line">        <span class="keyword">if</span> (nal_type == NAL_SLICE_IDR || nal_type == NAL_SLICE) &#123;</span><br><span class="line">            nals.<span class="built_in">push_back</span>(nal);</span><br><span class="line">            data_size += nal.i_payload;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (nal_type == NAL_SLICE_IDR) &#123;</span><br><span class="line">                idr = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (nal_type == NAL_SEI) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (nal_type == NAL_SPS) &#123;</span><br><span class="line">            sps_length = nal.i_payload;</span><br><span class="line">            <span class="built_in">memcpy</span>(sps, nal.p_payload, sps_length);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (nal_type == NAL_PPS) &#123;</span><br><span class="line">            pps_length = nal.i_payload;</span><br><span class="line">            <span class="built_in">memcpy</span>(pps, nal.p_payload, pps_length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (idr) &#123;</span><br><span class="line">        data_size += (sps_length + pps_length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    out_frame = std::<span class="built_in">make_shared</span>&lt;MediaFrame&gt;(data_size);</span><br><span class="line">    out_frame-&gt;fmt.media_type = MainMediaType::kMainTypeVideo;</span><br><span class="line">    out_frame-&gt;fmt.sub_fmt.video_fmt.type = SubMediaType::kSubTypeH264;</span><br><span class="line">    out_frame-&gt;fmt.sub_fmt.video_fmt.idr = idr;</span><br><span class="line">    out_frame-&gt;ts = pic_out.i_pts;</span><br><span class="line">    out_frame-&gt;data_len[<span class="number">0</span>] = data_size;</span><br><span class="line">    out_frame-&gt;capture_time_ms = frame-&gt;capture_time_ms;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> data_index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; nals.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">        <span class="type">x264_nal_t</span>&amp; nal = nals[i];</span><br><span class="line">        <span class="keyword">if</span> (nal.i_type == NAL_SLICE_IDR) &#123;</span><br><span class="line">            <span class="comment">// 首先拷贝SPS PPS数据</span></span><br><span class="line">            <span class="built_in">memcpy</span>(out_frame-&gt;data[<span class="number">0</span>] + data_index, sps, sps_length);</span><br><span class="line">            data_index += sps_length;</span><br><span class="line">            <span class="built_in">memcpy</span>(out_frame-&gt;data[<span class="number">0</span>] + data_index, pps, pps_length);</span><br><span class="line">            data_index += pps_length;</span><br><span class="line">            <span class="comment">// 拷贝I帧数据</span></span><br><span class="line">            <span class="built_in">memcpy</span>(out_frame-&gt;data[<span class="number">0</span>] + data_index, nal.p_payload, nal.i_payload);</span><br><span class="line">            data_index += nal.i_payload;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 拷贝P帧数据</span></span><br><span class="line">            <span class="built_in">memcpy</span>(out_frame-&gt;data[<span class="number">0</span>] + data_index, nal.p_payload, nal.i_payload);</span><br><span class="line">            data_index += nal.i_payload;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    std::atomic&lt;<span class="type">bool</span>&gt; running&#123; <span class="literal">true</span> &#125;;</span><br><span class="line">    <span class="comment">// 输入队列</span></span><br><span class="line">    std::queue&lt;std::shared_ptr&lt;MediaFrame&gt;&gt; frame_queue;</span><br><span class="line">    std::mutex frame_queue_mtx;</span><br><span class="line">    std::condition_variable cond_var;</span><br><span class="line">    std::thread* encode_thread = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    encode_thread_ = <span class="keyword">new</span> std::<span class="built_in">thread</span>([=]() &#123;</span><br><span class="line">        rtc::<span class="built_in">SetCurrentThreadName</span>(<span class="string">&quot;x264_encode_thread&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 初始化编码器</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">InitEncoder</span>()) &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;x264 init failed&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            <span class="built_in">ReleaseEncoder</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> frame_queue_size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (running_) &#123;</span><br><span class="line">            std::shared_ptr&lt;MediaFrame&gt; frame;</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line">                std::unique_lock&lt;std::mutex&gt; <span class="built_in">auto_lock</span>(frame_queue_mtx);</span><br><span class="line">                frame_queue_size = frame_queue.<span class="built_in">size</span>();</span><br><span class="line">                <span class="keyword">if</span> (frame_queue_size &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    frame = frame_queue.<span class="built_in">front</span>();</span><br><span class="line">                    frame_queue.<span class="built_in">pop</span>();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!frame) &#123;</span><br><span class="line">                    cond_var.<span class="built_in">wait</span>(auto_lock);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 判断图像的宽高是否发生了变化，如果发生了变化，需要重新初始化编码器</span></span><br><span class="line">            <span class="keyword">if</span> (encoder_param.width != frame-&gt;fmt.sub_fmt.video_fmt.width ||</span><br><span class="line">                encoder_param.height != frame-&gt;fmt.sub_fmt.video_fmt.height) </span><br><span class="line">            &#123;</span><br><span class="line">                encoder_param.width = frame-&gt;fmt.sub_fmt.video_fmt.width;</span><br><span class="line">                encoder_param.height = frame-&gt;fmt.sub_fmt.video_fmt.height;</span><br><span class="line">                <span class="built_in">ReleaseEncoder</span>();</span><br><span class="line">                <span class="keyword">if</span> (!<span class="built_in">InitEncoder</span>()) &#123;</span><br><span class="line">                    <span class="built_in">ReleaseEncoder</span>();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 拷贝图像数据</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</span><br><span class="line">                <span class="built_in">memcpy</span>(x264_picture-&gt;img.plane[i], frame-&gt;data[i], frame-&gt;data_len[i]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 编码</span></span><br><span class="line">            std::shared_ptr&lt;MediaFrame&gt; out_frame;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">Encode</span>(frame, out_frame)) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 处理编码后的数据out_frame</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">ReleaseEncoder</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="RTC推流协议"><a href="#RTC推流协议" class="headerlink" title="RTC推流协议"></a>RTC推流协议</h1><ul>
<li><p>向信令服务请求 offer SDP，协议：<code>rtc://localhost:8981/signaling/push?uid=100&amp;streamName=rtcdemo&amp;enableDtls=1</code></p>
</li>
<li><p>客户端收到响应后，调用 <code>SetRemoveSDP</code>：设置远端 ICE param（mid、ice_ufrag、ice_pwd）和远端的 candidate</p>
</li>
<li><p>同时客户端调用 <code>CreateAnswer</code> 创建 answer SDP， 并使用 <code>SetLocalSDP</code> 设置本地 ICE param 和收集本地的 candidate，客户端此时有远端的 ICE 和 candidate信息，以及本地的 ICE 和 candidate 信息，会进行连通性检查，但是接下来需要向远程发送 answer SDP，服务端才能进行连通性检查</p>
</li>
<li><p>向信令服务发送 answer SDP，协议：<code>rtc:://localhosst:8981/signaling/sendanswer?uid=100&amp;streamName=rtcdemo&amp;type=push&amp;answer=sdp信息</code></p>
</li>
<li><p>当 ICE 连接建立成功后，允许发送媒体数据</p>
</li>
<li><p>向信令服务发送停止请求，协议： <code>rtc://localhost:8981/signaling/stoppush?uid=100&amp;streamName=rtcdemo</code></p>
</li>
</ul>
<p>信令交互流程</p>
<img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/信令交互流程.png" alt="信令交互流程" style="zoom:50%;">



<h1 id="SDP格式"><a href="#SDP格式" class="headerlink" title="SDP格式"></a>SDP格式</h1><h2 id="SDP的基本格式"><a href="#SDP的基本格式" class="headerlink" title="SDP的基本格式"></a>SDP的基本格式</h2><ul>
<li>文本协议，每一行描述了一条信息(\n \r\n)</li>
<li>key&#x3D;value</li>
</ul>
<h2 id="SDP示例"><a href="#SDP示例" class="headerlink" title="SDP示例"></a>SDP示例</h2><ul>
<li>会话级别描述信息</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">v=0</span><br><span class="line">o=- 7058326249039352123 2 IN IP4 127.0.0.1</span><br><span class="line">s=-</span><br><span class="line">t=0 0</span><br></pre></td></tr></table></figure>

<ul>
<li>媒体级别描述信息</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">a=group:BUNDLE audio video</span><br><span class="line">a=msid-semantic: WMS HCj72859UNb52SZLC36JZO1xGu8MlbbioEZc</span><br><span class="line"></span><br><span class="line">-----------------------------audio-------------------------------</span><br><span class="line">m=audio 9 UDP/TLS/RTP/SAVPF 111  </span><br><span class="line">c=IN IP4 0.0.0.0</span><br><span class="line">a=rtcp:9 IN IP4 0.0.0.0</span><br><span class="line">-----------------------------传输信息-------------------------------</span><br><span class="line">a=ice-ufrag:h8/s</span><br><span class="line">a=ice-pwd:r1bFaSIYtLyVkf6M7M0LUBOj</span><br><span class="line">a=ice-options:trickle</span><br><span class="line">a=fingerprint:sha-256</span><br><span class="line">B8:F8:2A:F2:CF:F7:81:E6:F6:2F:EC:57:AD:A8:16:5D:58:55:C2:C8:80:E4:56:95:5B:D8:A0:77:6A:14:ED:17</span><br><span class="line">a=setup:active</span><br><span class="line">-----------------------------编解码信息-------------------------------</span><br><span class="line">a=mid:audio</span><br><span class="line">a=sendonly                               // 传输方向，只发送数据 </span><br><span class="line">a=msid:HCj72859UNb52SZLC36JZO1xGu8MlbbioEZc 3201545b-78e1-43c5-8125-d559ca5089e9</span><br><span class="line">a=rtcp-mux                               // rtp和rtcp复用一条传输通道</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">a=rtpmap:111 opus/48000/2                // opus编码，48000频率，两通道</span><br><span class="line">a=rtcp-fb:111 transport-cc               // 音频支持发送端带宽估计</span><br><span class="line">a=fmtp:111 minptime=10;useinbandfec=1    // 支持最小打包时间10ms，开启内部fec</span><br><span class="line">-----------------------------ssrc-------------------------------</span><br><span class="line">a=ssrc:1617442066 cname:asmN76BS9IZMd3O6</span><br><span class="line">a=ssrc:1617442066 msid:HCj72859UNb52SZLC36JZO1xGu8MlbbioEZc 3201545b-78e1-43c5-8125-d559ca5089e9</span><br><span class="line">a=ssrc:1617442066 mslabel:HCj72859UNb52SZLC36JZO1xGu8MlbbioEZc</span><br><span class="line">a=ssrc:1617442066 label:3201545b-78e1-43c5-8125-d559ca5089e9</span><br><span class="line"></span><br><span class="line">-----------------------------video-------------------------------</span><br><span class="line">m=video 9 UDP/TLS/RTP/SAVPF 107 99</span><br><span class="line">c=IN IP4 0.0.0.0</span><br><span class="line">a=rtcp:9 IN IP4 0.0.0.0</span><br><span class="line">-----------------------------传输信息-------------------------------</span><br><span class="line">a=ice-ufrag:h8/s</span><br><span class="line">a=ice-pwd:r1bFaSIYtLyVkf6M7M0LUBOj</span><br><span class="line">a=ice-options:trickle</span><br><span class="line">a=fingerprint:sha-256</span><br><span class="line">B8:F8:2A:F2:CF:F7:81:E6:F6:2F:EC:57:AD:A8:16:5D:58:55:C2:C8:80:E4:56:95:5B:D8:A0:77:6A:14:ED:17</span><br><span class="line">a=setup:active</span><br><span class="line">a=mid:video</span><br><span class="line">a=sendonly</span><br><span class="line">a=msid:HCj72859UNb52SZLC36JZO1xGu8MlbbioEZc 6d285605-17e7-494e-9323-1aae263c83ed</span><br><span class="line">-----------------------------编解码信息-------------------------------</span><br><span class="line">a=rtcp-mux</span><br><span class="line">a=rtpmap:107 H264/90000      // h264编码，90000频率</span><br><span class="line">a=rtcp-fb:107 goog-remb      // 支持接收端估计最大带宽</span><br><span class="line">a=rtcp-fb:107 transport-cc   // 支持发送端带宽估计</span><br><span class="line">a=rtcp-fb:107 ccm fir        // 支持codec请求I帧</span><br><span class="line">a=rtcp-fb:107 nack           // 支持丢包重传</span><br><span class="line">a=rtcp-fb:107 nack pli       // 支持重传PLI</span><br><span class="line">// 允许两端的编码等级不同，打包方式（0: Single Nalu, 1: Notinterleaved 2: Interleaved）以及设定H264的profile和等级</span><br><span class="line">a=fmtp:107 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f</span><br><span class="line">a=rtpmap:99 rtx/90000</span><br><span class="line">a=fmtp:99 apt=107            // 重传适配的视频codec id</span><br><span class="line">-----------------------------ssrc-------------------------------</span><br><span class="line">a=ssrc-group:FID 4277661688 4128179557</span><br><span class="line">a=ssrc:4277661688 cname:asmN76BS9IZMd3O6</span><br><span class="line">a=ssrc:4277661688 msid:HCj72859UNb52SZLC36JZO1xGu8MlbbioEZc 6d285605-17e7-494e-9323-1aae263c83ed</span><br><span class="line">a=ssrc:4277661688 mslabel:HCj72859UNb52SZLC36JZO1xGu8MlbbioEZc</span><br><span class="line">a=ssrc:4277661688 label:6d285605-17e7-494e-9323-1aae263c83ed</span><br><span class="line">a=ssrc:4128179557 cname:asmN76BS9IZMd3O6</span><br><span class="line">a=ssrc:4128179557 msid:HCj72859UNb52SZLC36JZO1xGu8MlbbioEZc 6d285605-17e7-494e-9323-1aae263c83ed</span><br><span class="line">a=ssrc:4128179557 mslabel:HCj72859UNb52SZLC36JZO1xGu8MlbbioEZc</span><br><span class="line">a=ssrc:4128179557 label:6d285605-17e7-494e-9323-1aae263c83ed</span><br></pre></td></tr></table></figure>

<p>BUNDLE 机制：对于一个既要传输音频、又要传输视频的会话而言，传输方式有两种选择：</p>
<ul>
<li>audio 和 video 分别建立一条传输通道，各自独立传输音频和视频</li>
<li>只建立一条传输通道，audio 和 video 复用这条传输通道，这个就是 BUNDLE 机制</li>
</ul>
<p>Candidate 分类</p>
<ul>
<li>Host candidate：直接从本地网络接口获取，比如以太网、WiFi，或者一些虚拟网络比如 VPN</li>
<li>Server Reflexive candidate：由于 IPv4 地址是有限的，很多主机是没有公网 ip 的，它们访问公网是通过 NAT 映射的方式，这样它就会存在两个地址，一个是本地的局域网地址，一个 NAT 映射的另一侧公网地址，正常情况下，主机是不知道这个公网地址的，但是通过 STUN 或者 TURN 服务，是能够获取到这个公网地址，这个公网地址就称之为 Server Reflexive candidate</li>
<li>Relay candidate：一台独立的 TURN 服务器，可以为某个主机分配一个通信地址，该主机可以通过这个地址与其它主机进行通信，TURN 服务负责在两个主机之间转发数据，那么 TURN 服务分配的地址称之为 relay candidate</li>
<li>Peer reflexive candidate：主机在做连通性检查的时候，会发送 STUN request 请求，如果对方能够成功返回 STUN response，response 会携带 NAT 映射的公网侧地址，这个地址称为 Peer Reflexive candidate</li>
</ul>
<p><code>a=candidate:3368696143 1 udp 2113937151 115.29.101.222 10086 typ host</code></p>
<p>TransportInfo 信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a=ice-ufrag:h8/s</span><br><span class="line">a=ice-pwd:r1bFaSIYtLyVkf6M7M0LUBOj</span><br><span class="line">a=ice-options:trickle</span><br><span class="line">a=fingerprint:sha-256</span><br><span class="line">B8:F8:2A:F2:CF:F7:81:E6:F6:2F:EC:57:AD:A8:16:5D:58:55:C2:C8:80:E4:56:95:5B:D8:A0:77:6A:14:ED:17</span><br><span class="line">a=setup:active</span><br></pre></td></tr></table></figure>

<h1 id="RTP打包"><a href="#RTP打包" class="headerlink" title="RTP打包"></a>RTP打包</h1><h2 id="NALU的结构"><a href="#NALU的结构" class="headerlink" title="NALU的结构"></a>NALU的结构</h2><img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/NALU的结构.png" alt="NALU的结构" style="zoom:50%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">|0|1|2|3|4|5|6|7|</span><br><span class="line">|F| NRI |  TYPE |</span><br></pre></td></tr></table></figure>

<ul>
<li>F：1bit，初始值为 0，当 NAL 单元在网络传输过程中识别为错误时，可以设置为 1，以便接收方纠错或者丢弃该 NALU</li>
<li>NRI：2bit，用来指示NALU的重要性等级。值越大，越重要，解码器在解码处理不过来的时候，可以丢弃重要性为 0的 NALU</li>
<li>Type：5bit，包含在 NALU 中的 RBSP 的数据结构类型</li>
</ul>
<table>
<thead>
<tr>
<th>RBSP数据结构类型</th>
<th>NAL Header取值</th>
</tr>
</thead>
<tbody><tr>
<td>IDR</td>
<td>0x65</td>
</tr>
<tr>
<td>SPS</td>
<td>0x67</td>
</tr>
<tr>
<td>PPS</td>
<td>0x68</td>
</tr>
<tr>
<td>SEI</td>
<td>0x06</td>
</tr>
</tbody></table>
<h2 id="RTP打包模式"><a href="#RTP打包模式" class="headerlink" title="RTP打包模式"></a>RTP打包模式</h2><p>RTP 包结构</p>
<img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/RTP包结构.png" alt="RTP包结构" style="zoom:50%;">



<ul>
<li>单个 NALU 包（一个 RTP 包包含一个 NALU）</li>
</ul>
<img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/单个NALU包.png" alt="单个NALU包" style="zoom:50%;">

<ul>
<li>STAP-A 包，当 NALU 都比较小的时候，可以将多个 NALU 进行组合，封装进一个 RTP 包</li>
</ul>
<img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/STAP-A包.png" alt="STAP-A包" style="zoom:50%;">

<ul>
<li>FU-A 包，当 NALU 特别大的时候，超过了 MTU 的大小限制，这样就需要将一个 NALU 分成多个 RTP 包进行传输<ul>
<li>S：1bit，如果是 1，表示分片的开始，否则为 0</li>
<li>E：1bit，如果是 1，表示分片的结束，否则为 0</li>
<li>R：1bit，保留位，设置为 0</li>
<li>Type：5bit，与被分片的 NALU 类型一致</li>
</ul>
</li>
</ul>
<img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/FU-A包.png" alt="FU-A包" style="zoom:50%;">

<h2 id="三种打包模式"><a href="#三种打包模式" class="headerlink" title="三种打包模式"></a>三种打包模式</h2><ul>
<li>单 NAL 单元模式</li>
<li>非交错模式</li>
<li>交错模式</li>
</ul>
<img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/三种打包模式.png" alt="三种打包模式" style="zoom:50%;">

<h1 id="RTP数据包格式"><a href="#RTP数据包格式" class="headerlink" title="RTP数据包格式"></a>RTP数据包格式</h1><img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/RTP格式.png" alt="RTP格式" style="zoom:50%;">

<ul>
<li>Version（V）：2bits，RTP 版本信息，目前是 2</li>
<li>Padding（P）: 1bit，如果是 1，表示 RTP 包的尾部有填充字节，尾部最后一个字节表示填充的字节数（包括它自己）</li>
<li>Extension（X）：1bit，如果是 1，表示存在头部扩展</li>
<li>CSRC（CC）：4bits，表示 CSRC 的个数</li>
<li>Marker（M）：1bit，对于视频，标记一帧的结束；对于音频，标记会话的开始</li>
<li>PayloadType（PT）：7bits，负载的类型，比如 111，代表是的音频 opus</li>
<li>Sequence number：16bits，包序列号，每发送一个包，序列号增加 1，可以用接收端的丢包检测以及重传。该值的初始值最好是随机的，以增加被攻击的难度</li>
<li>Timestamp：32bits，时间戳，代表了每个 RTP 包第一个字节的采样瞬间，它必须是从时间上单调线性递增的时钟中导出，以允许同步和抖动计算。时间戳的初始值最好是一个随机值，和包序列号类似。通常时间戳的计算，一般结合采样频率进行递增。如果传输两个或者以上的媒体，比如同时传输音频和视频，时间戳可以是独立计算的，起始参考值可能也没有对齐，那么接收端怎么进行音视频同步呢？接收端通过接收发送端发送的 sender report 报告，该报告里携带一个时间戳和与之映射的绝对时间（或者两者共同的参考时间）信息，接收端通过该映射关系，来进行同步</li>
<li>SSRC：32bits，同步信源标识符，它是一个随机值，唯一标记一个媒体源，在同一个会话当中，不同的同步信源必须是不同的值</li>
<li>CSRC list：可以有多个，0 ~ 15 个，每个占用 32bits 标识 RTP 中包含的有效负载的贡献来源。比如音频包，可能是包含多人的混音数据，csrc list 能够标记所有包含的讲话来源，方便接收端识别哪些人在讲话</li>
</ul>
<h1 id="RTCP调优音视频QoS"><a href="#RTCP调优音视频QoS" class="headerlink" title="RTCP调优音视频QoS"></a>RTCP调优音视频QoS</h1><p>RTP 通常是基于 UDP 的，所以无法保证数据包可靠、顺序送达对端，为了保证质量，RTP 和 RTCP 通常需要配套使用， RTCP 包提供相应的反馈机制来确保服务质量。</p>
<p>RTCP 控制 QoS 的常用类型：</p>
<ul>
<li>Sender Report （SR）包，通常是发送端定期发送，包含当前发送端累计发送的包个数和发送字节数，比较重要的是 NTP 时间和 RTP 时间信息，有两者的关系，可以用于接收端的音视频同步</li>
<li>Receiver Report（RR）包，通常是接收端定期发送，包含累计丢包数、丢包率、网络抖动、当前收到的最大 sequence number 信息，还有一个比较重要的信息是，last SR（上一个 sender report的发送时间）以及 delay since last SR（在接收端发送 RR 时，上一个 SR 相比这个时间，已经过去了多长时间），这两个信息可以用于发送端计算  RTT</li>
<li>NACK 包，接收端丢包重传请求包，用于当发生网络丢包时，接收端向发送端请求哪些数据包需要重传</li>
<li>REMB 包，定期发送，接收端向发送端反馈当前估计能接收的最大码率是多少，用于 GCC 拥塞控制</li>
<li>PLI 包，当接收端无法正确解码时，可以向发送端发送此包，发送端收到该 RTCP 包会重新编码一个新的关键帧，发送给接收端</li>
<li>Extented Reports 包（XR 包），用于接收端估计 RTT</li>
<li>Transport-cc 包，反馈数据包的到达时间，用于发送端计算包组间隔，最终用于 GCC 拥塞控制</li>
<li>Bye 包，通知对方，本端将要关闭流会话</li>
</ul>
<h1 id="RTCP定时发送机制"><a href="#RTCP定时发送机制" class="headerlink" title="RTCP定时发送机制"></a>RTCP定时发送机制</h1><p>如何设置 RTCP 包的发送时间间隔？</p>
<ul>
<li>在 RFC3550 标准的 6.2 节，关于 rtcp 的时间间隔有详细的说明</li>
<li>基本原则：RTCP 包消耗的带宽不应超过会话带宽的 5%</li>
<li>WebRTC 的计算方法<ul>
<li>对于音频默认值是 5s，对于视频默认值是 1s</li>
<li>如果是视频并且发送数据<ul>
<li>Minimum_interval &#x3D; 360kbps &#x2F; 会话的带宽(发送码率)</li>
<li>如果视频的发送码率小于360k，间隔同样设置为1s，比如 10kbps，这样可能会打破 5% 的带宽限制，但是应该非常少</li>
<li>当 RTCP 包还没有发送时，时间间隔设置为配置间隔值的一半，音频是 2.5s，视频是 0.5s</li>
<li>最终的发送时间间隔：首先需要在 [0.5, 1.5] 之间随机一个数作为倍数，用计算或者配置的时间间隔 * 随机出来的倍数作为下一次发送 RTCP 包的时间间隔，比如，如果音频和视频都是默认值，则音频的最终发送时间间隔在 [1.5s, 7.5s] 之间随机,视频最终的发送时间间隔在 [0.5s, 1.5s] 之间随机，这样做的目的，是防止在视频会议的场景，参与人数比较多，防止大家都在相同的时刻发送 RTCP 包，增加网络负担</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="RTCP复合数据包"><a href="#RTCP复合数据包" class="headerlink" title="RTCP复合数据包"></a>RTCP复合数据包</h1><ul>
<li><p>Compound 包</p>
<ul>
<li>在 RFC4585 中，有详细的定义</li>
<li>Compound 包至少包含一个SR 或者 RR 包，随后是至少包含 CNAME 信息的 SDES 包。它的缺点就是 RTCP 包比较大</li>
</ul>
</li>
<li><p>Reduced-Size 包</p>
<ul>
<li>在 RFC5506 中，有详细的定义</li>
<li>Reduced-Size 包只包含当前 RTCP 类型的必要内容，不会包含多余的 SR 或者 RR 包。比如 NACK 包，就只包含 NACK 相关的信息。这种模式最大的好处就是 RTCP 包的大小大幅减少，有利于网络传输</li>
</ul>
</li>
<li><p>在 RFC3550 规范中，发送 RTCP 包强制使用 Compound 包模式</p>
</li>
</ul>
<h1 id="SR数据包格式"><a href="#SR数据包格式" class="headerlink" title="SR数据包格式"></a>SR数据包格式</h1><ul>
<li><p>参考 RTCP 协议</p>
</li>
<li><p>当前时间对应的 RTP 时间戳（ms） &#x3D; 当前时间 - 最后音视频的采集时间 *（频率（90000） &#x2F; 1000） + 最后一个 RTP 时间戳</p>
</li>
</ul>
<h1 id="SR发送调优策略"><a href="#SR发送调优策略" class="headerlink" title="SR发送调优策略"></a>SR发送调优策略</h1><ul>
<li>在关键帧发送之前，尽量将 RTCP 包优先发送出去</li>
<li>由于 SR 包是按照定时机制触发发送的，可能出现时间条件满足了，但此时还没有任何 RTP 包发送，我们应当避免当没有任何 RTP 包发送时，发送 SR 包，因为也无法计算 rtp_timestamp</li>
</ul>
<h1 id="RR数据包格式"><a href="#RR数据包格式" class="headerlink" title="RR数据包格式"></a>RR数据包格式</h1><ul>
<li>参考 RTCP 协议</li>
</ul>
<h1 id="发送端计算RTT"><a href="#发送端计算RTT" class="headerlink" title="发送端计算RTT"></a>发送端计算RTT</h1><ul>
<li><p>RTT，网络请求的往返延迟，在很多 QoS 优化策略当中，都会用到 RTT 时间</p>
</li>
<li><p>NTP 时间，用 64 位整数来表示，表示的是从 1900 年 1 月 1 日 00:00:00 起流逝的秒数，其中高 32 位表示的是秒数的整数部分，低 32 位表示秒数的小数部分</p>
</li>
<li><p>WebRTC 中的 RR 包用的是 NTP 的压缩时间，用 32 位表示</p>
<ul>
<li>取整数部分的低 16位，小数部分的高16 位，压缩后的时间单位是 1&#x2F;2^16 秒</li>
</ul>
</li>
<li><p>LastSr（压缩后的 NTP 时间），上一次收到的 SR 包中的 NTP 时间，实际上代表了 SR 包在发送端的发送时间</p>
</li>
<li><p>Delay Since LastSr （时间单位 1&#x2F;2^16 秒） ，上一次收到 SR 包的时间，到当前发送 RR 包之间的时间间隔</p>
</li>
<li><p><code>RTT = receive_time_ntp – last_sr – delay_since_last_sr</code></p>
</li>
</ul>
<h1 id="NACK数据包格式"><a href="#NACK数据包格式" class="headerlink" title="NACK数据包格式"></a>NACK数据包格式</h1><ul>
<li>参考 RTCP 协议</li>
<li>RFC4585 规范，关于 QoS 的反馈信息有两种<ul>
<li>传输层的 feedback message（Rtpfb）<ul>
<li>Nack、Transport Feedback</li>
</ul>
</li>
<li>特定负载的 feedback message（Psfb）<ul>
<li>Pli</li>
</ul>
</li>
</ul>
</li>
<li>发送前需要缓存 RTP 包，用于 NACK 重传</li>
</ul>
<h1 id="RTX重传包格式"><a href="#RTX重传包格式" class="headerlink" title="RTX重传包格式"></a>RTX重传包格式</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class="line">// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">// |                          RTP Header                           |</span><br><span class="line">// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">// |             OSN               |                               |</span><br><span class="line">// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |</span><br><span class="line">// |                    Original RTP Packet Payload                |</span><br><span class="line">// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br></pre></td></tr></table></figure>

<p>RTX 有独立的 payload_type 和 ssrc，需要重新设置</p>
<p>OSN：原始的 sequence_number</p>
<h1 id="音频数字化三要素"><a href="#音频数字化三要素" class="headerlink" title="音频数字化三要素"></a>音频数字化三要素</h1><ul>
<li>采样率</li>
<li>采样位深</li>
<li>声道数</li>
</ul>
<h1 id="音频采集"><a href="#音频采集" class="headerlink" title="音频采集"></a>音频采集</h1><p>需要链接额外库：msdmo、dmoguids、wmcodecdspuuid</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;atomic&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;modules/audio_device/include/audio_device.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;api/task_queue/default_task_queue_factory.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 回调获取采集数据</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyVideoSink</span> : <span class="keyword">public</span> webrtc::AudioTransport</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">        <span class="function"><span class="type">int32_t</span> <span class="title">RecordedDataIsAvailable</span><span class="params">(<span class="type">const</span> <span class="type">void</span>* audioSamples,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">size_t</span> nSamples,  <span class="comment">// 每个声道数包含的样本数</span></span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">size_t</span> nBytesPerSample,  <span class="comment">// 每个样本的字节数</span></span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">size_t</span> nChannels,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">uint32_t</span> samplesPerSec,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">uint32_t</span> totalDelayMS,  <span class="comment">// 参考信号和远端回声信号之间的延迟</span></span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">int32_t</span> clockDrift,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">uint32_t</span> currentMicLevel,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">bool</span> keyPressed,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">uint32_t</span>&amp; newMicLevel)</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">            </span><br><span class="line">            <span class="type">int</span> len = <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(nSamples * nBytesPerSample);</span><br><span class="line">            <span class="keyword">auto</span> frame = std::<span class="built_in">make_shared</span>&lt;MediaFrame&gt;(webrtc::AudioFrame::kMaxDataSizeBytes);</span><br><span class="line">            frame-&gt;fmt.media_type = MainMediaType::kMainTypeAudio;</span><br><span class="line">            frame-&gt;fmt.sub_fmt.audio_fmt.type = SubMediaType::kSubTypePcm;</span><br><span class="line">            <span class="comment">// 采样位数</span></span><br><span class="line">            frame-&gt;fmt.sub_fmt.audio_fmt.nbytes_per_sample = nBytesPerSample;</span><br><span class="line">            <span class="comment">// 每个声道数包含的样本数 </span></span><br><span class="line">            frame-&gt;fmt.sub_fmt.audio_fmt.samples_per_channel = nSamples;</span><br><span class="line">            <span class="comment">// 通道数</span></span><br><span class="line">            frame-&gt;fmt.sub_fmt.audio_fmt.channels = nChannels;</span><br><span class="line">            <span class="comment">// 采样率</span></span><br><span class="line">            frame-&gt;fmt.sub_fmt.audio_fmt.samples_per_sec = samplesPerSec;</span><br><span class="line">            <span class="comment">// 参考信号和远端回声信号之间的延迟</span></span><br><span class="line">            frame-&gt;fmt.sub_fmt.audio_fmt.total_delay_ms = totalDelayMS;</span><br><span class="line">            <span class="comment">// 采集音频过程中是否有键盘敲击</span></span><br><span class="line">            frame-&gt;fmt.sub_fmt.audio_fmt.key_pressed = keyPressed;</span><br><span class="line">            frame-&gt;data_len[<span class="number">0</span>] = len;</span><br><span class="line">            <span class="built_in">memcpy</span>(frame-&gt;data[<span class="number">0</span>], audioSamples, len);</span><br><span class="line">            <span class="comment">// 计算时间戳，根据采样频率进行单调递增</span></span><br><span class="line">            timestamp_ += nSamples;</span><br><span class="line">            frame-&gt;ts = timestamp_;     </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Implementation has to setup safe values for all specified out parameters.</span></span><br><span class="line">    <span class="function"><span class="type">int32_t</span> <span class="title">NeedMorePlayData</span><span class="params">(<span class="type">const</span> <span class="type">size_t</span> nSamples,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">size_t</span> nBytesPerSample,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">size_t</span> nChannels,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">const</span> <span class="type">uint32_t</span> samplesPerSec,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">void</span>* audioSamples,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">size_t</span>&amp; nSamplesOut,  <span class="comment">// NOLINT</span></span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int64_t</span>* elapsed_time_ms,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int64_t</span>* ntp_time_ms)</span> <span class="keyword">override</span> </span>&#123; <span class="keyword">return</span> <span class="number">-1</span>; &#125; <span class="comment">// NOLINT</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Method to pull mixed render audio data from all active VoE channels.</span></span><br><span class="line">    <span class="comment">// The data will not be passed as reference for audio processing internally.</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">PullRenderData</span><span class="params">(<span class="type">int</span> bits_per_sample,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int</span> sample_rate,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">size_t</span> number_of_channels,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">size_t</span> number_of_frames,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">void</span>* audio_data,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int64_t</span>* elapsed_time_ms,</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="type">int64_t</span>* ntp_time_ms)</span> <span class="keyword">override</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">uint32_t</span> timestamp_;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::unique_ptr&lt;webrtc::TaskQueueFactory&gt; task_queue_factory = </span><br><span class="line">        webrtc::<span class="built_in">CreateDefaultTaskQueueFactory</span>();</span><br><span class="line">	rtc::scoped_refptr&lt;webrtc::AudioDeviceModule&gt; audio_device =</span><br><span class="line">        webrtc::AudioDeviceModule::<span class="built_in">Create</span>(</span><br><span class="line">            webrtc::AudioDeviceModule::kPlatformDefaultAudio,</span><br><span class="line">            task_queue_factory.<span class="built_in">get</span>());</span><br><span class="line">    <span class="comment">// 初始化音频设备</span></span><br><span class="line">    audio_device-&gt;<span class="built_in">Init</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取麦克风的数量</span></span><br><span class="line">    <span class="type">int16_t</span> count = audio_device-&gt;<span class="built_in">RecordingDevices</span>();</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;audio device count:&quot;</span> &lt;&lt; count &lt;&lt; std::endl;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取第一个摄像头的信息</span></span><br><span class="line">    <span class="type">size_t</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">128</span>];</span><br><span class="line">    <span class="type">char</span> guid[<span class="number">128</span>];</span><br><span class="line">    <span class="type">int32_t</span> ret = audio_device-&gt;<span class="built_in">RecordingDeviceName</span>(index, name, guid);</span><br><span class="line">    <span class="keyword">if</span> (res) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Device name:&quot;</span> &lt;&lt; std::<span class="built_in">string</span>(name) &lt;&lt; </span><br><span class="line">            <span class="string">&quot;; device id: &quot;</span> &lt;&lt; std::<span class="built_in">string</span>(guid) </span><br><span class="line">            &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 启动麦克风</span></span><br><span class="line">    <span class="comment">// 1.注册回调接口用于采集数据</span></span><br><span class="line">    MyAudioSink asink;</span><br><span class="line">    audio_device-&gt;<span class="built_in">RegisterAudioCallback</span>(&amp;asink);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2.检查系统是否存在麦克风设备</span></span><br><span class="line">    <span class="type">int</span> total = audio_device-&gt;<span class="built_in">RecordingDevices</span>();</span><br><span class="line">    <span class="keyword">if</span> (total &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">RTC_LOG</span>(LS_WARNING) &lt;&lt; <span class="string">&quot;no audio device&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3.设置启用的麦克风设备</span></span><br><span class="line">    <span class="keyword">if</span> (audio_device-&gt;<span class="built_in">SetRecordingDevice</span>(index)) &#123;</span><br><span class="line">        <span class="built_in">RTC_LOG</span>(LS_WARNING) &lt;&lt; <span class="string">&quot;SetRecordingDevice failed, mic_id: &quot;</span> &lt;&lt; std::<span class="built_in">to_string</span>(guid);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 4.设置为立体声采集</span></span><br><span class="line">    audio_device-&gt;<span class="built_in">SetStereoRecording</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5.初始化麦克风</span></span><br><span class="line">    <span class="keyword">if</span> (audio_device-&gt;<span class="built_in">InitRecording</span>() || !audio_device-&gt;<span class="built_in">RecordingIsInitialized</span>()) &#123;</span><br><span class="line">        <span class="built_in">RTC_LOG</span>(LS_WARNING) &lt;&lt; <span class="string">&quot;InitRecording failed, mic_id: &quot;</span> &lt;&lt; std::<span class="built_in">to_string</span>(guid);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6.启动麦克风采集</span></span><br><span class="line">    <span class="keyword">if</span> (audio_device-&gt;<span class="built_in">StartRecording</span>()) &#123;</span><br><span class="line">        <span class="built_in">RTC_LOG</span>(LS_WARNING) &lt;&lt; <span class="string">&quot;StartRecording failed, mic_id: &quot;</span> &lt;&lt; std::<span class="built_in">to_string</span>(guid);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 7.停止录音</span></span><br><span class="line">    <span class="keyword">if</span> (audio_device-&gt;<span class="built_in">RecordingIsInitialized</span>()) &#123;</span><br><span class="line">        audio_device-&gt;<span class="built_in">StopRecording</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 8.释放音频设备</span></span><br><span class="line">    audio_device-&gt;<span class="built_in">Terminate</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3A算法预处理"><a href="#3A算法预处理" class="headerlink" title="3A算法预处理"></a>3A算法预处理</h1><h2 id="回声消除"><a href="#回声消除" class="headerlink" title="回声消除"></a>回声消除</h2><p><strong>音频为什么需要预处理</strong></p>
<p>从声音采集设备采集出来的原始声音会存在一些问题，比如你正在直播时，周围环境可能存在噪声，这样势必会影响直播的效果。再比如两个人正在进行音视频通话时，同时又开启了扬声器，此时可能会存在回声现象，进而影响通话的质量。还有一些设备采集出来的声音数据有时响度偏高，有时响度又偏低，造成声音忽大忽小，影响听众的主观感受。因此，需要对原始音频采样数据进行算法预处理，最大限度的消除这些影响，从而保证更加舒适的音频通信。</p>
<p> <strong>3A 算法</strong></p>
<ul>
<li>AEC （Acoustic Echo Canceller） 声学回声消除</li>
<li>ANS （Ambient Noise Suppression）环境噪声抑制</li>
<li>AGC（Automig Gain Control）自动音量增益控制</li>
</ul>
<p>由于这三个算法都是以 A 开头，所以统称为 3A 算法。</p>
<p><strong>回声消除</strong></p>
<ul>
<li>回声是一种物理和生理共同作用产生的声学现象，当原始声被反射之后，反射声和原始声延时相差100ms 以上时，人耳可以听到分离的两个声音，从而产生回声。通常在空旷的山谷可以听到回声</li>
<li>音视频场景中回声产生的原因</li>
</ul>
<img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/音视频场景中回声产生.png" alt="音视频场景中回声产生" style="zoom:50%;">



<ul>
<li>当 A 说话时，产生的语音 A 被麦克风采集，并通过网络传输给用户 B，成为待播放的语音 AI</li>
<li>﻿﻿语音 A1 被用户 B 的扬声器播放之后，通过直射或者环境反射，最终被用户B的麦克风采集为语音 A2（图中的回声 A2）</li>
<li>语言 B 和回采的语音 A2 通过网络传输给用户 A，并在用户 A 的扬声器中播放出来，此时，用户 A 会发现自己说完一句话后，很快又听到了自己的复述，从而产生回声现象</li>
</ul>
<p><strong>回声消除的基本思路</strong></p>
<p>用户 A 在说话时听到的回声，是用户 B 的麦克风回采了用户 A 的语音导致的，通常解法这个问题，需要在用户 B 这一侧进行处理。</p>
<img src="/2024/04/19/RTC%E6%8E%A8%E6%B5%81/回声消除.png" alt="回声消除" style="zoom:50%;">

<p>语音 A1 会通过用户B的扬声器进行播放，属于已知的信号，我们称之为参考信号。回声 A2 称为远端回声信号，语音B称为近端语音信号，两者都被麦克风采集成为混合信号 C，所以 C &#x3D; A2 + B，C 是可获知的，但是 A2 和 B 已经融合到一起，不容易区分。</p>
<p>回声消除要做的就是将 A2 从 C 中减去，即 B1&#x3D; C - A2，比较理想的情况是 B &#x3D; B1。我们可以利用的是参考信号 A1，因为  A2 是参考信号 A1 的回声，但是 A1 和 A2 并不完全等同，因为参考信号 A1 被播放、到回声 A2 被采集，经过了扬声器-&gt;环境-&gt;麦克风的传播路径（LRM，Loudspeaker-Room-Microphone），这里面存在众多不确定的因素，使得 A2 和 A1 有很大的差别。</p>
<p>但是 A2 和 A1 之间有不可忽视的相关性，可以利用这些相关性，找出间接的求解路径：将 LRM 路径通过数学方式进行模拟，求解为函数 F(x），则有 A2 &#x3D; F(A1)，最终问题转化为 B1 &#x3D; C - F(A1)。接下来的重点是通过估计回声路径的特征参数，对该路径进行模拟，获得函数 F(x)，实际上获得精确的求解函数使得 F(A1) &#x3D; A2 是几乎不可能的，因为这里面不仅需要面对复杂的外部反射环境，还要考虑采集、播放设备引入的异常，最终的目标是获得一个最优近似解。</p>
<p><strong>回声消除的算法原理</strong></p>
<p>回声消除 AEC 的输入：参考信号 A1，远端回声信号 A2，近端语音信号 B，期望输出的信号是干净的近端语音信号 B。</p>
<p>环境中的回声路径 LRM 是未知的，同时环境是多变的，所以我们需要设计一个自适应线性滤波器来完成对回声路径 F(x) 的求解。大概过程是这样的：</p>
<ul>
<li>当用户 B 不说话的时候，此时 B 的麦克风就只有远端回声信号 A2，用 F(x) 对参考信号 A1 进行估计得到 F(A1)，A2 - F(A1) 得到估计的误差值，用误差值来更新滤波器的系数，这样自适应线性滤波器就能逼近真实的回声路径。</li>
<li>参考信号样本（A10，A11，…A1n）</li>
<li>用户B不说话时，可以获得远端回声信号（A20， A21，…A2n）两组样本之间是有相关性的，相关函数就是回声路径F(x)，最终我们通过两组样本数据，不断的迭代自适应线性滤波器的系数，获得回声路径 F(x)，后续可以利用这个F(x)，传入参考信号 Al，就能估计出回声信号 F(AI)，然后从混合信号中减去回声信号 F(A1)，就能得到相对纯净的近端语音信号 B，从而实现了回声消除</li>
<li>当用户 B 说话的时候，用户 B 的麦克风包含了近端语音信号 B，此时就不能更新自适应滤波器的參数</li>
<li>需要静音检测的功能（VAD）</li>
</ul>
<p>自适应线性滤波器根据参考信号 A1 估计出 A2。既然是估计石这里必然存在误差，也就是只是对近端语音 B 进行了提纯，但是其中还会残留部分回声，我们还需要进一步对残留进行消除，主要手段还是分析残留和远端参考信号的相关性，相关性越大，残留越多，反之则残留越少。</p>
<p>最后，还可能存在少部分顽固分子，比如扬声器、麦克风等设备失真引入的非线性信号，这部分是线性滤波器无法消除的，只能通过非线性的剪切处理。</p>
<p>综上，完整的回声消除流程 &#x3D; 自适应线性滤波+残留回声消除＋非线性剪切处理。</p>
<p><strong>单讲&#x2F;双讲的不同策略</strong></p>
<ul>
<li>如果是单讲场景，由于只有远端用户 A 说话，用户 B 的麦克风采集的语音信号就只有远端回声，不包含近端语音。这种情况回声消除就相对容易，甚至可以直接干掉所有的语音信号，再适当的填充舒适噪音来提升听感</li>
<li>如果是双讲场景，由于远端、近端用户同时在说话，麦克风采集的信号同时包含远端回声信号和近端语音信号，要彻底把远端回声信号消除，又要保证近端语音的音质，难度偏大。如果远端回声比近端语音的能量更高，消除过程就很难避免对近端语音的损伤，此时应当适当降低自适应线性滤波器的消除粒度，后续的残留回声消除和非线性剪切策略也要相应的调整</li>
</ul>
<p><strong>实际应用场景中的回声问题</strong></p>
<ul>
<li>混合信号 C 的问题，如果信号 C 中的远端回声能量高于近端语音，比如扬声器离麦克风太近或者扬声器音量太大把近端语音都掩盖掉了，这种情况进行回声消除效果可能不佳，此时，最好的办法是适当降低本地的播放音量</li>
<li>采样信号 A1 的问题：如果 A1 在播放时进行了音效处理，导致实际播放的信号和参考信号存在很大差别，此时回声消除的效果不佳</li>
<li>回声路径函数 F(x) 的问题，比如音频设备不停的移动，或者用户从空旷的房间突然进入嘈杂的走廊，都会导致 LRM  路径变化，滤波器还未来得及适应和收敛，就会出现回声。这种情况，一方面可以优化画声消除算法，江提高自适应、收敛的速度；另外一方面尽量保证环境的稳定</li>
<li>解决回声最简单有效的办法——戴上耳机。戴上耳机之后，远端的语音就不会被麦克风进行回采，自然也就不需要进行回声消除。特别是对音质、实时性都要求比较高的场景，可以建议用户戴上耳麦</li>
</ul>
<h2 id="噪声抑制"><a href="#噪声抑制" class="headerlink" title="噪声抑制"></a>噪声抑制</h2><p><strong>噪声</strong></p>
<p>实时音视频通信或者直播的场景下，有用的声音通常指的是人的声音，其它声音一般都可认为是噪声。</p>
<p><strong>分类</strong></p>
<ul>
<li>稳态噪声，指的是那些在时间上连续、持续，且幅度和频谱等信号特征稳定或者变化缓慢的噪声。典型的如空调声，风扇声等，听起来是持续、平稳的“嗡嗡嗡”</li>
</ul>
<ul>
<li>﻿非稳态噪声，是相对于稳态噪声而言，它的信号特征不稳定，随时间变化的幅度较大，或者有间断出现、瞬发的情况。典型的如菜场的喧闹声、关门声、烟花爆竹声等等</li>
</ul>
<p>无论是稳态噪声还是非稳态噪声，都是相对于人声的加性噪声。加性噪声和人声不相关，它们的混合信号可以通过相加得到。当然还有乘性噪声，这些噪声和人声有关，因为人声的存在才存在，比如房间混响，这里重点讨论加性噪声。</p>
<p><strong>噪声抑制</strong></p>
<ul>
<li><p>在噪声抑制的难易程度上，稳态噪声抑制难度更低，方案也更成熟。非稳态噪声抑制的难度则相对比较大。</p>
</li>
<li><p>基本原理</p>
<ul>
<li>如果我们能够估计出噪声信号 B1，然后从混合信号当中减去，就得到了语音降噪信号 A1，A1 &#x3D; C - B1</li>
<li>通常 ANS 算法的核心可以拆解为噪声估计模块和噪声滤除模块</li>
</ul>
</li>
<li><p>噪声估计</p>
<ul>
<li>主要工作：判断当前信号是语音还是噪声，以及噪声的量</li>
<li>基于谱减法的噪声估计，一般认为带噪请音的前几帧不包含语音活动，是纯净的噪声信号，因此，可以取这前儿帧的平均信号谱（幅度谱或者能量谱）作为噪声谱的估计</li>
<li>基于语音活动检测（VAD）的噪声估计，会对混合信号C进行逐帧检测，如果某音频帧经过 VAD 检测没有语音，则认为是噪声，并更新噪声谱，否则就沿用上一帧的噪声</li>
<li>以上两种方法，往往需要纯净的噪声信号，并且要求稳定，对于复杂多变的实际应用场景来说，通常很难满足。在 RTC 场景，通常使用基于统计模型的噪声估计</li>
<li>基于统计模型的噪声估计<ul>
<li>WebRTC 中基于统计模型的噪声估计方法如下：<ul>
<li>初始噪声估计，使用分位数噪声估计法，对某个频带上所有语音帧的能量进行统计，设定一个分位数值，能量低于分位数值认为是噪声，反正则认为是语音</li>
<li>更新初始噪声估计，基于似然比函数改造的噪声估计：将多个语音&#x2F;噪声分类特征合并到一个模型当中，结合模型以及初始噪声估计的先验&#x2F;后验信噪比，对输入的每帧频谱进行分析，计算某一帧是语音&#x2F;噪声的概率来判断是否为噪声，进一步更新初始噪声估计</li>
<li>﻿更新后的噪声估计会比初始估计更加准确，更新后需要重新计算先验&#x2F;后验信噪比，再用于后续的噪声滤除模块</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>WebRTC 中基于维纳滤波器的噪声滤除</strong></p>
<ul>
<li>将带噪语音 A 输入到一个噪声滤波器，如果期望输出的信号为 AI，实际输出的信号为 A2，通过计算得到 A1 和 A2 的误差为E，我们希望 A2 尽可能的逼近 AL，那么估计误差 E 就尽可能小，而能实现这个目标的最优滤波器就是维纳滤波器</li>
<li>维纳滤波器是一种线性滤波器，其数学表达式的推导需要用到语音信号的先验&#x2F;后验信嗓比，而噪声估计模块正好可以输出这些信息</li>
</ul>
<p><strong>WebRTC 降噪模块存在的一些问题</strong></p>
<ul>
<li>对非稳态噪声的抑制效果不佳<ul>
<li>如果噪声的统计特性不稳定，基于统计模型的噪声估计效果会大打折扣，进而影响降噪效果</li>
<li>﻿﻿因为只有在概率足以判断当前音频帧为噪声时，算法才会更新初始噪声估计。如果噪声经常改变，而且在语音段发送变化（比如有其它人声时），可能就无法判定出来，影响抑制效果</li>
</ul>
</li>
</ul>
<ul>
<li>对低信噪比场景的降噪效果不佳<ul>
<li>在大噪声&#x2F;低语音能量的场景下，由于信噪比很低，对语音&#x2F;噪声的概率判逝成功率下降，可能导致抑制不干净，甚至可能错误抑制了语音造成语音损伤</li>
</ul>
</li>
</ul>
<h2 id="自动增益控制"><a href="#自动增益控制" class="headerlink" title="自动增益控制"></a>自动增益控制</h2><p><strong>为什么需要 AGC</strong></p>
<ul>
<li><p>在实际的应用场景中，我们会遇到很多声音的问题</p>
<ul>
<li><p>﻿﻿音量太小，我们无法辨识具体的语音信息</p>
</li>
<li><p>﻿﻿音量太大，我们的耳朵遭受暴击</p>
</li>
<li><p>﻿﻿音量忽大忽小，一段语音里可能同时存在上述两个问题</p>
</li>
</ul>
</li>
<li><p>解决这个问题的一个办法，就是手动调节，讲话者调整麦克风的音量，听众调整播放器的音量。但是这种手动调节，一来不够便捷，二来众口难调。在实际的场景中，环境复杂多变，说话者不同则声音的原始音量有差异、说话者距离麦克风远近不同则声音传播的衰藏有差异，麦克风设备不同则采集增益有差异。这些差异使得一次手动调节很难适应环境的动态变化，如果场景中存在多个用户使用一个麦克风的情况，更难一一兼顾</p>
</li>
<li><p>AGC 针对上述情况，会自动调节采集端的音量，如果讲话者的声音过大，AGC 会自动降低增益；反之则提高增益，以确保音量维持在一个比较稳定的水平。这样，用户无需频繁调整设备，可以专注于 RTC 的音视频交互</p>
</li>
</ul>
<p><strong>音量增益的本质</strong></p>
<ul>
<li>决定音量大小的物理量为“振幅”，调节振幅实际上就是调节采样点的幅值，实现上将采样点的幅值乘上一个系数，如果系数大于1，就是放大音量；系数小于1，就是减小音量</li>
<li>幅值放大的倍数，和人耳听觉的感知大小并不成线性关系，也就是说幅值放大一倍，并不代表感知的音量也放大一倍。这两种物理量比值的非线性关系，可以借助分贝来处理。音频位深为 16bit，振幅 A1 的音频相对于振幅 A2 的音频，其音量的增益为：<code>20 * log10(A1 / A2)</code>。如果采样点幅值增大一倍，即 <code>A1 / A2 = 2</code>，此时声音的增益为 <code>20 * log10(2) ~= 6dB</code></li>
</ul>
<p><strong>音量增益的方法</strong></p>
<ul>
<li>模拟增益，调整连续模拟信号的波形幅度，一般依赖设备系统接口，控制设备硬件的采集增益，调节系统采集音量。通常 windows 和 mac 端普遍支持模拟增益调节。而移动端 （Android、iOS）、linux 端一般没有调节系统采集音量的接口，无法进行模拟增益调节</li>
<li>数字增益，调整离散数字信号的波形幅度，不依颗于设备系统接口，不调节系统采集音量</li>
</ul>
<p><strong>AGC 的增益策略</strong></p>
<ul>
<li>首先，我们不能对回声或者噪声进行增益，基于此，一般将 AGC 模块放到 AEC&#x2F;ANS 模块之后，进一步为了避免漏网之鱼，往往还需要进行人声检测（VAD），进一步区分语音段和无话段</li>
<li>目标的设定和限制<ul>
<li>目标音量，表示要将音量调节的目标大小</li>
<li>﻿﻿增益能力，表示音量调节的最大增益</li>
<li>﻿﻿压限开关，表示是否使用压限逻辑，对超过目标音量的部分进行限制</li>
</ul>
</li>
<li>WebRTC-AGC 算法策略<ul>
<li>固定数字增益策略，对音频音量做固定的、不超过所设增益能力的数字增益调节，且调节后的音量需低于目标音量（若使用压限逻辑）<ul>
<li>缺点<ul>
<li>由于增益量固定，缺少反馈机制，对于音量持续较小的信号改善有限</li>
<li>对于音量持续较大的信号，如果增益能力设置不合理，可能导致噪声音量相对语音部分提升更多，处理之后噪声变得更加明显</li>
</ul>
</li>
</ul>
</li>
<li>自适应模拟增益策略，在固定数字增益的基础上，利用反馈机制，增加了对当前设备模拟增益的控制<ul>
<li>优势<ul>
<li>固定数字增益和动态模拟增益相相成，利用反馈机制提高了策略的灵活性、以及均衡效果</li>
</ul>
</li>
<li>缺点<ul>
<li>﻿需要调用系统接口，如果信号比较复杂，调整比较频繁，会产生额外的性能消耗</li>
<li>﻿对于缺少相关系统接口的移动端设备，无法进行</li>
</ul>
</li>
</ul>
</li>
<li>自适应数字增益策略，参考了模拟增益的原理，并同样使用基于反馈机制的调节逻辑，会根据前序处理结果，动态调节数字增益参数，持续优化增益效果<ul>
<li>优势<ul>
<li>由于只进行数字增益，不依赖系统接口，可以应用于移动设备，使用范围更广</li>
</ul>
</li>
<li>缺点<ul>
<li>灵敏度不足，增益调节速度不够快</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="WebRTC音频3A处理核心流程"><a href="#WebRTC音频3A处理核心流程" class="headerlink" title="WebRTC音频3A处理核心流程"></a>WebRTC音频3A处理核心流程</h1><ol>
<li>相关头文件</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;modules/audio_processing/include/audio_processing.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;common_audio/resampler/include/push_resampler.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;api/audio/audio_frame.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;common_audio/include/audio_util.h&gt;</span></span></span><br></pre></td></tr></table></figure>



<ol start="2">
<li>创建 APM</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rtc::scoped_refptr&lt;webrtc::AudioProcessing&gt; audio_processing = </span><br><span class="line">    webrtc::<span class="built_in">AudioProcessingBuilder</span>().<span class="built_in">Create</span>();</span><br></pre></td></tr></table></figure>



<ol start="3">
<li>APM 模块功能设置</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获得apm模块默认的配置</span></span><br><span class="line">webrtc::AudioProcessing::Config apm_config = audio_processing_-&gt;<span class="built_in">GetConfig</span>();</span><br><span class="line"><span class="comment">// AEC</span></span><br><span class="line">apm_config.echo_canceller.enabled = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// 移动端</span></span><br><span class="line"><span class="comment">// apm_config.echo_canceller.mobile_mode = true;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// VAD</span></span><br><span class="line">apm_config.high_pass_filter.enabled = <span class="literal">true</span>;</span><br><span class="line">apm_config.voice_detection.enabled = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ANS</span></span><br><span class="line">apm_config.noise_suppression.enabled = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// 降噪等级</span></span><br><span class="line">apm_config.noise_suppression.level = webrtc::AudioProcessing::Config::NoiseSuppression::kHigh;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AGC</span></span><br><span class="line">apm_config.gain_controller1.enabled = <span class="literal">true</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(WEBRTC_WIN)</span></span><br><span class="line">    apm_config.gain_controller1.mode = apm_config.gain_controller1.kAdaptiveAnalog;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 应用功能设置</span></span><br><span class="line">audio_processing-&gt;<span class="built_in">ApplyConfig</span>(apm_config);</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>声道混合和重采样处理以及 3A 处理</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">InitializeCaptureFrame</span><span class="params">(<span class="type">int</span> input_sample_rate_hz, <span class="comment">// 原始采样率</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">int</span> send_sample_rate_hz, <span class="comment">// 最终发送的采样率</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">size_t</span> input_num_channels, <span class="comment">// 原始采样的声道数</span></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">size_t</span> send_num_channels, <span class="comment">// 最终发送的声道数</span></span></span></span><br><span class="line"><span class="params"><span class="function">    webrtc::AudioFrame* audio_frame)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> min_processing_sample_rate = std::<span class="built_in">min</span>(input_sample_rate_hz,</span><br><span class="line">        send_sample_rate_hz);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> native_sample_rate : webrtc::AudioProcessing::kNativeSampleRatesHz) &#123;</span><br><span class="line">        audio_frame-&gt;sample_rate_hz_ = native_sample_rate;</span><br><span class="line">        <span class="comment">// 在不丢失信息的情况下，尽可能用最小的采样率进行音频处理</span></span><br><span class="line">        <span class="keyword">if</span> (audio_frame-&gt;sample_rate_hz_ &gt; min_processing_sample_rate) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    audio_frame-&gt;num_channels_ = std::<span class="built_in">min</span>(input_num_channels,</span><br><span class="line">        send_num_channels);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DownmixChannels</span><span class="params">(<span class="type">const</span> <span class="type">int16_t</span>* src_audio,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">size_t</span> src_channels,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">size_t</span> samples_per_channel,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">size_t</span> dst_channels,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">int16_t</span>* dst_audio)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 当原始采集的声道数大于1，目标声道数=1</span></span><br><span class="line">    <span class="comment">// 4 -&gt; 1, 2 -&gt; 1</span></span><br><span class="line">    <span class="keyword">if</span> (src_channels &gt; <span class="number">1</span> &amp;&amp; dst_channels == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// 取多个声道的平均值</span></span><br><span class="line">        webrtc::<span class="built_in">DownmixInterleavedToMono</span>(src_audio, samples_per_channel,</span><br><span class="line">            src_channels, dst_audio);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (src_channels == <span class="number">4</span> &amp;&amp; dst_channels == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="comment">// 4 -&gt; 2</span></span><br><span class="line">        <span class="comment">// 原始数据是交错存储的, 1234 1234 ...</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; samples_per_channel; ++i) &#123;</span><br><span class="line">            <span class="comment">// 原始音频数据前两个声道的平均值，设置成目标的第一个声道</span></span><br><span class="line">            dst_audio[i * <span class="number">2</span>] = <span class="built_in">static_cast</span>&lt;<span class="type">int32_t</span>&gt;(src_audio[<span class="number">4</span> * i] + src_audio[<span class="number">4</span> * i + <span class="number">1</span>]) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">            <span class="comment">// 原始音频数据后两个声道的平均值，设置成目标的第二个声道</span></span><br><span class="line">            dst_audio[i * <span class="number">2</span> + <span class="number">1</span>] = <span class="built_in">static_cast</span>&lt;<span class="type">int32_t</span>&gt;(</span><br><span class="line">                src_audio[<span class="number">4</span> * i + <span class="number">2</span>] + src_audio[<span class="number">4</span> * i + <span class="number">3</span>]) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">RemixAndResample</span><span class="params">(<span class="type">const</span> <span class="type">int16_t</span>* src_data,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">size_t</span> samples_per_channel,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">size_t</span> num_channels,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">size_t</span> sample_rate_hz,</span></span></span><br><span class="line"><span class="params"><span class="function">    webrtc::PushResampler&lt;<span class="type">int16_t</span>&gt;* resampler,</span></span></span><br><span class="line"><span class="params"><span class="function">    webrtc::AudioFrame* dst_frame)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int16_t</span>* audio_ptr = src_data;</span><br><span class="line">    <span class="type">size_t</span> audio_ptr_num_channels = num_channels;</span><br><span class="line"></span><br><span class="line">    <span class="type">int16_t</span> downmixed_audio[webrtc::AudioFrame::kMaxDataSizeSamples];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果原始采集数据的声道数大于目标声道数，此时需要进行向下的声道混合处理</span></span><br><span class="line">    <span class="keyword">if</span> (num_channels &gt; dst_frame-&gt;num_channels_) &#123;</span><br><span class="line">        <span class="built_in">DownmixChannels</span>(src_data, num_channels, samples_per_channel,</span><br><span class="line">            dst_frame-&gt;num_channels_, downmixed_audio);</span><br><span class="line">        audio_ptr = downmixed_audio;</span><br><span class="line">        audio_ptr_num_channels = dst_frame-&gt;num_channels_;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 重采样</span></span><br><span class="line">    <span class="keyword">if</span> (resampler-&gt;<span class="built_in">InitializeIfNeeded</span>(</span><br><span class="line">        sample_rate_hz, dst_frame-&gt;sample_rate_hz_, audio_ptr_num_channels) == <span class="number">-1</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">RTC_LOG</span>(LS_ERROR) &lt;&lt; <span class="string">&quot;InitializeIfNeeded failed, &quot;</span></span><br><span class="line">            &lt;&lt; <span class="string">&quot;sample_rate_hz: &quot;</span> &lt;&lt; sample_rate_hz</span><br><span class="line">            &lt;&lt; <span class="string">&quot;, dst_frame-&gt;sample_rate_hz: &quot;</span> &lt;&lt; dst_frame-&gt;sample_rate_hz_</span><br><span class="line">            &lt;&lt; <span class="string">&quot;, num_channels: &quot;</span> &lt;&lt; audio_ptr_num_channels;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> src_length = samples_per_channel * audio_ptr_num_channels;</span><br><span class="line">    <span class="type">size_t</span> out_length = resampler-&gt;<span class="built_in">Resample</span>(audio_ptr, src_length,</span><br><span class="line">        dst_frame-&gt;<span class="built_in">mutable_data</span>(), webrtc::AudioFrame::kMaxDataSizeSamples);</span><br><span class="line">    <span class="keyword">if</span> (out_length == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">RTC_LOG</span>(LS_ERROR) &lt;&lt; <span class="string">&quot;Resample failed, audio_ptr: &quot;</span> &lt;&lt; audio_ptr</span><br><span class="line">            &lt;&lt; <span class="string">&quot;, src_length: &quot;</span> &lt;&lt; src_length</span><br><span class="line">            &lt;&lt; <span class="string">&quot;, dst_ptr: &quot;</span> &lt;&lt; dst_frame-&gt;<span class="built_in">mutable_data</span>();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dst_frame-&gt;samples_per_channel_ = out_length / audio_ptr_num_channels;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ProcessAudioFrame</span><span class="params">(webrtc::AudioProcessing* ap, webrtc::AudioFrame* frame)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!ap || !frame) &#123;</span><br><span class="line">        <span class="keyword">return</span> webrtc::AudioProcessing::Error::kNullPointerError;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">webrtc::StreamConfig <span class="title">input_config</span><span class="params">(frame-&gt;sample_rate_hz_, frame-&gt;num_channels_)</span></span>;</span><br><span class="line">    <span class="function">webrtc::StreamConfig <span class="title">output_config</span><span class="params">(frame-&gt;sample_rate_hz_, frame-&gt;num_channels_)</span></span>;</span><br><span class="line">    <span class="comment">// 3A音频处理</span></span><br><span class="line">    <span class="comment">// ap-&gt;ProcessReverseStream(); 输入远端的参考信号，拉流部分</span></span><br><span class="line">    <span class="type">int</span> result = ap-&gt;<span class="built_in">ProcessStream</span>(frame-&gt;<span class="built_in">data</span>(), input_config, output_config,</span><br><span class="line">        frame-&gt;<span class="built_in">mutable_data</span>());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ProcessCaptureFrame</span><span class="params">(<span class="type">uint32_t</span> total_delay_ms, <span class="type">bool</span> key_pressed,</span></span></span><br><span class="line"><span class="params"><span class="function">    webrtc::AudioProcessing* audio_processing,</span></span></span><br><span class="line"><span class="params"><span class="function">    webrtc::AudioFrame* audio_frame)</span>         </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (audio_processing) &#123;</span><br><span class="line">        audio_processing-&gt;<span class="built_in">set_stream_delay_ms</span>(total_delay_ms);</span><br><span class="line">        audio_processing-&gt;<span class="built_in">set_stream_key_pressed</span>(key_pressed);</span><br><span class="line">        <span class="type">int</span> err = <span class="built_in">ProcessAudioFrame</span>(audio_processing, audio_frame);</span><br><span class="line">        <span class="keyword">if</span> (err != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">RTC_LOG</span>(LS_WARNING) &lt;&lt; <span class="string">&quot;ProcessingStream() failed, err: &quot;</span> &lt;&lt; err;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> encoder_clock_rate = <span class="number">48000</span>;</span><br><span class="line"><span class="type">int</span> encoder_channels = <span class="number">2</span>;</span><br><span class="line">webrtc::PushResampler&lt;<span class="type">int16_t</span>&gt; capture_resampler;</span><br><span class="line">rtc::scoped_refptr&lt;webrtc::AudioProcessing&gt; audio_processing;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AudioProcessingFilter</span><span class="params">(std::shared_ptr&lt;MediaFrame&gt; frame)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> audio_frame = std::<span class="built_in">make_unique</span>&lt;webrtc::AudioFrame&gt;();</span><br><span class="line">    <span class="comment">// 最小采样率和声道数处理</span></span><br><span class="line">    <span class="comment">// 我们采集的声道数和采样率，与我们最终的发送声道数和采样率是不同的</span></span><br><span class="line">    <span class="comment">// 音频处理模块，它能够处理的采样率有几个固定的档位</span></span><br><span class="line">    <span class="built_in">InitializeCaptureFrame</span>(frame-&gt;fmt.sub_fmt.audio_fmt.samples_per_sec,</span><br><span class="line">        encoder_clock_rate,</span><br><span class="line">        frame-&gt;fmt.sub_fmt.audio_fmt.channels,</span><br><span class="line">        encoder_channels,</span><br><span class="line">        audio_frame.<span class="built_in">get</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此时，我们可以获得音频处理的最小采样率和声道数</span></span><br><span class="line">    <span class="comment">// 但是，原始采集数据的音频采样率和声道数，可能与这个采样率和声道数不相同</span></span><br><span class="line">    <span class="comment">// 所以，需要进行声道混合和重采样的处理</span></span><br><span class="line">    <span class="built_in">RemixAndResample</span>((<span class="type">int16_t</span>*)frame-&gt;data[<span class="number">0</span>],</span><br><span class="line">        frame-&gt;fmt.sub_fmt.audio_fmt.samples_per_channel,</span><br><span class="line">        frame-&gt;fmt.sub_fmt.audio_fmt.channels,</span><br><span class="line">        frame-&gt;fmt.sub_fmt.audio_fmt.samples_per_sec,</span><br><span class="line">        &amp;capture_resampler,</span><br><span class="line">        audio_frame.<span class="built_in">get</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3A处理</span></span><br><span class="line">    <span class="comment">// 参考信号 A1 和远端回声信号之间存在延迟，这两个样本的时间戳需要对齐，以确保它们之间的一一对应关系。</span></span><br><span class="line">    <span class="comment">// 该延迟时间，在音频采集时会回调出来，需要设置到 APM 模块当中。</span></span><br><span class="line">    <span class="built_in">ProcessCaptureFrame</span>(frame-&gt;fmt.sub_fmt.audio_fmt.total_delay_ms,</span><br><span class="line">        frame-&gt;fmt.sub_fmt.audio_fmt.key_pressed,</span><br><span class="line">        audio_processing.<span class="built_in">get</span>(),</span><br><span class="line">        audio_frame.<span class="built_in">get</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// copy预处理之后的音频数据</span></span><br><span class="line">    <span class="built_in">memcpy</span>(frame-&gt;data[<span class="number">0</span>], audio_frame-&gt;<span class="built_in">data</span>(), audio_frame-&gt;samples_per_channel_</span><br><span class="line">        * audio_frame-&gt;num_channels_ </span><br><span class="line">        * frame-&gt;fmt.sub_fmt.audio_fmt.nbytes_per_sample);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>












      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2024/04/13/%E6%9D%82%E9%A1%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/04/13/%E6%9D%82%E9%A1%B9/" class="post-title-link" itemprop="url">杂项</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-04-13 16:16:37" itemprop="dateCreated datePublished" datetime="2024-04-13T16:16:37+08:00">2024-04-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-04-19 20:15:24" itemprop="dateModified" datetime="2024-04-19T20:15:24+08:00">2024-04-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">其他</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2024/03/08/GCC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/03/08/GCC/" class="post-title-link" itemprop="url">GCC</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-03-08 23:10:16" itemprop="dateCreated datePublished" datetime="2024-03-08T23:10:16+08:00">2024-03-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-04-04 17:37:12" itemprop="dateModified" datetime="2024-04-04T17:37:12+08:00">2024-04-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebRTC/" itemprop="url" rel="index"><span itemprop="name">WebRTC</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="RTP头部扩展"><a href="#RTP头部扩展" class="headerlink" title="RTP头部扩展"></a>RTP头部扩展</h1><p>要实现基于延迟的带宽估计，第一步需要计算包组之间的到达延迟差，而新版本的 GCC 将基于延迟的带宽估计移到了发送端进行实现，但是不像接收端，发送端由于不接收 RTP 数据包，无法直接进行包组间到达延迟差的计算。</p>
<p>为了解决这一问题，RTP 注册 transport-cc 头部扩展，记录 <code>transport_sequence_number</code> ，同一个 <code>PeerConnection</code> 连接下的所有流的 <code>transport_sequence_number</code> ，使用统一的计数器进行计数，方便进行同一个 <code>PeerConnection</code> 下的带宽估计。</p>
<p><strong>RTPExtensionType</strong>：定义 RTP 扩展类型的枚举。</p>
<p><strong>RtpHeaderExtensionMap</strong>：管理 RTP 扩展，内部使用数组管理，数组的索引代表 <code>RTPExtensionType</code> 枚举的值，数组的值代表扩展的 ID。</p>
<ul>
<li><code>RegisterUri()</code>：注册 transport-cc 头部扩展<ul>
<li>id 的大小必须是在 [1, 255] 的范围之内</li>
<li>检查 type 是否已经注册过，如果已经注册过，不用重复注册</li>
<li>检查 type 是否已经被占用，如果占用，返回 false</li>
<li>注册 type</li>
</ul>
</li>
</ul>
<p><strong>TransportSequenceNumber</strong>：头部扩展具体定义，提供写入和解析 <code>transport_sequence_number</code> 的接口。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TransportSequenceNumber</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">using</span> value_type = <span class="type">uint16_t</span>;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> RTPExtensionType kId = kRtpExtensionTransportSequenceNumber;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">size_t</span> kValueSizeBytes = <span class="number">2</span>;</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">const</span> absl::string_view <span class="title">Uri</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> webrtc::RtpExtension::kTransportSequenceNumberUri;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">size_t</span> <span class="title">ValueSize</span><span class="params">(<span class="type">uint16_t</span>)</span> </span>&#123; <span class="keyword">return</span> kValueSizeBytes; &#125;</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">bool</span> <span class="title">Parse</span><span class="params">(rtc::ArrayView&lt;<span class="type">const</span> <span class="type">uint8_t</span>&gt; data, <span class="type">uint16_t</span>* transport_sequence_number)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">bool</span> <span class="title">Write</span><span class="params">(rtc::ArrayView&lt;<span class="type">uint8_t</span>&gt; data, <span class="type">uint16_t</span> transport_sequence_number)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>RtpPacket</strong>：RTP 包的封装结构。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Extension</span> &#123;</span><br><span class="line">    <span class="type">uint8_t</span> id;     <span class="comment">// 扩展的id </span></span><br><span class="line">    <span class="type">size_t</span> length;  <span class="comment">// 扩展的长度</span></span><br><span class="line">    <span class="type">size_t</span> offset;  <span class="comment">// 扩展在RTP头部的偏移量</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="Feedback解析"><a href="#Feedback解析" class="headerlink" title="Feedback解析"></a>Feedback解析</h1><p>当推流端发送RTP 包时，如果在头部添加了 <code>transport_sequence_number</code> 扩展，拉流端收到 RTP 包时会处理这个头部扩展，并向推流端发送 Transport Feedback RTCP 包，该包记录了 RTP 包到达接收端的时间信息，以及 RTP 包的丢失信息。发送方基于这些信息来估计延迟梯度。</p>
<p>在标准的 WebRTC 环境下，需要在 SDP 当中添加 RTP 头部扩展描述信息：</p>
<ul>
<li><code>a=extmap:1 http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01</code></li>
<li>id 信息需要与代码中注册的 id 保持一致，否则无法处理</li>
</ul>
<p><strong>TransportFeedback</strong>：解析 Transport Feedback RTCP 包，获取接收端收到每个 RTP 包的时间。</p>
<h1 id="拥塞控制模块"><a href="#拥塞控制模块" class="headerlink" title="拥塞控制模块"></a>拥塞控制模块</h1><p><strong>RtpTransportControllerSend</strong>：RTP 传输控制，有独立的线程分别处理 Pacer 和 GCC。</p>
<ul>
<li><code>OnNetworkOk()</code>：ICE 连接状态反馈，成功连接会创建  <code>GoogCcNetworkController</code>，并且其调用  <code>OnNetworkOk()</code> 接口。</li>
<li><code>OnAddPacket()</code>：重写接口，调用 <code>TransportFeedbackAdapter</code>  接口 <code>AddPacket()</code> 具体实现。</li>
<li><code>OnTransportFeedback()</code>：重写接口，调用 <code>TransportFeedbackAdapter</code>  接口  <code>ProcessTransportFeedback()</code>  具体实现。</li>
<li><code>OnSentPacket()</code>：调用 <code> TransportFeedbackAdapter</code>  接口  <code>ProcessSentPacket()</code>  具体实现，成功后会调用 <code>GoogCcNetworkController</code>  接口  <code>OnSentPacket()</code>。</li>
<li><code>OnNetworkUpdate()</code>：传递丢包信息和 RTT 信息给基于延迟和基于丢包的带宽估计模块，调用  <code>GoogCcNetworkController</code>  接口 <code>OnRttUpdate()</code> 和 <code>OnTransportLoss()</code> 具体实现。</li>
<li><code>PostUpdate()</code>：应用发送端码率估计值：更新估计的目标码率到 Pacer 和编码器；以及将探测配置作用到 Pacer。</li>
<li><code>StartProcessPeriodicTasks()</code>：定时调用 <code>GoogCcNetworkController</code>  接口 <code>OnProcessInterval()</code>。</li>
</ul>
<p><strong>GoogCcNetworkController</strong>：google 拥塞控制模块。</p>
<ul>
<li><code>OnTransportPacketsFeedback()</code>：接受 Feedback 数据，进行吞吐量估计、Probe 探测码率和估计目标码率等。</li>
<li><code>OnNetWorkOk()</code>：设置带宽估计模块和 Probe 探测上下限以及起始码率。</li>
<li><code>OnRttUpdate()</code>：根据 RR 包解析的信息计算 RTT，提供给基于延迟和基于丢包的带宽估计模块。</li>
<li><code>OnTransportLoss()</code>：根据 RR 包解析的丢包相关信息，提供给基于丢包的带宽估计模块。</li>
<li><code>OnProcessInterval()</code>：周期性更新目标码率到 Pacer 和编码器。</li>
<li><code>OnSentPacket()</code>：调用 ALR 检测更新剩余发送预算。</li>
</ul>
<p><strong>TransportFeedbackObserver</strong>：观察者模式获得 Feedback 数据。</p>
<ul>
<li><code>OnAddPacket()</code>：<code>PeerConnection</code> 中发送数据包之前调用存储数据包。</li>
<li><code>OnTransportFeedback</code>：<code>RtcpReceiver</code> 中收到 Feedback 数据包后回调。</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TransportFeedbackObserver</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">TransportFeedbackObserver</span>() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnAddPacket</span><span class="params">(<span class="type">const</span> RtpPacketSendInfo&amp; send_info)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnTransportFeedback</span><span class="params">(<span class="type">const</span> rtcp::TransportFeedback&amp; feedback)</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>TransportFeedbackAdapter</strong>：处理 <code>TransportFeedback</code> 转换成  <code>webrtc::TransportPacketsFeedback</code></p>
<ul>
<li><p><code>ProcessTransportFeedback()</code>：完成 Feedback 转换成内部的数据结构。</p>
</li>
<li><p><code>ProcessSentPacket()</code>：发送 RTP 数据包时调用，更新存储的发送包中发送时间。</p>
</li>
<li><p><code>AddPacket()</code>：存储时间窗口内的发送数据包。</p>
</li>
</ul>
<p>​	RTP 包发送状态存储结构：<code>TransportFeedbackAdapter</code> 存储 RTP 包信息的结构：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">PacketFeedback</span> &#123;</span><br><span class="line">    webrtc::Timestamp creation_time = webrtc::Timestamp::<span class="built_in">MinusInfinity</span>();</span><br><span class="line">    webrtc::SentPacket sent;</span><br><span class="line">    webrtc::Timestamp receive_time = webrtc::Timestamp::<span class="built_in">PlusInfinity</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>​	RTP 包发送信息的基本结构：<code>PeerConnection</code> 传递 RTP 包的上下文信息：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">RtpPacketSendInfo</span> &#123;</span><br><span class="line">    <span class="type">uint16_t</span> transport_sequence_number = <span class="number">0</span>;</span><br><span class="line">    absl::optional&lt;<span class="type">uint32_t</span>&gt; media_ssrc;</span><br><span class="line">    <span class="type">uint16_t</span> rtp_sequence_number = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint32_t</span> rtp_timestamp = <span class="number">0</span>;</span><br><span class="line">    <span class="type">size_t</span> length = <span class="number">0</span>;</span><br><span class="line">    absl::optional&lt;RtpPacketMediaType&gt; packet_type;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="基于延迟的带宽估计"><a href="#基于延迟的带宽估计" class="headerlink" title="基于延迟的带宽估计"></a>基于延迟的带宽估计</h1><img src="/2024/03/08/GCC/基于延迟的带宽估计核心原理.png" alt="基于延迟的带宽估计核心原理" style="zoom:50%;">

<p><strong>DelayBasedBwe</strong>：基于延迟的带宽估计入口类。</p>
<ul>
<li><code>IncomingPacketFeedbackVector()</code>：输入 Feedback，输出估计的目标码率。<ul>
<li>数据包按照到达时间进行排序</li>
<li>收到的包依次调用 <code>IncomingPacketFeedback()</code>  判断网络状态</li>
<li>最后调用 <code>MaybeUpdateEstimate()</code>  估计目标码率</li>
</ul>
</li>
<li><code>IncomingPacketFeedback()</code>：通过延迟趋势估计，判断网络状态。</li>
<li><code>MaybeUpdateEstimate()</code>：根据网络状态来动态调整发送码率。<ul>
<li>网络过载时的码率调整<ul>
<li>未知吞吐量：每次降低为当前码率的 50%</li>
<li>已知吞吐量：使用码率控制模块调整发送码率</li>
</ul>
</li>
<li>网络没过载时的码率调整<ul>
<li>使用码率控制模块调整发送码率</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="包组延迟差"><a href="#包组延迟差" class="headerlink" title="包组延迟差"></a>包组延迟差</h2><p><strong>InterArrivalDelta</strong>：包组时间差计算类。</p>
<ul>
<li><code>SendTimeGroup current_timestamp_group_</code>：当前到达的包组。</li>
<li><code>SendTimeGroup pre_timestamp_group_</code>：上一个到达的包组。</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SendTimeGroup</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">IsFirstPacket</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> complete_time.<span class="built_in">IsInfinite</span>(); &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 包组中所有包的累计字节数</span></span><br><span class="line">    <span class="type">size_t</span> size;</span><br><span class="line">    <span class="comment">// 包组第一个包的发送时间</span></span><br><span class="line">    webrtc::Timestamp first_send_time;</span><br><span class="line">    <span class="comment">// 包组最后一个包的发送时间</span></span><br><span class="line">    webrtc::Timestamp send_time;</span><br><span class="line">    <span class="comment">// 包组中的包第一个到达对端时间</span></span><br><span class="line">    webrtc::Timestamp first_arrival;</span><br><span class="line">    <span class="comment">// 包组中的包最后到达对端的时间</span></span><br><span class="line">    webrtc::Timestamp complete_time;</span><br><span class="line">    <span class="comment">// 最新的系统时间</span></span><br><span class="line">    webrtc::Timestamp last_system_time;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>ComputeDeltas()</code>：计算包组延迟差。</p>
<ul>
<li>通过前面的内容，可以获得如下数据<ul>
<li>每个包的发送时间</li>
<li>每个包达到对端的时间（换算成发送端的时间，包间隔保持不变）</li>
<li>每个包的大小</li>
<li>Transport Feedback 包到达发送端的时间（利用系统时间纠正时钟发生跳变的情况）</li>
</ul>
</li>
<li>利用这些数据，可以计算如下数据<ul>
<li>两个包之间的发送时间差</li>
<li>两个包之间的到达时间差</li>
<li>两个包之间的数据大小差</li>
</ul>
</li>
<li>计算出这些差值数据之后，可以用计算出这些差值数据之后，可以用于下一步来判断网络是否拥塞。</li>
<li>如果以单个包来计算时间差，会存在比较大的误差，一个重要的原因是：WebRTC 发送数据通常使用 Pacer，它在静态模式下，通常每隔 5ms 会集中发送一批数据，这些突发数据由于是集中发送，接收的延迟基本相同，接收的时间差值非常小。这些差值数据显然不能用于网络拥塞的判断。</li>
<li>为了避免这种误差，我们会对数据包进行分组，比如 5ms 之内的数据分成一组，然后计算包组之间的时间差。</li>
</ul>
</li>
<li><p><code>NewTimestampGroup()</code>：是否创建新的分组。</p>
<ul>
<li>如何进行包分组<ul>
<li>突发的包（集中发送的包）分为一组：<ul>
<li>两个包的发送时间相同</li>
<li>两个包的传播延迟（<code>arrival_time_delta – send_time_delta</code>）相差为负值（很可能前一个包在链路中积压了）&amp;&amp; 包的到达时间差在突发时间阈值（5ms）范围之内 &amp;&amp; 和第一个到达的包时间相差小于 100ms，认为是突发包。通常发生的场景为：当网络拥塞发生缓解时，100ms 内发送的报文，在网络中缓存，然后突然全部到达。</li>
</ul>
</li>
<li>包的发送时间与当前包组中第一个包的发送时间相差在一个包组时间长度之内（比如 5ms）的包，分到一组。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="延迟趋势估计"><a href="#延迟趋势估计" class="headerlink" title="延迟趋势估计"></a>延迟趋势估计</h2><p>通过已经获得的数据，可以计算出两个包组之间的单向传输延迟差。这些延迟差是一系列数据，或者称为样本数据，利用这些样本数据，可以估计出单向网络传输延迟增加趋势。</p>
<p>当单向网络传输延迟存在增加趋势的时候（注意这里是增加趋势，而不是单纯的增加，相当于速度和加速度的关系） ，很可能是发生了网络拥塞，因为网络拥塞时数据包在网络传输队列中排队积压，导致延迟发生了变化。所以，如果我们能够计算出单向网络传输延迟增加的趋势，就能够判断网络是否发生了拥塞，从而进行后续的处理。</p>
<p><strong>TrendlineEstimator</strong>：trendline 单向延迟趋势估计器。</p>
<ul>
<li><p><code>std::deque&lt;PacketTiming&gt; delay_hist_</code>：样本数据存放队列，默认 20 个样本数据。</p>
</li>
<li><p><code>UpdateTrendline()</code>：保存样本数据，并使用 <code>LinearFitSlope()</code>  更新 trend，最后使用 <code>Detect()</code>  进行过载检测。</p>
</li>
<li><p><code>LinearFitSlope()</code>：通过包的延迟差、包到达时间，线性回归最小二乘法计算 trend。</p>
<ul>
<li>trend 值的含义：<ul>
<li>表示延迟趋势，也是线性回归最小二乘法拟合的直线斜率</li>
<li>当发送码率 send_rate 小于网络链路的容量 link_capacity 时，数据包不会在网络队列中排队积压，延迟趋势 trend 值基本为 0（网络存在波动，不可能完全等于 0）</li>
<li>当发送码率 send_rate 大于网络链路的容量 link_capacity 时，数据包会在网络队列中排队积压，数据包的传输延迟逐步增大，此时的延迟趋势 trend 值 &gt; 0，表示网络出现拥塞</li>
<li>当网络拥塞得到缓解时，网络队列会逐渐排空，数据包的传输延迟开始下降，此时的延迟趋势 trend 值 &lt; 0</li>
<li>trend 等价于 estimate <code>((send_rate – link_capacity) / link_capacity)</code></li>
</ul>
</li>
<li>trend 值我们可以利用包组延迟样本数据，通过线性回归最小二乘法计算斜率获得，有了 trend 值我们就能判断网络是否出现过载拥塞，然后调整发送码率 send_rate，使得网络不处于过载或者负载过低的状态，此时的发送码率就接近于网络的容量，即比较准确的网络带宽估计值。</li>
</ul>
</li>
</ul>
<p>线性回归最小二乘法样本数据：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">PacketTiming</span> &#123;</span><br><span class="line">    <span class="comment">// rtp包的到达时间（x轴的值）</span></span><br><span class="line">    <span class="type">double</span> arrival_time_ms;</span><br><span class="line">    <span class="comment">// 指数平滑后的传输延迟差（y轴的值）</span></span><br><span class="line">    <span class="type">double</span> smoothed_delay_ms;</span><br><span class="line">    <span class="comment">// 原始的传输延迟差</span></span><br><span class="line">    <span class="type">double</span> raw_delay_ms;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="过载检测"><a href="#过载检测" class="headerlink" title="过载检测"></a>过载检测</h3><ul>
<li><p><code>Detect()</code>：利用 trend 进行过载检测。</p>
<ul>
<li><p>网络状态</p>
<ul>
<li>正常状态</li>
<li>低负载状态</li>
<li>过载状态</li>
</ul>
</li>
<li><p>基本策略</p>
<ul>
<li>原始的 trend 值比较小，区分度不高，需要进行增益处理为 modified_trend</li>
<li>设定一个阈值 threshold，初始值为 12.5，后续会动态自适应调整</li>
<li>网络状态检测<ul>
<li>当 modified_trend 超过了 threshold，表明网络可能进入了过载状态，但此时还不会立即进入过载状态，防止一些误差带来误判，只有检测过载的次数超过一次，并且持续一段时间，同时延迟趋势还在增加的情况下，才会判断网络状态为过载状态</li>
<li>当 modified_trend &lt; -threshold，此时的延迟趋势非常低了，判定网络为低负载状态</li>
<li>非以上情况，判定网络状态为正常状态</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="过载检测阈值自适应调整"><a href="#过载检测阈值自适应调整" class="headerlink" title="过载检测阈值自适应调整"></a>过载检测阈值自适应调整</h3><ul>
<li><code>UpdateThreshold()</code>：过载检测阈值自适应调整。<ul>
<li>网络正常时，通常 trend 值和阈值是基本相同的，当网络发生拥塞或者拥塞缓解时，trend 值会发生较大的变化，两者才会有明显的差距，随着网络的稳定，两者又趋于相同</li>
<li>初始时，只能设定一个经验值，WebRTC 中设置为 12.5</li>
<li>如果当前 |trend| &lt; 阈值，此时网络通常处于正常状态，trend 值认为更接近真实的阈值，此时应当将当前阈值快速（k_down&#x3D;0.039）向 trend 值逼近减少</li>
<li>如果当前 |trend| &gt; 阈值，通常是网络刚发生拥塞或者刚开始缓解，trend 变化很大，当前的阈值认为更接近真实的阈值，此时可以让当前阈值缓慢（k_up&#x3D;0.0087）向 trend 值增加</li>
</ul>
</li>
</ul>
<h2 id="码率控制"><a href="#码率控制" class="headerlink" title="码率控制"></a>码率控制</h2><p>AIMD（Additive Increase Multiplicative Decrease）码率控制，指的是加性增加，乘性减少。当网络过载时，以乘性的方式减少码率；当网络没有过载时，以加性的方式增加码率。另外，当我们认为可用带宽发生了变化或者未知时，会切换到慢启动模式，此种模式会以倍速的方式增加码率。</p>
<p><strong>AimdRatecontrol</strong>：码率控制器，通过检测的网络状态调整码率。</p>
<ul>
<li><p><code>TimeToReduceFutther()</code>：判断是否进一步降低码率。</p>
<ul>
<li>码率进一步降低的策略：<ul>
<li>码率调整的时间间隔，如果大于 1 个 RTT，继续降低</li>
<li>如果调整的时间间隔小于 1 个 RTT，并且最新估计码率的一半必须大于吞吐量，才能继续降低，避免估计码率值降得过低了</li>
</ul>
</li>
</ul>
</li>
<li><p><code>ChangeState()</code>：状态机状态转换。</p>
<ul>
<li>三种状态<ul>
<li>保持码率不变</li>
<li>增加码率</li>
<li>减少码率</li>
</ul>
</li>
<li>有限状态机的目标是最小化端到端路径上的缓冲区的排队延迟，基本原理：当瓶颈缓冲区开始堆积时，估计的单向延迟趋势 trend 会变为正值，过载检测器检测到这种变化后会触发 overuse（带宽过载使用）信号，然后驱动码率控制状态机变为 decrease（降低码率）状态。因此，发送码率会降低，瓶颈缓冲区的堆积数据逐步排空，直到估计的单向延迟趋势 trend 变为负值。之后过载检测器会触发 underuse（带宽使用不足）信号，然后驱动码率控制状态机变为 hold 状态。状态机会维持 hold 状态直到瓶颈 buffer 完全排空。当出现此种情况时，trend 值会接近为 0，过载检测器会产生一个 normal 信号，该信号驱动码率控制状态机进入 increase（码率增加状态）</li>
<li>上述的状态机可以简述为：<ul>
<li>当 Overuse 发生时，无论什么状态都进入衰减</li>
<li>当 Underuse 发生时，无论什么状态都进入保持状态</li>
<li>在保持和增长阶段，Normal 状态将保持继续增长</li>
<li>在衰减阶段，Normal 状态会将状态拉回保持状态</li>
</ul>
</li>
</ul>
</li>
<li><p><code>ChangeBitrate()</code>：调整码率策略。</p>
<ul>
<li>加性增加码率<ul>
<li>为了避免无限制的码率增加，我们基于吞吐量来限制新的码率</li>
<li>如果当前的吞吐量和链路容量估计值相差太大，会重置链路容量估计值。因此，如果链路容量估计值存在，我们可以认为当前的目标码率已经非常接近链路容量了，此时增加码率应当谨慎一些，采用加性增加策略</li>
<li>加性增加的策略<ul>
<li>当目标码率已经接近链路容量时，如何缓慢的增加一个合理的值，使其不要增加太大而发生排队拥塞？WebRTC 的策略是，一个 RTT 内只允许发送一个包，即增加的码率为一个 RTT 内发送一个包的码率</li>
<li>计算方法<ul>
<li><code>increase_rate_bps_per_second = avg_packet_size / response_time</code></li>
<li>假定 1s 中 30 帧，最大包大小 1200：<code>avg_packet_size = frame_size / packets_per_frame</code></li>
<li>假定过载时的延迟增大为 100ms：<code>response_time = rtt_ + 100ms</code></li>
<li>为了保证不增加的过慢，增加的码率不小于 4kbps</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>慢启动模式增加码率<ul>
<li>如果当前还不知道链路的容量估计值时，即还没有达到链路的容量瓶颈，可以快速的增加码率，以指数的方式增加，快速发现容量</li>
<li>计算公式：<code>multiplicative_increase = std::max(current_bitrate_ * (1.08^∆𝑡− 1), 1000bps),其中0 &lt; ∆𝑡 ≤ 1</code></li>
</ul>
</li>
<li>乘性降低码率<ul>
<li>码率降低为当前吞吐量的 0.85</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="链路容量估计"><a href="#链路容量估计" class="headerlink" title="链路容量估计"></a>链路容量估计</h2><p>利用吞吐量和码率控制状态来初估链路的容量，作为码率调整的重要参考。</p>
<p><strong>LinkCapacityEstimator</strong>：链路容量估计。</p>
<p><code>OnOveruseDetected()</code>：网络过载时输入此时的吞吐量，进行估计链路容量。</p>
<ul>
<li>链路容量估计策略<ul>
<li>取码率控制状态为 kDecrease（下调码率）时的吞吐量为估计样本，因为此时已经出现了过载情况，当前的吞吐量可认为已经达到了链路容量瓶颈</li>
<li>对吞吐量样本按照 95 分位进行指数平滑得到链路容量的估计值</li>
<li>计算链路容量估计值的方差，并且进行归一化</li>
<li>链路容量估计值加减 3 倍的标准差，得到链路容量的上限和下限。按照统计学原理，正负 3 倍的标准差范围，可以覆盖 99.6% 的置信区间</li>
</ul>
</li>
</ul>
<h2 id="吞吐量估计"><a href="#吞吐量估计" class="headerlink" title="吞吐量估计"></a>吞吐量估计</h2><p>Feedback 反馈包里面包含了每个 RTP 包是否被对端收到的信息，我们可以利用这个确认收到的信息，来估计当前发送的吞吐量。</p>
<p>如何来估计呢？这里可能有很多方法。不同方法的准确度是不同的，首先肯定不能用某个时间窗口内的统计数据作为吞吐量，因为它的随机性很大，有比较大的误差。当然我们可以考虑指数平滑或者求平均之类的方法来减少误差，在 WebRTC 中是采用贝叶斯估计的方法来估计吞吐量，可以得到一个相对靠谱的结果。</p>
<p><strong>AcknowledgeBitrateEstimator</strong>：吞吐量估计类。</p>
<p><strong>BitrateEstimator</strong>：具体吞吐量估计实现类。</p>
<p><code>UpdateWindow()</code>：通过 Feedback 包提供的包大小以及在一定窗口时间计算码率；启动开始，使用一个较大的时间窗口，获得一个更加稳定的样本，用于初始化估计值，WebRTC 中 500ms，稳定后，使用小一点的时间窗口，WebRTC 中使用 150ms。</p>
<p><code>Update()</code>：通过贝叶斯估计吞吐量。</p>
<ul>
<li><p>贝叶斯估计中的共轭先验</p>
<ul>
<li>在贝叶斯估计当中，如果先验分布和后验分布服从相同的分布，这种情形，我们称之为共轭先验。如果分布符合正态分布，通过一系列复杂的数学计算，得到一个公式：<code>θ(x) = 𝜎2𝜇/(𝜎2 + 𝜏2) + 𝜏2𝑥/(𝜎2 + 𝜏2)</code></li>
<li><code>θ(x)</code>：表示估计的参数值</li>
<li><code>𝜎2</code>：后验分布方差</li>
<li><code>𝜏2</code>：先验分布的方差</li>
<li><code>𝜇</code>：先验分布的均值</li>
<li><code>𝑥</code>：后验分布的均值</li>
</ul>
</li>
<li><p>利用贝叶斯估计吞吐量</p>
<ul>
<li><p>以一段时间作为计算窗口，统计该窗口内的吞吐量，作为样本数据</p>
</li>
<li><p>在吞吐量的估计中，我们认为先验分布和后验分布都服从正态分布，那么它们就构成了共轭先验，这里面可以形成一个先验链，用现在的后验分布作为下一个计算的先验分布</p>
</li>
<li><p>在 WebRTC 实现中：</p>
<ul>
<li>后验方差使用样本的方差</li>
<li>后验均值为当前的样本值</li>
<li>先验方差起始值设为 50， 后续会根据后验方差进行调整</li>
<li>先验均值为当前的估计值</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="基于丢包的带宽估计"><a href="#基于丢包的带宽估计" class="headerlink" title="基于丢包的带宽估计"></a>基于丢包的带宽估计</h1><p>基本策略</p>
<ul>
<li>丢包率小于 2%，增加码率，增加为当前码率的 1.05 倍</li>
<li>丢包率大于 10%，降低码率，码率降低的倍数为丢包率的 50%</li>
<li>丢包率为[2%, 10%]，码率保持不变</li>
</ul>
<p><strong>SendSideBandwidthEstimator</strong>：基于丢包的带宽估计入口类。</p>
<p><code>UpdatePacketsLost()</code>：根据 RR 包信息统计丢包指数 [0, 255]，每轮统计包的总数需要大于 20 个，最后调用 <code>UpdateEstimate()</code> 估计带宽。</p>
<p><code>UpdateEstimate()</code>：基于丢包的带宽估计。</p>
<ul>
<li><p>在刚开始启动的前 2s，还没有收到任何丢包的报告数据，此时信任 remb 或者基于延迟的估计码率</p>
</li>
<li><p>根据丢包率调整目标码率，具体参考上述基本策略</p>
</li>
</ul>
<p><code>SetBitrates()</code>：设置估计码率的上下限。</p>
<p><code>UpdateTargetBitrate()</code>：通过限制码率的上下限更新当前码率。</p>
<ul>
<li>基于延迟的带宽估计的码率作为基于丢包的带宽估计的码率的上限</li>
<li>可以设置最小和最大的码率作为约束条件</li>
</ul>
<h1 id="ALR检测"><a href="#ALR检测" class="headerlink" title="ALR检测"></a>ALR检测</h1><p>ALR（Application Limit Region），简单翻译成中文的含义是应用限制区域，这是啥意思？在实际的应用场景当中，可能存在一些受限的情况，导致我们的发送码率突然降低，但是这种受限并不是网络原因造成的，而是比如系统负载过高，导致采集&#x2F;编码的帧率降低等等。 如果出现这种情况而没有进行必要的处理，会导致估计出的码率值存在很大的偏差。所以，我们需要能够检测出这种情况的发生，并做出相应的优化处理。</p>
<p>如何检测 ALR？这里会使用 Pacer 里面用到的 <code>IntervalBudget</code> 功能，它的基本原理是设定一个时间窗口（WebRTC 中设置为 500ms）和码率值，两者相乘就是最大的发送字节预算总量。如果发送了数据，就减少预算。随着时间的流逝，会增加预算。当预算的剩余率（预算剩余量&#x2F;最大预算）超过一定的阈值，说明发送码率存在突降，此时应当进入 ALR 状态。当预算的剩余率低于一定的阈值，认为发送码率基本恢复，此时应当解除 ALR 状态。</p>
<p>ALR 在 WebRTC 中的具体优化点：</p>
<ul>
<li>优化吞吐量估计</li>
<li>优化基于延迟的带宽估计</li>
<li>优化 Probe</li>
</ul>
<p>利用 ALR 优化吞吐量估计：</p>
<ul>
<li><p>当处于 ALR 状态时， 利用贝叶斯估计法估计吞吐量时，可以设置一个与正常情况不同的不确定系数，该优化在 WebRTC 中默认没有开启</p>
</li>
<li><p>当从 ALR 状态恢复时，此时我们可以让吞吐量的估计值以更快的速度收敛到正常值</p>
</li>
</ul>
<p>利用 ALR 优化基于延迟的码率估计</p>
<ul>
<li>在进行 AIMD 码率调整时，如果当前处于 ALR 状态，此时不增加基于延迟的码率估计值，因为码率太低无法获得必要的 transport feedback 数据，从而无法保证新的估计的正确性。WebRTC 中默认没有开启这个功能，如果需要开启需要配置参数：WebRTC–DontIncreaseDelayBasedBweInAlr</li>
<li>当出现网络过载时，需要降低当前的目标码率，如果此时处于 ALR 状态，需要进行退避处理。退避策略为：此时因为吞吐量的估计值比较低而且不准确，不宜在当前吞吐量的基础上进行下降，而是在上一个目标的码率值的基础上进行下降。WebRTC 默认没有开启这个功能，如果需要开启需要配置参数：WebRTC-Bwe-AlrLimitedBackoff</li>
</ul>
<p><strong>AlrDetector</strong>：ALR 检测入口类。</p>
<p><code>IntervalBudget alr_budget_</code>：设定码率和时间窗口，两者相乘可以得到最大预算发送量。</p>
<p><code>OnBytesSent()</code>：通过当前发送数据量和时间间隔来更新预算，并且计算预算剩余量来判断是否进入 ALR 状态。</p>
<p><code>SetEstimateBitrate()</code>：设置预算量。</p>
<h1 id="Probe技术"><a href="#Probe技术" class="headerlink" title="Probe技术"></a>Probe技术</h1><p>GCC 是以 AIMD 的方式来调节码率的，但是 AIMD 增加码率的速度是非常慢的，这样在会话起始阶段、网络从中断中恢复时或者其它的场景，要达到目标带宽值就非常慢，此时会影响用户体验。为了解决这个问题，GCC 提供了 Probe 机制，可以在较短的时间探测到链路的可用带宽。</p>
<p>Probe 的基本思想：在较短的时间内，以目标码率发送数据，如果被对方确认收到的码率达到发送码率的一定比例，即认为探测成功，此时计算出的带宽就认为是链路的可用带宽。Probe 虽然能够在较短的时间探测到可用带宽，并且对网络的影响较小，但是其缺点也很明显，因为发送时间较短，很容易受到各种干扰而失败，而且在网络抖动时，结果可能不准。</p>
<p>GCC Probe 探测三大部分</p>
<ul>
<li>ProbeController，用于控制是否进行探测，探测的次数以及探测的码率是多少，最终会输出探测任务配置</li>
<li>Pacing 模块，负责执行探测报文的发送，如果码率不够，会用 padding 包进行补充</li>
<li>ProbeBitrateEstimator，负责计算最终的探测结果</li>
</ul>
<p><strong>ProbeController</strong>：获取探测任务配置类。</p>
<p>探测状态</p>
<ul>
<li><code>kInit</code>：初始状态，探测没有触发；此时启动指数探测</li>
<li><code>kWaitingForProbingResult</code>：等待探测结果，才能继续进一步探测</li>
<li><code>kProbingComplete</code>：探测完成</li>
</ul>
<p><code>SetBitrate()</code>：设置起始和最大探测码率，根据探测状态执行相应逻辑，最终会输出探测任务配置。</p>
<p><code>SetEstimateBitrate()</code>：设置码率估计值，每次估计码率后会调用，当状态为  <code>kWaitingForProbingResult</code> 会输出探测配置。</p>
<p><code>RequestProbe()</code>：获取主动请求探测配置，当前处于 ALR 状态或者刚刚结束 ALR 状态不久，此时应考虑触发主动探测，但仍需满足一定的条件。</p>
<p><code>InitExpProbing()</code>：指数探测，在会话刚开始的时候，为了能够尽快的获得目标带宽，此时会触发带宽探测。我们会采用指数级探测，探测主要分为两次，第一次为起始码率的 3 倍，第二次为起始码率的 6 倍。</p>
<p><code>InitProbing()</code>：本质上是构造一组探测任务的配置，包括探测的码率、探测的持续时间、探测包发送的个数，探测的 id 等，这组任务配置最终会发给 Pacer 去执行。如果需要继续探测，下一次探测的最小码率应该不低于最后一次探测码率的 0.7 倍，太小就没有意义。</p>
<p><strong>BitrateProber</strong>：保存探测信息。</p>
<p>探测状态</p>
<ul>
<li><code>kDisabled</code>：此状态下，不会触发探测</li>
<li><code>kInactive</code>：准备触发探测的状态</li>
<li><code>kActive</code>：正在探测的状态</li>
<li><code>kSuspended</code>：探测被挂起，需要被再次启动</li>
</ul>
<p><code>CreateProbeCluster()</code>：获得的探测任务配置信息，存储到 <code>ProbeCluster</code> 信息到队列。</p>
<ul>
<li>探测任务结构：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ProbeCluster</span> &#123;</span><br><span class="line">    webrtc::PacedPacketInfo pace_info;</span><br><span class="line">    <span class="type">int</span> sent_probes = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> sent_bytes = <span class="number">0</span>;</span><br><span class="line">    webrtc::Timestamp created_at = webrtc::Timestamp::<span class="built_in">MinusInfinity</span>();</span><br><span class="line">    webrtc::Timestamp started_at = webrtc::Timestamp::<span class="built_in">MinusInfinity</span>();</span><br><span class="line">    <span class="type">int</span> retries = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>OnIncomingPacket()</code>：当有新的 <code>ProbeCluster</code> 创建之后，此时探测状态进入准备探测状态，在此状态下，如果 Pacer 有新数据需要发送，则会尝试启动探测，如果将要发送的数据包大小大于 200 字节或者大于推荐的最小探测大小，则启动探测，否则暂时不启动。</p>
<p><code>RecommendedMinProbeSize()</code>：推荐的最小探测数据大小 &#x3D; 2 * 探测码率 * 探测间隔。</p>
<p><code>ProbeSent()</code>：更新 <code>ProbeCluster</code> 结构信息。</p>
<ul>
<li>探测包发送后，需要更新  <code>ProbeCluster</code> 结构信息，包括发送的时间、发送包的总字节数，发送包的个数</li>
<li>计算下一轮探测的时间：下一轮探测的发送时间 &#x3D; 上一轮探测的发送时间 + 上一轮探测的持续时间</li>
<li>如果发送字节和个数达到 <code>ProbeCluster</code> 配置要求，需要删除当前 <code>ProbeCluster</code></li>
<li>当 <code>ProbeCluster</code> 队列为空时，探测状态置为 <code>kSuspended</code></li>
</ul>
<p><code>NextProbeTime()</code>：下一次探测的时间。</p>
<p><strong>PacingController</strong>：平滑发送控制类。</p>
<p><code>ProcessPackets()</code>：从队列中获取数据包处理并更新预算。</p>
<ul>
<li>如果需要探测，从 <code>BitrateProber</code> 中获取当前的  <code>webrtc::PacedPacketInfo</code></li>
<li>如果第一次发送探测包，先发送一个一字节的填充包，可以获得一个可靠的估计码率的起始窗口</li>
<li>当队列为空，但是发送的数据大小小于推荐的最小探测数据大小时，需要继续填充包进行发送</li>
<li>本轮数据处理完成后，更新探测的相关状态信息</li>
</ul>
<p><code>GetPendingPacket()</code>：从队列中获取数据，直到预算耗尽，如果当前处于探测状态，此时发送探测需要的数据大小，不进行预算判断。</p>
<p><code>PaddingToAdd()</code>：获取需要填充包的大小，但是当没有发送任何正常数据包之前，不能发送填充包。</p>
<p><strong>ProbeBitrateEstimator</strong>：Probe 码率估计器。</p>
<p><code>HandleProbeAdEstimateBitrate()</code>：通过 Feedback 响应包估计码率。</p>
<ul>
<li>定义一个结构来聚合探测信息，方便进行统计</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AggregatedCluster</span> &#123;</span></span><br><span class="line">    <span class="comment">// 探测次数</span></span><br><span class="line">    <span class="type">int</span> num_probes = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 第一次发送探测数据的时间</span></span><br><span class="line">    webrtc::Timestamp first_send = webrtc::Timestamp::PlusInfinity();</span><br><span class="line">    <span class="comment">// 最后一次发送探测数据的时间</span></span><br><span class="line">    webrtc::Timestamp last_send = webrtc::Timestamp::MinusInfinity();</span><br><span class="line">    <span class="comment">// 第一次收到探测数据的时间</span></span><br><span class="line">    webrtc::Timestamp first_receive = webrtc::Timestamp::PlusInfinity();</span><br><span class="line">    <span class="comment">// 最后一次收到探测数据的时间</span></span><br><span class="line">    webrtc::Timestamp last_receive = webrtc::Timestamp::MinusInfinity();</span><br><span class="line">    <span class="comment">// 最后一次发送包的大小</span></span><br><span class="line">    webrtc::DataSize size_last_send = webrtc::DataSize::Zero();</span><br><span class="line">    <span class="comment">// 第一次收到包的大小</span></span><br><span class="line">    webrtc::DataSize size_first_receive = webrtc::DataSize::Zero();</span><br><span class="line">    <span class="comment">// 累计探测反馈的包大小</span></span><br><span class="line">    webrtc::DataSize size_total = webrtc::DataSize::Zero();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>为了能够获得有效的估计码率值，收到反馈的探测包个数不低于要求的最小反馈探测包个数的 80%，并且收到的反馈数据量不低于要求收到的最低数据量的 80%</p>
</li>
<li><p>通过计算发送间隔和时间段累计发送的数据量、接受间隔和时间段累计接受的数据量估算码率值</p>
</li>
<li><p>计算估计码率值的时候，需要注意，对于发送者来说，发送间隔不包含最后一个数据包的发送时间，所以计算发送码率时需要减去最后一个发送数据包大小；对于接收者来说，接收间隔不包含第一个数据包的接收时间，所以计算接收码率的时候需要减去第一个接收数据包大小</p>
</li>
<li><p>如果接收的码率明显低于发送码率（kMinRatioForUnsaturatedLink &#x3D; 0.9） ，这表明我们已经找到了链路的真实容量。在这种情况下，将目标码率设置的稍低（kTargetUtilizationFraction &#x3D; 0.95） ，以避免立即出现网络过载</p>
</li>
</ul>
<p><code>FetchAndResetLastEstimateBitrate()</code>：获取探测码率并重置。</p>
<ul>
<li>探测的结果作用到基于延迟的码率估计中，当网络没有发生过载时直接作为估计码率</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2024/03/05/Pacer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/03/05/Pacer/" class="post-title-link" itemprop="url">Pacer</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-03-05 22:19:38 / Modified: 22:38:37" itemprop="dateCreated datePublished" datetime="2024-03-05T22:19:38+08:00">2024-03-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebRTC/" itemprop="url" rel="index"><span itemprop="name">WebRTC</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="平滑发送概述"><a href="#平滑发送概述" class="headerlink" title="平滑发送概述"></a>平滑发送概述</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>Pacer（又称 Pacing Controller）是一个用于调整媒体数据发送速率的组件。它的主要作用是根据网络条件和接收端的反馈信息，动态地控制媒体数据的发送速率，以便在网络拥塞或带宽变化时提供平滑的数据传输，并尽量避免数据包的丢失和延迟。Pacer 还有一个作用，比如在需要最小发送速率的情况下，可以发送填充数据包。</p>
<h2 id="核心流程"><a href="#核心流程" class="headerlink" title="核心流程"></a>核心流程</h2><img src="/2024/03/05/Pacer/ Pacer的核心流程.png" alt=" Pacer的核心流程" style="zoom:50%;">

<h1 id="RTP包的优先级"><a href="#RTP包的优先级" class="headerlink" title="RTP包的优先级"></a>RTP包的优先级</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum class</span> <span class="title class_">RtpPacketMediaType</span> : <span class="type">size_t</span> &#123;</span><br><span class="line">    kAudio,</span><br><span class="line">    kVideo,</span><br><span class="line">    kRetransmission,</span><br><span class="line">    kForwardErrorCorrection,</span><br><span class="line">    kPadding</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>RTP 包的优先级</p>
<ul>
<li>音频包 &gt; 重传包 &gt; 视频包 &#x3D; FEC包 &gt; Padding</li>
<li>人对声音更敏感，优先发送音频</li>
<li>为了尽可能的恢复丢包，降低卡顿，重传包优先级提高</li>
<li>Padding 包本身是没什么用的，只是为了保持较高的带宽估值，所以优先级可以很低</li>
</ul>
<h1 id="优先级队列"><a href="#优先级队列" class="headerlink" title="优先级队列"></a>优先级队列</h1><h2 id="RoundRobinPacketQueue"><a href="#RoundRobinPacketQueue" class="headerlink" title="RoundRobinPacketQueue"></a>RoundRobinPacketQueue</h2><ul>
<li><p><code>std::unordered_map&lt;uint32_t, Stream&gt; streams_</code>：轮询队列包含多个流，使用 map 存储，其中每个流以 SSRC 为唯一标识。</p>
</li>
<li><p><code>std::multimap&lt;StreamPrioKey, uint32_t&gt; stream_priorities_</code>：通过 <code>StreamPrioKey</code> 标识各个 SSRC 的优先级。</p>
</li>
<li><p><code>webrtc::DataSize size_</code>：所有流队列包的总字节数。</p>
</li>
<li><p><code>size_t size_packets_</code>：所有流队列包的总个数。</p>
</li>
<li><p><code>webrtc::TimeDelta queue_time_sum_</code>：所有流队列包排队总时间。</p>
</li>
<li><p><code>void push(const QueuedPacket&amp;)</code>：入队列接口。</p>
<ol>
<li>通过 SSRC 查找对应的流</li>
<li>调整流的优先级</li>
<li>更新队列数据包等待时间</li>
<li>增加数据包的个数和总字节数</li>
<li>插入对应流的优先级队列</li>
</ol>
</li>
<li><p><code>std::unique_ptr&lt;RtpPacketToSend&gt; pop()</code>：出队列接口。</p>
<ol>
<li>获取优先级最高的流</li>
<li>数据包出队列</li>
<li>重新计算流的优先级</li>
<li>更新队列数据包等待时间</li>
<li>减少数据包的个数和总字节数</li>
</ol>
</li>
<li><p><code>void UpdateQueueTime(webrtc::Timestamp now)</code>：更新所有流队列包排队总时间。可以用于 Pacer 的延迟优化。</p>
</li>
</ul>
<p>Pacer 的策略是先将数据包缓存到队列，然后定时按量发送，当估计的带宽较小时，每次发送的数据量不多，但是需要发送的数据量又比较大，此时可能会导致数据包在队列中积压，从而引起延迟。</p>
<p>解决办法：</p>
<ul>
<li>设定一个期望的延迟时间 <code>queue_time_limit</code>，同时计算队列中数据包的平均排队时间 <code>average_queue_time</code>。 如果此时队列中排队的数据包字节数为 <code>queue_size_data</code>，为了能够在期望的延迟时间内发送完这些数据，需要的最低码率为：<code>min_rate_need =  queue_size_data / (queue_time_limit – average_queue_time)</code> </li>
<li>如果 <code>min_rate_need &gt; target_rate</code>，则需要调整 <code>target_rate = min_rate_need</code>，否则延迟会超过 <code>queue_time_limit</code></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">UpdateQueueTime</span><span class="params">(webrtc::Timestamp now)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (now = last_time_update_)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    webrtc::TimeDelta delta = now - last_time_update_;</span><br><span class="line">    queue_time_sum_ += webrtc::TimeDelta::<span class="built_in">Micros</span>(delta.<span class="built_in">us</span>() * size_packets_);</span><br><span class="line">    last_time_update_ = now;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h2><p>每个流分别维护一个优先级队列，其中每个流以 SSRC 为唯一标识。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Stream</span> &#123;</span><br><span class="line">    <span class="built_in">Stream</span>();</span><br><span class="line">    ~<span class="built_in">Stream</span>();</span><br><span class="line">    webrtc::DataSize size;  <span class="comment">// 队列数据大小</span></span><br><span class="line">    <span class="type">uint32_t</span> ssrc;  <span class="comment">// 唯一标识</span></span><br><span class="line">    std::priority_queue&lt;QueuedPacket&gt; packet_queue;  <span class="comment">// 优先级队列</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="StreamPrioKey"><a href="#StreamPrioKey" class="headerlink" title="StreamPrioKey"></a>StreamPrioKey</h2><p>流同样有优先级，其判定规则如下：</p>
<ul>
<li><p>以优先级队列中的 RTP 包的最高优先级作为流的优先级，优先级高的流将被优先发送。</p>
</li>
<li><p>如果每个流的优先级队列中的 RTP 包的最高优先级相同，则发送数据总量小的流优先级高，这样可以保证相同优先级的流能够交替发送，避免一个流被另外的流阻塞了。</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">StreamPrioKey</span> &#123;</span><br><span class="line">    <span class="built_in">StreamPrioKey</span>(<span class="type">int</span> priority, webrtc::DataSize size) :</span><br><span class="line">        <span class="built_in">priority</span>(priority)</span><br><span class="line">      , <span class="built_in">size</span>(size) &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> StreamPrioKey&amp; other) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (priority != other.priority) &#123;</span><br><span class="line">            <span class="keyword">return</span> priority &lt; other.priority;</span><br><span class="line">        &#125;       </span><br><span class="line">        <span class="keyword">return</span> size &lt; other.size;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> priority;  <span class="comment">// Stream中RTP数据包最大优先级</span></span><br><span class="line">    webrtc::DataSize size;  <span class="comment">// Stream累积发送字节数</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="QueuedPacket"><a href="#QueuedPacket" class="headerlink" title="QueuedPacket"></a>QueuedPacket</h2><p>优先级队列中的数据结构，以优先级排序，优先级如果相等，先到的包优先级高。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">QueuedPacket</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">QueuedPacket</span>(<span class="type">int</span> priority,</span><br><span class="line">                 webrtc::Timestamp enqueue_time,</span><br><span class="line">                 <span class="type">uint64_t</span> enqueue_order,</span><br><span class="line">                 std::unique_ptr&lt;RtpPacketToSend&gt; packet);</span><br><span class="line">    ~<span class="built_in">QueuedPacket</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> QueuedPacket&amp; other) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (priority_ != other.priority_) &#123;</span><br><span class="line">            <span class="keyword">return</span> priority_ &gt; other.priority_; <span class="comment">// 值越大，优先级越小</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 优先级如果相等，先到的包优先级高</span></span><br><span class="line">        <span class="keyword">return</span> enqueue_order_ &gt; other.enqueue_order_;</span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> priority_;</span><br><span class="line">    webrtc::Timestamp enqueue_time_; <span class="comment">// 入队列时间</span></span><br><span class="line">    <span class="type">uint64_t</span> enqueue_order_; <span class="comment">// 入队列的顺序</span></span><br><span class="line">    RtpPacketToSend* owned_packet_; <span class="comment">// 原始数据包</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="发送预算"><a href="#发送预算" class="headerlink" title="发送预算"></a>发送预算</h1><p>当 <code>ProcessPackets()</code> 被周期性调度之后，该方法会计算当前时间和上一次处理时间的时间差，即为 <code>elapsed_time</code>，然 后将这个时间传入预算处理对象 <code>media_budget</code>，<code>media_budget</code> 会根据这个流逝的时间，以及当前发送的目标码率 <code>target_bitrate</code>，计算出当前时间片可以发送的数据量，然后从优先级队列中获取数据包进行发送，每发送一个数据包，会消耗数据包大小的预算值，当预算值小于等于 0 之 后，停止发送，等待下一次调度。</p>
<p>预算计算逻辑：</p>
<ul>
<li>增加预算，随着时间的流逝，预算不断增加<ul>
<li><code>max_send_bytes = elapsed_time * target_bitrate / 8</code> </li>
<li><code>elapsed_time</code>：距离上次发送流逝的时间，单位 ms</li>
<li><code>target_bitrate</code>：目标发送码率，通常是由带宽估计模块动态设定的，单位 kbps</li>
</ul>
</li>
<li>消耗预算<ul>
<li>每发送一个数据包，预算减去数据包的大小，预算消耗完毕，停止发送</li>
</ul>
</li>
</ul>
<h1 id="发送数据包"><a href="#发送数据包" class="headerlink" title="发送数据包"></a>发送数据包</h1><p>静态调度周期，每隔 5ms 调度一次 <code>ProcessPackets()</code>。</p>
<ol>
<li>设置发送码率，通过队列中包的总字节数以及剩余字节发送时间计算最小发送码率。</li>
<li>更新预算，通过距离上一次发送过去的时间以及发送码率，计算本次发送的预算字节数。</li>
<li>循环发送数据包，从优先级队列获取数据包，发送数据包，更新预算，直到预算不足。</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2024/01/25/Go-IO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/25/Go-IO/" class="post-title-link" itemprop="url">Go-IO</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-01-25 14:50:19 / Modified: 14:53:07" itemprop="dateCreated datePublished" datetime="2024-01-25T14:50:19+08:00">2024-01-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="IO接口"><a href="#IO接口" class="headerlink" title="IO接口"></a>IO接口</h1><p>Reader 接口：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Reader <span class="keyword">interface</span> &#123;</span><br><span class="line">    Read(p []<span class="type">byte</span>) (n <span class="type">int</span>, err <span class="type">error</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Writer 接口：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Writer <span class="keyword">interface</span> &#123;</span><br><span class="line">    Write(p []<span class="type">byte</span>) (n <span class="type">int</span>, err <span class="type">error</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现了 io.Reader 或 io.Writer 接口的类型：</p>
<ul>
<li>os.File 同时实现了 io.Reader 和 io.Writer</li>
<li>strings.Reader 实现了 io.Reader</li>
<li>bufio.Reader&#x2F;Writer 分别实现了 io.Reader 和 io.Writer</li>
<li>bytes.Buffer 同时实现了 io.Reader 和 io.Writer</li>
<li>bytes.Reader 实现了 io.Reader</li>
<li>compress&#x2F;gzip.Reader&#x2F;Writer 分别实现了 io.Reader 和 io.Writer</li>
<li>crypto&#x2F;cipher.StreamReader&#x2F;StreamWriter 分别实现了 io.Reader 和 io.Writer</li>
<li>crypto&#x2F;tls.Conn 同时实现了 io.Reader 和 io.Writer</li>
<li>encoding&#x2F;csv.Reader&#x2F;Writer 分别实现了 io.Reader 和 io.Writer</li>
<li>mime&#x2F;multipart.Part 实现了 io.Reader</li>
<li>net&#x2F;conn 分别实现了 io.Reader 和 io.Writer(Conn接口定义了Read&#x2F;Write)</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2024/01/20/Go-%E8%A7%A3%E6%9E%90JSON/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/20/Go-%E8%A7%A3%E6%9E%90JSON/" class="post-title-link" itemprop="url">Go-解析JSON</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-20 09:48:43" itemprop="dateCreated datePublished" datetime="2024-01-20T09:48:43+08:00">2024-01-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-21 21:32:27" itemprop="dateModified" datetime="2024-01-21T21:32:27+08:00">2024-01-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="编码JSON"><a href="#编码JSON" class="headerlink" title="编码JSON"></a>编码JSON</h1><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 编码 json</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Marshal</span><span class="params">(v <span class="keyword">interface</span>&#123;&#125;)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>)</span><br><span class="line"><span class="comment">// 格式化编码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">MarshalIndent</span><span class="params">(v <span class="keyword">interface</span>&#123;&#125;, prefix, indent <span class="type">string</span>)</span></span> ([]<span class="type">byte</span>, <span class="type">error</span>)</span><br></pre></td></tr></table></figure>

<h2 id="基本序列化"><a href="#基本序列化" class="headerlink" title="基本序列化"></a>基本序列化</h2><p>通过结构体生成 JSON，示例代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> user <span class="keyword">struct</span> &#123;</span><br><span class="line">    Id       <span class="type">int</span></span><br><span class="line">    Name     <span class="type">string</span></span><br><span class="line">    Subjects []<span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewUser</span><span class="params">(id <span class="type">int</span>, name <span class="type">string</span>, subjects []<span class="type">string</span>)</span></span> *user &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;user&#123;</span><br><span class="line">        Id:       id,</span><br><span class="line">        Name:     name,	</span><br><span class="line">        Subjects: subjects,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	u := NewUser(<span class="number">1</span>, <span class="string">&quot;小明&quot;</span>, []<span class="type">string</span>&#123;<span class="string">&quot;c++&quot;</span>, <span class="string">&quot;golang&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> jsUser, err := json.Marshal(u); err == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="type">string</span>(jsUser))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过 map 生成 JSON，示例代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 创建一个保存键值对的映射</span></span><br><span class="line">    user := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">    user[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;小明&quot;</span></span><br><span class="line">    user[<span class="string">&quot;age&quot;</span>] = <span class="number">18</span></span><br><span class="line">    user[<span class="string">&quot;subjects &quot;</span>] = []<span class="type">string</span>&#123;<span class="string">&quot;Go&quot;</span>, <span class="string">&quot;C++&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> jsUser, err := json.Marshal(user); err == <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(<span class="type">string</span>(jsUser))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：结构体中各个字段名的<strong>首字母必须大写</strong>，只有导出的字段首字母是大写才能被外部包访问。</p>
<h2 id="使用tag指定字段名"><a href="#使用tag指定字段名" class="headerlink" title="使用tag指定字段名"></a>使用tag指定字段名</h2><p>默认情况下使用结构体的字段名，可以通过给结构体字段添加 <code>tag</code> 来指定序列化生成的字段名。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> user <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// Id 不会导出到 JSON 中</span></span><br><span class="line">	Id <span class="type">int</span> <span class="string">`json:&quot;-&quot;`</span></span><br><span class="line">	<span class="comment">// Name 的键改成 uname</span></span><br><span class="line">	Name <span class="type">string</span> <span class="string">`json:&quot;uname&quot;`</span></span><br><span class="line">	<span class="comment">// 如果 Subjects 为空，不输出到 JSON 中</span></span><br><span class="line">	Subjects []<span class="type">string</span> <span class="string">`json:&quot;subjects,omitempty&quot;`</span></span><br><span class="line">	<span class="comment">// 转换为字符串类型输出</span></span><br><span class="line">	Age <span class="type">int</span> <span class="string">`json:&quot;age,string&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	u := user&#123;</span><br><span class="line">		Id:   <span class="number">1</span>,</span><br><span class="line">		Name: <span class="string">&quot;小明&quot;</span>,</span><br><span class="line">		Age:  <span class="number">18</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> jsUser, err := json.MarshalIndent(u, <span class="string">&quot;&quot;</span>, <span class="string">&quot;  &quot;</span>); err == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="type">string</span>(jsUser))</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        // 输出结果</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">         &quot;uname&quot;: &quot;小明&quot;,</span></span><br><span class="line"><span class="comment">         &quot;age&quot;: &quot;18&quot;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>字段的 <code>tag</code> 是 <code>-</code>，那么这个字段不会输出到 JSON。</li>
<li><code>tag</code> 中带有自定义名称，那么这个自定义名称会出现在 JSON 的字段名中。</li>
<li><code>tag</code> 中如果带有 <code>,omitempty</code> 选项，那么如果该字段值为空，就不会输出到 JSON 串中。</li>
<li>如果字段类型是 bool、int、int64 等，而 <code>tag</code> 中带有 <code>,string</code> 选项，那么这个字段在输出到 JSON 的时候会把该字段的值转换成字符串。</li>
</ol>
<p>参考链接：<a target="_blank" rel="noopener" href="https://www.liwenzhou.com/posts/Go/json-tricks/#c-0-0-1">https://www.liwenzhou.com/posts/Go/json-tricks/#c-0-0-1</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2024/01/10/JavaScript%E8%BF%9B%E9%98%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/10/JavaScript%E8%BF%9B%E9%98%B6/" class="post-title-link" itemprop="url">JavaScript进阶</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-10 19:41:38" itemprop="dateCreated datePublished" datetime="2024-01-10T19:41:38+08:00">2024-01-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-16 18:51:30" itemprop="dateModified" datetime="2024-01-16T18:51:30+08:00">2024-01-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h1><p>作用域（scope）规定了变量能够被访问的“范围”，离开了这个“范围”变量便不能被访问，作用域分为全局作用域和局部作用域。</p>
<h2 id="局部作用域"><a href="#局部作用域" class="headerlink" title="局部作用域"></a>局部作用域</h2><p>局部作用域分为函数作用域和块作用域。</p>
<h3 id="函数作用域"><a href="#函数作用域" class="headerlink" title="函数作用域"></a>函数作用域</h3><p>在函数内部声明的变量只能在函数内部被访问，外部无法直接访问。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 声明 counter 函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">x, y</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 函数内部声明的变量</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> s = x + y</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(s) <span class="comment">// 18</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 设用 counter 函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">counter</span>(<span class="number">10</span>, <span class="number">8</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 访问变量 s</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(s)<span class="comment">// 报错</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>函数内部声明的变量，在函数外部无法被访问</li>
<li>函数的参数也是函数内部的局部变量</li>
<li>不同函数内部声明的变量无法互相访问</li>
<li>函数执行完毕后，函数内部的变量实际被清空了</li>
</ol>
<h3 id="块作用域"><a href="#块作用域" class="headerlink" title="块作用域"></a>块作用域</h3><p>在 JavaScript 中使用 <code>&#123;&#125;</code> 包裹的代码称为代码块，代码块内部声明的变量外部将【有可能】无法被访问。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// age 只能在该代码块中被访问</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> age = <span class="number">18</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">// 正常</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 超出了 age 的作用域</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(age) <span class="comment">// 报错</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> flag = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span>(flag) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// str 只能在该代码块中被访问</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> str = <span class="string">&#x27;hello world!&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(str); <span class="comment">// 正常</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 超出了 age 的作用域</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(str); <span class="comment">// 报错</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span>(<span class="keyword">let</span> t = <span class="number">1</span>; t &lt;= <span class="number">6</span>; t++) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// t 只能在该代码块中被访问</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(t); <span class="comment">// 正常</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 超出了 t 的作用域</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(t); <span class="comment">// 报错</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>JavaScript 中除了变量外还有常量，常量与变量本质的区别是【常量必须要有值且不允许被重新赋值】，常量值为对象时其属性和方法允许重新赋值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 必须要有值</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> version = <span class="string">&#x27;1.0.0&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 不能重新赋值</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// version = &#x27;1.0.1&#x27;;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 常量值为对象类型</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> user = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 不能重新赋值</span></span></span><br><span class="line"><span class="language-javascript">  user = &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 属性和方法允许被修改</span></span></span><br><span class="line"><span class="language-javascript">  user.<span class="property">name</span> = <span class="string">&#x27;小小明&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  user.<span class="property">gender</span> = <span class="string">&#x27;男&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li><code>let</code> 声明的变量会产生块作用域，<code>var</code> 不会产生块作用域</li>
<li><code>const</code> 声明的常量也会产生块作用域</li>
<li>不同代码块之间的变量无法互相访问</li>
<li>推荐使用 <code>let</code> 或 <code>const</code></li>
</ol>
<p>注：开发中 <code>let</code> 和 <code>const</code> 经常不加区分的使用，如果担心某个值会不小被修改时，则只能使用 <code>const</code> 声明成常量。</p>
<h2 id="全局作用域"><a href="#全局作用域" class="headerlink" title="全局作用域"></a>全局作用域</h2><p><code>&lt;script&gt;</code> 标签和 <code>.js</code> 文件的【最外层】就是所谓的全局作用域，在此声明的变量在函数内部也可以被访问。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 此处是全局</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 此处为局部</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 此处为全局</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>全局作用域中声明的变量，任何其它作用域都可以被访问，如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 全局变量 name</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> name = <span class="string">&#x27;小明&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  	<span class="comment">// 函数作用域中访问全局</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 此处为局部</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;你好&#x27;</span> + name)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 全局变量 flag 和 x</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> flag = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> x = <span class="number">10</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  	<span class="comment">// 块作用域中访问全局</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span>(flag) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> y = <span class="number">5</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y) <span class="comment">// x 是全局的</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>为 <code>window</code> 对象动态添加的属性默认也是全局的，不推荐！</li>
<li>函数中未使用任何关键字声明的变量为全局变量，不推荐！！！</li>
<li>尽可能少的声明全局变量，防止全局变量被污染</li>
</ol>
<p>JavaScript 中的作用域是程序被执行时的底层机制，了解这一机制有助于规范代码书写习惯，避免因作用域导致的语法错误。</p>
<h2 id="作用域链"><a href="#作用域链" class="headerlink" title="作用域链"></a>作用域链</h2><p>在解释什么是作用域链前先来看一段代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 全局作用域</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> a = <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> b = <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 局部作用域</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> c</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 局部作用域</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">g</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> d = <span class="string">&#x27;yo&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>函数内部允许创建新的函数，<code>f</code> 函数内部创建的新函数 <code>g</code>，会产生新的函数作用域，由此可知作用域产生了嵌套的关系。</p>
<p>如下图所示，父子关系的作用域关联在一起形成了链状的结构，作用域链的名字也由此而来。</p>
<p>作用域链本质上是底层的变量查找机制，在函数被执行时，会<strong>优先查找当前函数作用域中查找变量</strong>，如果<strong>当前作用域查找不到则会依次逐级查找父级作用域直到全局作用域</strong>，如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 全局作用域</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> a = <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> b = <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 局部作用域</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> c</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> a = <span class="number">10</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">// 10</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(d) <span class="comment">// 报错</span></span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 局部作用域</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">g</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> d = <span class="string">&#x27;yo&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">// 2</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 调用 g 函数</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">g</span>()</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(c) <span class="comment">// 报错</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(d) <span class="comment">// 报错</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">f</span>();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>嵌套关系的作用域串联起来形成了作用域链</li>
<li>相同作用域链中按着从小到大的规则查找变量</li>
<li>子作用域能够访问父作用域，父级作用域无法访问子级作用域</li>
</ol>
<h2 id="垃圾回收机制"><a href="#垃圾回收机制" class="headerlink" title="垃圾回收机制"></a>垃圾回收机制</h2><p>垃圾回收机制（Garbage Collection） 简称 GC。</p>
<p>JS 中内存的分配和回收都是自动完成的，内存在不使用的时候会被垃圾回收器自动回收。</p>
<h3 id="内存的生命周期"><a href="#内存的生命周期" class="headerlink" title="内存的生命周期"></a>内存的生命周期</h3><p>JS 环境中分配的内存，一般有如下生命周期：</p>
<ol>
<li>﻿﻿﻿内存分配：当我们声明变量、函数、对象的时候，系统会自动为他们分配内存</li>
<li>﻿﻿﻿内存使用：即读写内存，也就是使用变量、函数等</li>
<li>﻿﻿﻿内存回收：使用完毕，由<strong>垃圾回收器</strong>自动回收不再使用的内存</li>
</ol>
<p>说明：</p>
<ol>
<li>全局变量一般不会回收（关闭页面回收）</li>
<li>一般情况下<strong>局部变量的值</strong>，不用了，会被*<em>自动回收</em>掉</li>
</ol>
<p>内存泄漏：程序中分配的内存由于某种原因程序<strong>未释放</strong>或<strong>无法释放</strong>叫做内存泄漏</p>
<h3 id="垃圾回收机制算法"><a href="#垃圾回收机制算法" class="headerlink" title="垃圾回收机制算法"></a>垃圾回收机制算法</h3><p>堆栈空间分配区别：</p>
<ol>
<li>﻿﻿栈（操作系统）：由<strong>操作系统自动分配释放</strong>函数的参数值、局部变量等，基本数据类型放到栈里面</li>
<li>﻿﻿﻿堆（操作系统）：一般由程序员分配释放，若程序员不释放，由垃圾回收机制回收。<strong>复杂数据类型</strong>放到堆里面</li>
</ol>
<p>下面介绍两种常见的浏览器垃圾回收算法：引用计数法和标记清除法。</p>
<p><strong>引用计数</strong></p>
<p>IE 采用的引用计数算法，定义“内存不再使用”，就是看一个对象是否有指向它的引用，没有引用了就回收对象算法：</p>
<ol>
<li>﻿﻿﻿跟踪记录<strong>被引用的次数</strong></li>
<li>﻿﻿﻿如果被引用了一次，那么就记录次数1，多次引用会<strong>累加++</strong></li>
<li>﻿﻿﻿如果减少一个引用就<strong>减1–</strong></li>
<li>﻿﻿﻿如果<strong>引用次数是0</strong>，则释放内存</li>
</ol>
<p>但它却存在一个致命的问题：<strong>嵌套引用</strong>（循环引用）。</p>
<p>如果两个对象<strong>相互引用</strong>，尽管他们已不再使用，垃圾回收器不会进行回收，导致内存泄露。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> o1 = &#123;&#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> o2 = &#123;&#125;</span></span><br><span class="line"><span class="language-javascript">    o1.<span class="property">a</span> = o2</span></span><br><span class="line"><span class="language-javascript">    o2.<span class="property">a</span> = o1</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="string">&#x27;引用计数无法回收&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">fn</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>因为他们的引用次数永远不会是0。这样的相互引用如果说很大量的存在就会导致大量的内存泄露。</p>
<p><strong>标记清除法</strong></p>
<p>现代的浏览器已经不再使用引用计数算法了。</p>
<p>现代浏览器通用的大多是基于标记清除算法的某些改进算法，总体思想都是一致的。</p>
<p>核心：</p>
<ol>
<li>﻿﻿标记清除算法将“不再使用的对象”定义为“<strong>无法达到的对象</strong>”。</li>
<li>﻿﻿﻿就是从<strong>根部</strong>（在 JS 中就是全局对象）出发<strong>定时扫描</strong>内存中的对象。凡是能从<strong>根部到达</strong>的对象，都是还<strong>需要使用</strong>的。</li>
<li>﻿﻿﻿那些<strong>无法</strong>由根部出发触及到的<strong>对象被标记</strong>为不再使用，稍后进行<strong>回收</strong>。</li>
</ol>
<h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><p>概念：一个函数对周围状态的引用捆绑在一起，内层函数中访问到其外层函数的作用域。</p>
<p>简单理解：<strong>闭包 &#x3D; 内层函数＋外层函数的变量</strong>。</p>
<p>闭包存在的问题： 可能会造成内存泄漏。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> a = <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">fn</span>()</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">outer</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>闭包作用：封闭数据，提供操作，外部也可以访问函数内部的变量。</p>
<p>闭包的基本格式：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> a = <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> fn</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> fn = <span class="title function_">outer</span>()</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//外部函数访问函数内部的变量</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">fn</span>()  <span class="comment">// 1</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>简化写法：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> a = <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> fn = <span class="title function_">outer</span>()</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//外部函数访问函数内部的变量</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">fn</span>()  <span class="comment">// 1</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>闭包的应用： 实现数据的私有。</p>
<p>统计函数的调用次数：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> i = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      i++</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`函数调用了<span class="subst">$&#123;i&#125;</span>次`</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> fn = <span class="title function_">outer</span>()</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">fn</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="变量提升"><a href="#变量提升" class="headerlink" title="变量提升"></a>变量提升</h2><p>变量提升是 JavaScript 中比较“奇怪”的现象，它允许在变量声明之前即被访问（仅存在于 var 声明的变量）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 访问变量 str</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(str + <span class="string">&#x27; world!&#x27;</span>);  <span class="comment">//undefined worlds</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 声明变量 str</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> str = <span class="string">&#x27;hello&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>把所有 var 声明的变量提升到当前作用域的最前面</li>
<li>只提升声明，不提升赋值</li>
<li>变量在声明之前即被访问，变量的值为 <code>undefined</code></li>
<li><code>let</code> 声明的变量不存在变量提升，推荐使用 <code>let</code></li>
</ol>
<p>注：关于变量提升的原理分析会涉及较为复杂的词法分析等知识，而开发中使用 <code>let</code> 可以轻松规避变量的提升，因此在此不做过多的探讨，有兴趣可<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013915935">查阅资料</a>。</p>
<h1 id="函数进阶"><a href="#函数进阶" class="headerlink" title="函数进阶"></a>函数进阶</h1><h2 id="函数提升"><a href="#函数提升" class="headerlink" title="函数提升"></a>函数提升</h2><p>函数提升与变量提升比较类似，是指函数在声明之前即可被调用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">foo</span>()</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 声明函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;声明之前即被调用...&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 提升了 bar 变量声明，相当于 var bar</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">bar</span>()  <span class="comment">// 错误</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> bar = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;函数表达式不存在提升现象...&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>函数提升能够使函数的声明调用更灵活</li>
<li>函数表达式不存在提升的现象</li>
<li>函数提升出现在相同作用域当中</li>
</ol>
<h2 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h2><p>函数参数的使用细节，能够提升函数应用的灵活度。</p>
<h3 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a>默认参数</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 设置参数默认值</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params">name=<span class="string">&quot;小明&quot;</span>, age=<span class="number">18</span></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">`&lt;p&gt;大家好，我叫<span class="subst">$&#123;name&#125;</span>，我今年<span class="subst">$&#123;age&#125;</span>岁了。&lt;/p&gt;`</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">sayHi</span>();</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">sayHi</span>(<span class="string">&#x27;小红&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">sayHi</span>(<span class="string">&#x27;小刚&#x27;</span>, <span class="number">21</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>声明函数时为形参赋值即为参数的默认值</li>
<li>如果参数未自定义默认值时，参数的默认值为 <code>undefined</code></li>
<li>调用函数时没有传入对应实参时，参数的默认值被当做实参传入</li>
</ol>
<h3 id="动态参数"><a href="#动态参数" class="headerlink" title="动态参数"></a>动态参数</h3><p><code>arguments</code> 是函数内部内置的伪数组变量，它包含了调用函数时传入的所有实参。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 计算所有参数的和</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// console.log(arguments)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> s = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">      s += <span class="variable language_">arguments</span>[i]</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(s)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 调用求和函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">sum</span>(<span class="number">5</span>, <span class="number">10</span>)<span class="comment">// 两个参数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">sum</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>) <span class="comment">// 两个参数</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li><code>arguments</code> 是一个伪数组</li>
<li><code>arguments</code> 的作用是动态获取函数的实参</li>
</ol>
<h3 id="剩余参数"><a href="#剩余参数" class="headerlink" title="剩余参数"></a>剩余参数</h3><p>剩余参数允许我们将一个不定数量的参数表示为一个数组。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">config</span>(<span class="params">baseURL, ...other</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(baseURL) <span class="comment">// 得到 &#x27;http://baidu.com&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(other)  <span class="comment">// other  得到 [&#x27;get&#x27;, &#x27;json&#x27;]</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">config</span>(<span class="string">&#x27;http://baidu.com&#x27;</span>, <span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;json&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li><code>...</code> 是语法符号，置于最末函数形参之前，用于获取多余的实参</li>
<li>借助 <code>...</code> 获取的剩余实参，是个真数组</li>
</ol>
<p>补充：展开运算符</p>
<p>展开运算符 <code>...</code> 典型运用场景求数组最大值、合并数组</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(...arr) <span class="comment">// 1 2 3</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Math</span>.<span class="title function_">max</span>(...arr)  <span class="comment">// 3</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> arr2 = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> arr3 = [...arr, ...arr2] <span class="comment">// [1, 2, 3, 4, 5, 6]</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><p>目的：引入箭头函数的目的是更简短的函数写法并且不绑定 this，箭头函数的语法比函数表达式更简洁。</p>
<p>使用场景：箭头函数更适用于那些本来<strong>需要匿名函数的地方</strong>。</p>
<p>语法1：基本写法</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//普通函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> fn = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;普通函数&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">fn2</span> = (<span class="params">x</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;箭头函数&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>语法2：只有一个参数可以省略小括号</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">fn</span> = x =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;箭头函数&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>语法3：函数体只有一行代码，可以写到一行上</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">fn</span> = x =&gt; <span class="keyword">return</span> x + x;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>语法4：加括号的函数体返回对象字面量表达式</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">fn</span> = name =&gt; (&#123;<span class="attr">name</span>: name&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>箭头函数属于表达式函数，因此不存在函数提升</li>
<li>箭头函数只有一个参数时可以省略圆括号 <code>()</code></li>
<li>箭头函数函数体只有一行代码时可以省略花括号 <code>&#123;&#125;</code>，并自动做为返回值被返回</li>
<li>加括号的函数体返回对象字面量表达式</li>
</ol>
<h3 id="箭头函数参数"><a href="#箭头函数参数" class="headerlink" title="箭头函数参数"></a>箭头函数参数</h3><p>箭头函数中没有 <code>arguments</code>，只能使用 <code>...</code> 动态获取实参。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">getSum</span> = (<span class="params">...arr</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> sum = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">      sum += arr[i]</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> sum</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> result = <span class="title function_">getSum</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result) <span class="comment">// 9</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="箭头函数this"><a href="#箭头函数this" class="headerlink" title="箭头函数this"></a>箭头函数this</h3><p>在箭头函数出现之前，每一个新函数根据它是被如何调用的来定义这个函数的 this 值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)  <span class="comment">// window</span></span></span><br><span class="line"><span class="language-javascript">   <span class="comment">// 普通函数</span></span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)  <span class="comment">// window</span></span></span><br><span class="line"><span class="language-javascript">   &#125;</span></span><br><span class="line"><span class="language-javascript">   <span class="variable language_">window</span>.<span class="title function_">fn</span>()</span></span><br><span class="line"><span class="language-javascript">   </span></span><br><span class="line"><span class="language-javascript">   <span class="comment">// 对象方法里面的this</span></span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">const</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">     <span class="attr">name</span>: <span class="string">&#x27;andy&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">     <span class="attr">sayHi</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">       <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)  <span class="comment">// obj</span></span></span><br><span class="line"><span class="language-javascript">     &#125;</span></span><br><span class="line"><span class="language-javascript">   &#125;</span></span><br><span class="line"><span class="language-javascript">   obj.<span class="title function_">sayHi</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>箭头函数<strong>不会创建</strong>自己的this，它只会从自己的作用域链的<strong>上一层</strong>沿用 this。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通箭头函数 this</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">fn</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)  <span class="comment">// window</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">fn</span>()</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//对象方法箭头函数 this</span></span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">const</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">     <span class="attr">uname</span>: <span class="string">&#x27;pink老师&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">     <span class="attr">fn</span>: <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">       <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)  <span class="comment">// window</span></span></span><br><span class="line"><span class="language-javascript">       <span class="comment">// 内部箭头，fn 指向 window 所以 innferFn 指向 window</span></span></span><br><span class="line"><span class="language-javascript">       <span class="keyword">const</span> <span class="title function_">innerFn</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span></span><br><span class="line"><span class="language-javascript">       &#125;</span></span><br><span class="line"><span class="language-javascript">       <span class="title function_">innerFn</span>()  <span class="comment">// window</span></span></span><br><span class="line"><span class="language-javascript">     &#125;</span></span><br><span class="line"><span class="language-javascript">   &#125;</span></span><br><span class="line"><span class="language-javascript">   obj.<span class="title function_">fn</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h1><p>解构赋值是一种快速为变量赋值的简洁语法，本质上仍然是为<strong>变量赋值</strong>，分为数组解构、对象解构两大类型。</p>
<h2 id="数组解构"><a href="#数组解构" class="headerlink" title="数组解构"></a>数组解构</h2><p>数组解构是将数组的单元值快速批量赋值给一系列变量的简洁语法，如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通的数组</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 批量声明变量 a b c </span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 同时将数组单元值 1 2 3 依次赋值给变量 a b c</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> [a, b, c] = arr</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a); <span class="comment">// 1</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b); <span class="comment">// 2</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(c); <span class="comment">// 3</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>应用：交换两个变量</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> a = <span class="number">1</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> b = <span class="number">2</span>;</span></span><br><span class="line"><span class="language-javascript">  [b, a] = [a, b];</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>变量的数量大于单元值数量时，多余的变量将被赋值为  <code>undefined</code></li>
<li>变量的数量小于单元值数量时，可以通过 <code>...</code> 获取剩余单元值，但只能置于最末位</li>
<li>允许<strong>初始化</strong>变量的默认值，且只有单元值为 <code>undefined</code> 时默认值才会生效</li>
<li>可以按需解构，忽略某些返回值</li>
<li>支持多维解构赋值</li>
</ol>
<h2 id="对象解构"><a href="#对象解构" class="headerlink" title="对象解构"></a>对象解构</h2><p>对象解构是将对象属性和方法快速批量赋值给一系列变量的简洁语法，如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> user = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 批量声明变量 name age</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 同时将数组单元值 小明  18 依次赋值给变量 name  age</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> &#123;name, age&#125; = user</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name) <span class="comment">// 小明</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(age) <span class="comment">// 18</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对象解构的变量名可以重新改名，如下代码示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> name = <span class="string">&#x27;小红&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> user = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> &#123;<span class="attr">name</span>: username, age&#125; = user</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(username) <span class="comment">// 小明</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(age) <span class="comment">// 18</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>解构数组对象示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> user = [</span></span><br><span class="line"><span class="language-javascript">    &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  ]</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> [&#123;name, age&#125;] = user</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name) <span class="comment">// 小明</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(age) <span class="comment">// 18</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>多级对象解构示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> user = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: <span class="number">18</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">family</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">mother</span>: <span class="string">&#x27;母亲&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">father</span>: <span class="string">&#x27;父亲&#x27;</span> </span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> &#123;name, age, <span class="attr">family</span>: &#123;mother, father&#125;&#125; = user</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name) <span class="comment">// 小明</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(age) <span class="comment">// 18</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(mother) <span class="comment">// 母亲</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(father) <span class="comment">// 父亲   </span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对象解构配合函数传参示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> msg = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;code&quot;</span>: <span class="number">200</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;获取新闻列表成功&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;data&quot;</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;id&quot;</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;title&quot;</span>: <span class="string">&quot;5G商用自己，三大运用商收入下降&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;count&quot;</span>: <span class="number">58</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;id&quot;</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;title&quot;</span>: <span class="string">&quot;国际媒体头条速览&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;count&quot;</span>: <span class="number">56</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    ]</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// msg 虽然很多属性，但是我们利用解构只要 data 值</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">render1</span>(<span class="params">&#123; data &#125;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// const &#123; data &#125; = arr</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 只要 data 数据</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">render1</span>(msg)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 为了防止 msg 里面的 data 名字混淆，要求渲染函数里面的数据名改为 myData</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">render2</span>(<span class="params">&#123; data: myData &#125;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 要求将 获取过来的 data数据 更名为 myData</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(myData)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">render2</span>(msg)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>赋值运算符 <code>=</code> 左侧的 <code>&#123;&#125;</code> 用于批量声明变量，右侧对象的属性值将被赋值给左侧的变量</li>
<li>对象属性的值将被赋值给与属性名<strong>相同</strong>的变量</li>
<li>对象中找不到与变量名一致的属性时变量值为 <code>undefined</code></li>
<li>允许初始化变量的默认值，属性不存在或单元值为 <code>undefined</code> 时默认值才会生效</li>
<li>对象解构的变量名可以重新改名，语法 <code>旧变量名: 新变量名</code></li>
<li>支持多维解构赋值</li>
</ol>
<h1 id="深入对象"><a href="#深入对象" class="headerlink" title="深入对象"></a>深入对象</h1><h2 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h2><p>创建对象有三种方式。</p>
<ol>
<li>﻿﻿﻿利用对象字面量创建对象</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>﻿﻿利用 <code>new Object</code> 对象</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="keyword">new</span> <span class="title class_">Object</span>(&#123;<span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>利用构造函数创建对象</li>
</ol>
<p>构造函数是专门用于创建对象的函数，如果一个函数使用 <code>new</code> 关键字调用，那么这个函数就是构造函数。</p>
<p>约定（不是必须）：</p>
<ol>
<li>构造函数的命名以大写字母开头</li>
<li>构造函数只能由 <code>new</code> 操作符来执行</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">User</span>(<span class="params">uname, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = uname;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&#x27;小明&#x27;</span>, <span class="number">18</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(user);</span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li><p>使用 <code>new</code> 关键字调用函数的行为被称为实例化</p>
</li>
<li><p>实例化构造函数时没有参数时可以省略 <code>()</code></p>
</li>
<li><p>构造函数的返回值即为新创建的对象</p>
</li>
<li><p>构造函数内部的 <code>return</code> 返回的值无效！</p>
</li>
</ol>
<p>注：实践中为了从视觉上区分构造函数和普通函数，习惯将构造函数的首字母大写。</p>
<h2 id="实例成员"><a href="#实例成员" class="headerlink" title="实例成员"></a>实例成员</h2><p>通过<strong>构造函数创建</strong>的对象称为实例对象，实例对象中的属性和方法称为实例成员。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 构造函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 构造函数内部的 this 就是实例对象</span></span></span><br><span class="line"><span class="language-javascript">      </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 实例对象中动态添加属性</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;小明&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 实例对象动态添加方法</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">sayHi</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;大家好~&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 实例化，p1 是实例对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// p1 实际就是 构造函数内部的 this</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>()</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p1)</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">name</span>) <span class="comment">// 访问实例属性</span></span></span><br><span class="line"><span class="language-javascript">  p1.<span class="title function_">sayHi</span>() <span class="comment">// 调用实例方法</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>构造函数内部 <code>this</code> 实际上就是实例对象，为其动态添加的属性和方法即为实例成员</li>
<li>为构造函数传入参数，动态创建结构相同但值不同的对象</li>
</ol>
<p>注：构造函数创建的实例对象<strong>彼此独立</strong>互不影响。</p>
<h2 id="静态成员"><a href="#静态成员" class="headerlink" title="静态成员"></a>静态成员</h2><p>在 JavaScript 中底层函数本质上也是对象类型，因此允许直接为函数动态添加属性或方法，<strong>构造函数的属性和方法</strong>被称为静态成员。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 构造函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 省略实例成员</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 静态属性</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Person</span>.<span class="property">eyes</span> = <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Person</span>.<span class="property">arms</span> = <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 静态方法</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Person</span>.<span class="property">walk</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;人都会走路...&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// this 指向 Person</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">eyes</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>静态成员指的是添加到构造函数本身的属性和方法</li>
<li>一般公共特征的属性或方法静态成员设置为静态成员</li>
<li>静态成员方法中的 <code>this</code> 指向构造函数本身</li>
</ol>
<h1 id="内置构造函数"><a href="#内置构造函数" class="headerlink" title="内置构造函数"></a>内置构造函数</h1><p>在 JavaScript 中最主要的数据类型有 6 种，分别是字符串、数值、布尔、undefined、null 和 对象，常见的对象类型数据包括数组和普通对象。其中字符串、数值、布尔、undefined、null 也被称为简单类型或基础类型，对象也被称为引用类型。</p>
<p>在 JavaScript 内置了一些构造函数，绝大部的数据处理都是基于这些构造函数实现的，JavaScript 基础阶段学习的 <code>Date</code> 就是内置的构造函数。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 实例化</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// date 即为实例对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(date);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>甚至字符串、数值、布尔、数组、普通对象也都有专门的构造函数，用于创建对应类型的数据。</p>
<h2 id="引用类型"><a href="#引用类型" class="headerlink" title="引用类型"></a>引用类型</h2><h3 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h3><p><code>Object</code> 是内置的构造函数，用于创建普通对象。</p>
<p><code>Object.keys</code> 静态方法获取对象中所有键值数组。</p>
<p><code>Object.values</code> 静态方法获取对象中所有属性值数组。</p>
<p><code>Object.assign</code> 静态方法用于对象拷贝。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> o = &#123;<span class="attr">uname</span>: <span class="string">&#x27;小明&#x27;</span>, <span class="attr">age</span>: <span class="number">18</span>&#125;</span><br><span class="line"><span class="comment">// 获取 key 数组</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(o))  <span class="comment">//[&#x27;uname&#x27;, &#x27;age&#x27;]</span></span><br><span class="line"><span class="comment">// 获取 value 数组</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">values</span>(o))  <span class="comment">//[&#x27;小明&#x27;, 18]</span></span><br><span class="line"><span class="comment">// 拷贝对象</span></span><br><span class="line"><span class="keyword">const</span> oo = &#123;<span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span>&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(oo, o)  <span class="comment">// &#123;uname: &#x27;小明&#x27;, age: 18, gender: &#x27;男&#x27;&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h3><p><code>Array</code> 是内置的构造函数，用于创建数组。</p>
<p>数组常见实例方法：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>作用</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>forEach</td>
<td>遍历数组</td>
<td>不返回数组，经常用于查找遍历数组元素</td>
</tr>
<tr>
<td>filter</td>
<td>过滤数组</td>
<td>返回新数组，返回的是筛选满足条件的数组元素</td>
</tr>
<tr>
<td>mpa</td>
<td>迭代数组</td>
<td>返回新数组，返回的是处理之后的数组元素</td>
</tr>
<tr>
<td>reduce</td>
<td>累计器</td>
<td>返回累计处理的结果，经常用于求和呃呃等</td>
</tr>
<tr>
<td>join</td>
<td>拼接字符串</td>
<td>数组元素拼接为字符串，返回字符串</td>
</tr>
<tr>
<td>every</td>
<td>所有元素是否都符合指定条件</td>
<td>如果所有元素都通过检测返回 true，否则返回 false</td>
</tr>
<tr>
<td>some</td>
<td>数组中的元素是否满足指定条件</td>
<td>如果数组中有元素满足条件返回 true，否则返回 false</td>
</tr>
<tr>
<td>find</td>
<td>查找元素</td>
<td>返回符合条件的第一个数组元素值，如果没有符合条件的则返回 undefined</td>
</tr>
<tr>
<td>findIndex</td>
<td>查找元素的索引值</td>
<td>返回符合条件的第一个数组元素的索引值</td>
</tr>
<tr>
<td>concat</td>
<td>合并两个数组</td>
<td>合并两个数组，返回生成新数组</td>
</tr>
<tr>
<td>sort</td>
<td>排序数组</td>
<td>对原数组单元值排序</td>
</tr>
<tr>
<td>splice</td>
<td>删除或替换原数组单元</td>
<td></td>
</tr>
<tr>
<td>reverse</td>
<td>反转数组</td>
<td></td>
</tr>
</tbody></table>
<h2 id="包装类型"><a href="#包装类型" class="headerlink" title="包装类型"></a>包装类型</h2><p>在 JavaScript 中的字符串、数值、布尔具有对象的使用特征，如具有属性和方法，如下代码举例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 字符串类型</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> str = <span class="string">&#x27;hello world!&#x27;</span></span></span><br><span class="line"><span class="language-javascript"> 	<span class="comment">// 统计字符的长度（字符数量）</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="property">length</span>)</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 数值类型</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> price = <span class="number">12.345</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 保留两位小数</span></span></span><br><span class="line"><span class="language-javascript">  price.<span class="title function_">toFixed</span>(<span class="number">2</span>) <span class="comment">// 12.34</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>之所以具有对象特征的原因是字符串、数值、布尔类型数据是 JavaScript 底层使用 Object 构造函数“包装”来的，被称为<strong>包装类型</strong>。</p>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p><code>String</code> 是内置的构造函数，用于创建字符串。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 使用构造函数创建字符串</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> str = <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&#x27;hello world!&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 字面量创建字符串</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> str2 = <span class="string">&#x27;你好，世界！&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 检测是否属于同一个构造函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="property">constructor</span> === str2.<span class="property">constructor</span>); <span class="comment">// true</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(str <span class="keyword">instanceof</span> <span class="title class_">String</span>); <span class="comment">// false</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>实例属性 <code>length</code> 用来获取字符串的度长(重点)</li>
<li>实例方法 <code>split(&#39;分隔符&#39;)</code> 用来将字符串拆分成数组(重点)</li>
<li>实例方法 <code>substring（需要截取的第一个字符的索引[,结束的索引号]）</code> 用于字符串截取(重点)</li>
<li>实例方法 <code>startsWith(检测字符串[, 检测位置索引号])</code> 检测是否以某字符开头(重点)</li>
<li>实例方法 <code>includes(搜索的字符串[, 检测位置索引号])</code> 判断一个字符串是否包含在另一个字符串中，根据情况返回 true 或 false(重点)</li>
<li>实例方法 <code>toUpperCase</code> 用于将字母转换成大写</li>
<li>实例方法 <code>toLowerCase</code> 用于将就转换成小写</li>
<li>实例方法 <code>indexOf</code>  检测是否包含某字符</li>
<li>实例方法 <code>endsWith</code> 检测是否以某字符结尾</li>
<li>实例方法 <code>replace</code> 用于替换字符串，支持正则匹配</li>
<li>实例方法 <code>match</code> 用于查找字符串，支持正则匹配</li>
</ol>
<p>注：String 也可以当做普通函数使用，这时它的作用是强制转换成字符串数据类型。</p>
<h3 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h3><p><code>Number</code> 是内置的构造函数，用于创建数值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 使用构造函数创建数值</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> x = <span class="keyword">new</span> <span class="title class_">Number</span>(<span class="string">&#x27;10&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> y = <span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">5</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 字面量创建数值</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> z = <span class="number">20</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>推荐使用字面量方式声明数值，而不是 <code>Number</code> 构造函数</li>
<li>实例方法 <code>toFixed</code> 用于设置保留小数位的长度</li>
<li>实例方法 <code>toString</code> 用于转换为字符串</li>
</ol>
<h1 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h1><p>对比以下通过面向对象的构造函数实现的封装：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;佚名&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 设置名字</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">setName</span> = <span class="keyword">function</span> (<span class="params">name</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">name</span> = name</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 读取名字</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">getName</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 实例对像，获得了构造函数中封装的所有逻辑</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>()</span></span><br><span class="line"><span class="language-javascript">  p1.<span class="title function_">setName</span>(<span class="string">&#x27;小明&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">name</span>)  <span class="comment">// 小明</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 实例对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Person</span>()</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p2.<span class="property">name</span>)  <span class="comment">// 佚名</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>封装是面向对象思想中比较重要的一部分，JavaScript 面向对象可以通过构造函数实现的封装。</p>
<p>同样的将变量和函数组合到了一起并能通过 this 实现数据的共享，所不同的是借助构造函数创建出来的实例对象之间是彼此不影响的。</p>
<p>总结：</p>
<ol>
<li>构造函数体现了面向对象的封装特性</li>
<li>构造函数实例创建的对象彼此独立、互不影响</li>
</ol>
<p>封装是面向对象思想中比较重要的一部分，JavaScript <strong>面向对象可以通过构造函数实现的封装</strong>。</p>
<p>前面我们学过的构造函数方法很好用，但是可能存在<strong>浪费内存</strong>的问题。</p>
<h1 id="原型对象"><a href="#原型对象" class="headerlink" title="原型对象"></a>原型对象</h1><p>构造函数同一个函数多次实例化后会浪费内存，但是如果希望所有使用的对象使用同一函数，这样比较节省内存，需要怎么做？</p>
<p>构造函数通过原型分配的函数是所有对象所<strong>共享</strong>的。</p>
<ol>
<li>JavaScript 规定，<strong>每一个构造函数都有一个 prototype 属性</strong>，指向另一个对象，所以我们也称为<strong>原型对象</strong></li>
<li>这个对象可以挂载函数，对象实例化不会多次创建原型上函数，节约内存</li>
<li>我们可以把那些<strong>不变</strong>的方法，直接定义在 prototype 对象上，这样所有对象的实例就可以共享这些方法</li>
<li>构造函数和原型对象中的 this 都<strong>指向实例化的对象</strong></li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 每个函数都有 prototype 属性</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>了解了 JavaScript 中构造函数与原型对象的关系后，再来看原型对象具体的作用，如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 此处未定义任何方法</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 为构造函数的原型对象添加方法</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHi</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hi&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">	</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 实例化</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span></span><br><span class="line"><span class="language-javascript">  p1.<span class="title function_">sayHi</span>(); <span class="comment">// Hi</span></span></span><br><span class="line"><span class="language-javascript">   </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span></span><br><span class="line"><span class="language-javascript">  p2.<span class="title function_">sayHi</span>(); <span class="comment">// 输出结果为 Hi</span></span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">sayHi</span> === p2.<span class="property">sayHi</span>) <span class="comment">// true</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>构造函数 <code>Person</code> 中未定义任何方法，这时实例对象调用了原型对象中的方法 <code>sayHi</code>，接下来改动一下代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 此处定义同名方法 sayHi</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">sayHi</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;嗨!&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 为构造函数的原型对象添加方法</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHi</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hi~&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>();</span></span><br><span class="line"><span class="language-javascript">  p1.<span class="title function_">sayHi</span>(); <span class="comment">// 输出结果为 嗨!</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>构造函数 <code>Person</code> 中定义与原型对象中相同名称的方法，这时实例对象调用则是构造函中的方法 <code>sayHi</code>。</p>
<p>通过以上两个简单示例不难发现 JavaScript 中对象的工作机制：<strong>当访问对象的属性或方法时，先在当前实例对象是查找，然后再去原型对象查找，并且原型对象被所有实例共享。</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 此处定义同名方法 sayHi</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">sayHi</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;嗨!&#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 为构造函数的原型对象添加方法</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHi</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hi~&#x27;</span> + <span class="variable language_">this</span>.<span class="property">name</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 在构造函数的原型对象上添加属性</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">name</span> = <span class="string">&#x27;小明&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>()</span></span><br><span class="line"><span class="language-javascript">  p1.<span class="title function_">sayHi</span>(); <span class="comment">// 输出结果为 嗨!</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="title class_">Person</span>()</span></span><br><span class="line"><span class="language-javascript">  p2.<span class="title function_">sayHi</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：<strong>结合构造函数原型的特征，实际开发重往往会将封装的功能函数添加到原型对象中。</strong></p>
<h2 id="constructor属性"><a href="#constructor属性" class="headerlink" title="constructor属性"></a>constructor属性</h2><p>在哪里？ 每个原型对象里面都有个 constructor 属性（constructor 构造函数）</p>
<p>作用：该属性指向该原型对象的构造函数， 简单理解，就是指向我的爸爸，我是有爸爸的孩子</p>
<p><strong>使用场景：</strong></p>
<p>如果有多个对象的方法，我们可以给原型对象采取对象形式赋值，但是这样就会<strong>覆盖</strong>构造函数原型对象原来的内容，这样修改后的原型对象 constructor 就不再指向当前构造函数了，此时，我们可以在修改后的原型对象中，添加一个 constructor 指向原来的构造函数。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Star</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Star</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 重新指回创造这个原型对象的构造函数</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">constructor</span>: <span class="title class_">Star</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">sing</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;唱歌&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">dance</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;跳舞&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="对象原型"><a href="#对象原型" class="headerlink" title="对象原型"></a>对象原型</h2><p>对象都会有一个属性 <code>__proto__</code> <strong>指向构造函数的 prototype 原型对象</strong>，之所以我们对象可以使用构造函数 prototype  原型对象的属性和方法，就是因为对象有 <code>__proto__</code> 原型的存在。</p>
<p>注意：</p>
<ol>
<li><code>__proto__</code> 是 JavaScript 非标准属性</li>
<li><code>[[prototype]]</code>和 <code>__proto__</code> 意义相同</li>
<li>用来表明当前实例对象指向哪个原型对象 prototype</li>
<li><code>__proto__</code> 对象原型里面也有一个 constructor 属性，指向创建该实例对象的构造函数</li>
</ol>
<p>示例图：</p>
<img src="/2024/01/10/JavaScript%E8%BF%9B%E9%98%B6/原型对象和对象原型.png" alt="原型对象和对象原型" style="zoom:40%;">

<h2 id="原型继承"><a href="#原型继承" class="headerlink" title="原型继承"></a>原型继承</h2><p>继承是面向对象编程的另一个特征，通过继承进一步提升代码封装的程度，JavaScript 中大多是借助原型对象实现继承的特性。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">eyes</span> = <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">head</span> = <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Woman</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Woman 通过原型来继承 Person</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 子类的原型 = new 父类</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Woman</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Person</span>()</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 指回原来的构造函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Woman</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Woman</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> w = <span class="keyword">new</span> <span class="title class_">Woman</span>()</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(w)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h2><p>基于原型对象的继承使得不同构造函数的原型对象关联在一起，并且这种关联的关系是一种链状的结构，我们将原型对象的链状结构关系称为原型链。</p>
<img src="/2024/01/10/JavaScript%E8%BF%9B%E9%98%B6/原型链.png" alt="原型链" style="zoom:70%;">



<p>原型链查找规则：</p>
<ol>
<li>当访问一个对象的属性（包括方法）时，首先查找这个对象自身有没有该属性</li>
<li>如果没有就查找它的原型（也就是 <code>__proto__</code> 指向的 prototype 原型对象）</li>
<li>如果还没有就查找原型对象的原型（Object的原型对象）</li>
<li>依此类推一直找到 Object 为止（null）</li>
<li><code>__proto__</code> 对象原型的意义就在于为对象成员查找机制提供一个方向，或者说一条路线</li>
<li>可以使用 instanceof 运算符用于检测构造函数的 prototype 属性是否出现在某个实例对象的原型链上</li>
</ol>
<p><strong>所有的对象都有<code>__proto__</code>；所有的原型对象都有 constructor。</strong></p>
<h1 id="深浅拷贝"><a href="#深浅拷贝" class="headerlink" title="深浅拷贝"></a>深浅拷贝</h1><p>首先浅拷贝和深拷贝只针对引用类型。</p>
<h2 id="浅拷贝"><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a>浅拷贝</h2><p>直接赋值：只要是对象会相互影响，因为拷贝对象的地址。</p>
<p>浅拷贝：拷贝对象后，里面的属性值是简单数据类型直接拷贝，如果是引用类型则拷贝地址。</p>
<p>常见方法：</p>
<ol>
<li>拷贝对象：<code>Object.assgin()</code>  或者展开运算符 <code>&#123;...obj&#125;</code> 拷贝对象</li>
<li>拷贝数组：<code>Array.prototype.concat()</code> 或者 <code>[...arr]</code></li>
</ol>
<blockquote>
<p>如果是简单数据类型拷贝值，引用数据类型拷贝的是地址 （简单理解： 如果是单层对象，没问题，如果有多层就有问题）</p>
</blockquote>
<h2 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h2><p>深拷贝：拷贝的是对象，不是地址。</p>
<p>常见方法：</p>
<ol>
<li>通过递归实现深拷贝</li>
<li>lodash&#x2F;cloneDeep</li>
<li>通过 JSON.stringify() 实现</li>
</ol>
<h3 id="递归实现"><a href="#递归实现" class="headerlink" title="递归实现"></a>递归实现</h3><p>函数递归：</p>
<p>如果一个函数在内部可以调用其本身，那么这个函数就是递归函数。</p>
<ol>
<li>简单理解：函数内部自己调用自己, 这个函数就是递归函数</li>
<li>递归函数的作用和循环效果类似</li>
<li>由于递归很容易发生“栈溢出”错误（stack overflow），所以必须要加退出条件 return</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;小明&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: <span class="number">18</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">hobby</span>: [<span class="string">&quot;足球&quot;</span>, <span class="string">&quot;篮球&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">family</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">father</span>: <span class="string">&quot;父亲&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">mother</span>: <span class="string">&quot;母亲&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> newObj = &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">deepCopy</span>(<span class="params">oldObj, newObj</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">in</span> oldObj) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (oldObj[k] <span class="keyword">instanceof</span> <span class="title class_">Array</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        newObj[k] = [];</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">deepCopy</span>(oldObj[k], newObj[k]);</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (oldObj[k] <span class="keyword">instanceof</span> <span class="title class_">Object</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        newObj[k] = &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">deepCopy</span>(oldObj[k], newObj[k]);</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        newObj[k] = oldObj[k];</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">deepCopy</span>(obj, newObj);</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(newObj);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="通过lodash实现"><a href="#通过lodash实现" class="headerlink" title="通过lodash实现"></a>通过lodash实现</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 先引用 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./lodash.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">uname</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">age</span>: <span class="number">18</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">hobby</span>: [<span class="string">&#x27;乒乓球&#x27;</span>, <span class="string">&#x27;足球&#x27;</span>],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">family</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">father</span>: <span class="string">&quot;父亲&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">mother</span>: <span class="string">&quot;母亲&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> o = _.<span class="title function_">cloneDeep</span>(obj)</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(o)</span></span><br><span class="line"><span class="language-javascript">    o.<span class="property">family</span>.<span class="property">baby</span> = <span class="string">&#x27;小红&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="JSON序列化"><a href="#JSON序列化" class="headerlink" title="JSON序列化"></a>JSON序列化</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> obj = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">uname</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">age</span>: <span class="number">18</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">hobby</span>: [<span class="string">&#x27;乒乓球&#x27;</span>, <span class="string">&#x27;足球&#x27;</span>],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">family</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">father</span>: <span class="string">&quot;父亲&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">mother</span>: <span class="string">&quot;母亲&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 把对象转换为 JSON 字符串</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// console.log(JSON.stringify(obj))</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> o = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj))</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(o)</span></span><br><span class="line"><span class="language-javascript">    o.<span class="property">family</span>.<span class="property">baby</span> = <span class="string">&#x27;小红&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h1><h2 id="throw"><a href="#throw" class="headerlink" title="throw"></a>throw</h2><p>异常处理是指预估代码执行过程中可能发生的错误，然后最大程度的避免错误的发生导致整个程序无法继续运行。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">x, y</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span>(!x || !y) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// throw &#x27;参数不能为空!&#x27;;</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;参数不能为空!&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> x + y</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">counter</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li><code>throw</code> 抛出异常信息，程序也会终止执行</li>
<li><code>throw</code> 后面跟的是错误提示信息</li>
<li><code>Error</code> 对象配合 <code>throw</code> 使用，能够设置更详细的错误信息</li>
</ol>
<h2 id="try-…-catch"><a href="#try-…-catch" class="headerlink" title="try … catch"></a>try … catch</h2><p>我们可以通过 <code>try...catch</code> 捕获错误信息（浏览器提供的错误信息）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 查找 DOM 节点</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.p&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        p.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// try 代码段中执行有错误时，会执行 catch 代码段</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 查看错误信息</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">message</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 终止代码继续执行</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">      &#125; </span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 一定会执行</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&#x27;一定会执行&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;如果出现错误，我的语句不会执行&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">foo</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li><code>try...catch</code> 用于捕获错误信息</li>
<li>将预估可能发生错误的代码写在 <code>try</code> 代码段中</li>
<li>如果 <code>try</code> 代码段中出现错误后，会执行 <code>catch</code> 代码段，并截获到错误信息</li>
<li><code>finally</code> 不管是否有错误，都会执行</li>
</ol>
<h2 id="debugger"><a href="#debugger" class="headerlink" title="debugger"></a>debugger</h2><p><code>debugger</code> 关键字，相当于断点调试。</p>
<h1 id="this"><a href="#this" class="headerlink" title="this"></a>this</h1><p><code>this</code> 是 JavaScript 最具“魅惑”的知识点，不同的应用场合 <code>this</code> 的取值可能会有意想不到的结果，在此我们对以往学习过的关于<code>this</code> 默认的取值情况进行归纳和总结。</p>
<h2 id="this指向"><a href="#this指向" class="headerlink" title="this指向"></a>this指向</h2><h3 id="普通函数"><a href="#普通函数" class="headerlink" title="普通函数"></a>普通函数</h3><p>普通函数的调用方式决定了 <code>this</code> 的值，即<strong>谁调用 <code>this</code> 的值指向谁</strong>，如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)  </span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 函数表达式</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> sayHello = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">sayHi</span>() <span class="comment">// window</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="title function_">sayHi</span>()  <span class="comment">// window</span></span></span><br><span class="line"><span class="language-javascript">	</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> user = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  user.<span class="property">sayHi</span> = sayHi</span></span><br><span class="line"><span class="language-javascript">  uesr.<span class="property">sayHello</span> = sayHello</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  user.<span class="title function_">sayHi</span>()  <span class="comment">// user</span></span></span><br><span class="line"><span class="language-javascript">  user.<span class="title function_">sayHello</span>()  <span class="comment">// user</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注： 普通函数没有明确调用者时 <code>this</code> 值为 <code>window</code>，严格模式下（<code>use strict;</code>）没有调用者时 <code>this</code> 的值为 <code>undefined</code>。</p>
<h3 id="箭头函数-1"><a href="#箭头函数-1" class="headerlink" title="箭头函数"></a>箭头函数</h3><p><strong>箭头函数</strong>中的 <code>this</code> 与普通函数完全不同，也不受调用方式的影响，事实上箭头函数中并不存在 <code>this</code> ！箭头函数中访问的 <code>this</code> 不过是箭头函数所在作用域的 <code>this</code> 变量。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">// 此处为 window</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> user = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">walk</span>: <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">log</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 函数调用</span></span></span><br><span class="line"><span class="language-javascript">  user.<span class="title function_">log</span>()  <span class="comment">// user</span></span></span><br><span class="line"><span class="language-javascript">  user.<span class="title function_">walk</span>()  <span class="comment">// this</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在开发中使用箭头函数前需要考虑函数中 <code>this</code> 的值，<strong>事件回调函数</strong>使用箭头函数时，<code>this</code> 为全局的 <code>window</code>，因此 DOM 事件回调函数不推荐使用箭头函数，如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// DOM 节点</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.btn&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 箭头函数 此时 this 指向了 window</span></span></span><br><span class="line"><span class="language-javascript">  btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通函数 此时 this 指向了 DOM 对象</span></span></span><br><span class="line"><span class="language-javascript">  btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>同样由于箭头函数 <code>this</code> 的原因，<strong>基于原型的面向对象也不推荐采用箭头函数</strong>，如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 原型对像上添加了箭头函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">walk</span> = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;人都要走路...&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>); <span class="comment">// window</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>()</span></span><br><span class="line"><span class="language-javascript">  p1.<span class="title function_">walk</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="改变this"><a href="#改变this" class="headerlink" title="改变this"></a>改变this</h2><p>以上归纳了普通函数和箭头函数中关于 <code>this</code> 默认值的情形，不仅如此 JavaScript 中还允许指定函数中 <code>this</code> 的指向，有 3 个方法可以动态指定普通函数中 <code>this</code> 的指向：</p>
<h3 id="call"><a href="#call" class="headerlink" title="call"></a>call</h3><p>使用 <code>call</code> 方法调用函数，同时指定函数中 <code>this</code> 的值，使用方法如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> user = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 调用函数并指定 this 的值</span></span></span><br><span class="line"><span class="language-javascript">  sayHi.<span class="title function_">call</span>(user); <span class="comment">// this 值为 user</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 求和函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">counter</span>(<span class="params">x, y</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> x + y;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 调用 counter 函数，并传入参数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> result = counter.<span class="title function_">call</span>(<span class="literal">null</span>, <span class="number">5</span>, <span class="number">10</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li><code>call</code> 方法能够在调用函数的同时指定 <code>this</code> 的值</li>
<li>使用 <code>call</code> 方法调用函数时，第一个参数为 <code>this</code> 指定的值</li>
<li><code>call</code> 方法的其余参数会依次自动传入函数做为函数的参数</li>
</ol>
<h3 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h3><p>使用 <code>apply</code> 方法调用函数，同时指定函数中 <code>this</code> 的值，使用方法如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> obj = &#123;&#125;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">print</span>(<span class="params">x, y</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  print.<span class="title function_">apply</span>(obj, [<span class="number">5</span>, <span class="number">10</span>])</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 使用场景：求数组最大值</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> max = <span class="title class_">Math</span>.<span class="property">max</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, arr)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li><code>apply</code> 方法能够在调用函数的同时指定 <code>this</code> 的值</li>
<li>使用 <code>apply</code> 方法调用函数时，第一个参数为 <code>this</code> 指定的值</li>
<li><code>apply</code> 方法第二个参数为数组，数组的单元值依次自动传入函数做为函数的参数</li>
</ol>
<h3 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h3><p><code>bind</code> 方法并<strong>不会调用函数</strong>，而是创建一个指定了 <code>this</code> 值的新函数，使用方法如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 普通函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> user = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: <span class="number">18</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 调用 bind 指定 this 的值</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> sayHello = sayHi.<span class="title function_">bind</span>(user)</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 调用使用 bind 创建的新函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">sayHello</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注：<code>bind</code> 方法创建新的函数，与原函数的唯一的变化是改变了 <code>this</code> 的值。</p>
<h1 id="防抖节流"><a href="#防抖节流" class="headerlink" title="防抖节流"></a>防抖节流</h1><ol>
<li>防抖（debounce）：单位时间内，频繁触发事件，<strong>只执行最后一次</strong>。</li>
<li>节流（throttle）：单位时间内，频繁触发事件，<strong>只执行第一次</strong>。</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2024/01/05/WebAPIs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/05/WebAPIs/" class="post-title-link" itemprop="url">WebAPIs</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-05 21:06:20" itemprop="dateCreated datePublished" datetime="2024-01-05T21:06:20+08:00">2024-01-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-20 08:33:57" itemprop="dateModified" datetime="2024-01-20T08:33:57+08:00">2024-01-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ECMAScript 简称 ES 它提供了一套语言标准规范，如变量、数据类型、表达式、语句、函数等语法规则都是由 ECMAScript 规定的。浏览器将 ECMAScript 大部分的规范加以实现，并且在此基础上又扩展一些实用的功能，这些被扩展出来的内容我们称为 Web APIs。</p>
<p>ECMAScript 运行在浏览器中然后再结合 Web APIs 才是真正的 JavaScript，Web APIs 的核心是 DOM 和 BOM。</p>
<p>扩展阅读：ECMAScript 规范在不断的更新中，存在多个不同的版本，早期的版本号采用数字顺序编号如 ECMAScript3、ECMAScript5，后来由于更新速度较快便采用年份做为版本号，如 ECMAScript2017、ECMAScript2018 这种格式，ECMAScript6 是 2015 年发布的，常叫做 EMCAScript2015。</p>
<p>关于 JavaScript 历史的<a target="_blank" rel="noopener" href="https://javascript.ruanyifeng.com/introduction/history.html">扩展阅读</a>。</p>
<img src="/2024/01/05/WebAPIs/guide.png" alt="js结构" style="zoom:50%;">

<h1 id="DOM简介"><a href="#DOM简介" class="headerlink" title="DOM简介"></a>DOM简介</h1><p>DOM（Document Object Model）是将整个 HTML 文档的每一个标签元素视为一个对象，这个对象下包含了许多的属性和方法，通过操作这些属性或者调用这些方法实现对 HTML 的动态更新，为实现网页特效以及用户交互提供技术支撑。</p>
<p>简言之 DOM 是用来动态修改 HTML 的，其目的是开发网页特效及用户交互。</p>
<h2 id="DOM树"><a href="#DOM树" class="headerlink" title="DOM树"></a>DOM树</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    文本</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>链接名<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如下图所示，将 HTML 文档以树状结构直观的表现出来，我们称之为文档树或 DOM 树，<strong>文档树直观的体现了标签与标签之间的关系。</strong></p>
<img src="/2024/01/05/WebAPIs/web-api.jpg" alt="DOM树" style="zoom:80%;">

<h2 id="DOM节点"><a href="#DOM节点" class="headerlink" title="DOM节点"></a>DOM节点</h2><p>节点是文档树的组成部分，<strong>每一个节点都是一个 DOM 对象</strong>，主要分为元素节点、属性节点、文本节点等。</p>
<ol>
<li>【元素节点】其实就是 HTML 标签，如上图中 <code>head</code>、<code>div</code>、<code>body</code> 等都属于元素节点。</li>
<li>【属性节点】是指 HTML 标签中的属性，如上图中 <code>a</code> 标签的 <code>href</code> 属性、<code>div</code> 标签的 <code>class</code> 属性。</li>
<li>【文本节点】是指 HTML 标签的文字内容，如 <code>title</code> 标签中的文字。</li>
<li>【根节点】特指 <code>html</code> 标签。</li>
<li>其它…</li>
</ol>
<h2 id="document"><a href="#document" class="headerlink" title="document"></a>document</h2><p><code>document</code> 是 JavaScript 内置的专门用于 DOM 的对象，该对象包含了若干的属性和方法，<code>document</code> 是学习 DOM 的核心。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// document 是内置的对象</span></span><br><span class="line"><span class="comment">// console.log(typeof document);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 通过 document 获取根节点</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>); <span class="comment">// 对应 html 标签</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 通过 document 节取 body 节点</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">body</span>); <span class="comment">// 对应 body 标签</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 通过 document.write 方法向网页输出内容</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>上述列举了 <code>document</code> 对象的部分属性和方法，我们先对 <code>document</code> 有一个整体的认识。</p>
<h1 id="DOM操作元素"><a href="#DOM操作元素" class="headerlink" title="DOM操作元素"></a>DOM操作元素</h1><p>DOM 允许 JavaScript 改变 HTML 元素的内容以及改变元素的属性。</p>
<h2 id="获取DOM对象"><a href="#获取DOM对象" class="headerlink" title="获取DOM对象"></a>获取DOM对象</h2><p>根据 CSS 选择器来获取 DOM 元素。</p>
<ol>
<li><p>选择匹配的第一个元素</p>
<ol>
<li>语法：<code>document.querySelector(&#39;CSS选择器&#39;)</code></li>
<li>参数：包含一个或多个有效的 CSS 选择器字符串</li>
<li>返回值：CSS 选择器匹配到的<strong>第一个元素</strong>，一个 <code>HTMLElement</code> 对象。如果没有匹配到，则返回 null</li>
</ol>
</li>
<li><p>选择匹配的多个元素</p>
<ol>
<li>语法：<code>document.querySelectorAll(&#39;CSS选择器&#39;)</code></li>
<li>参数：包含一个或多个有效的 CSS 选择器字符串</li>
<li>返回值：CSS 选择器匹配到的 <code>NodeList</code> 对象集合。</li>
</ol>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;nav&quot;</span>&gt;</span>p标签<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>item1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>item2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>item3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>item4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;p&quot;</span>); <span class="comment">// 获取第一个p元素</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#nav&quot;</span>); <span class="comment">// 获取第一个p元素</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box&quot;</span>);  <span class="comment">// 获取第一个div元素</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> li = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;ul li:nth-child(1)&quot;</span>); <span class="comment">// 获取第一个li元素</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(li);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> lis = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;ul li&quot;</span>); <span class="comment">// 获取所有li元素</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(lis);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; lis.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(lis[i])  <span class="comment">//每个li对象</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>其他获取 DOM 元素的方法</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据id获取第一个元素</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;nav&#x27;</span>);</span><br><span class="line"><span class="comment">// 根据标签获取一类元素，获取页面所有p标签</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;p&#x27;</span>);</span><br><span class="line"><span class="comment">// 根据类名获取元素，获取页面所有类名为box的标签</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;box&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="操作元素内容"><a href="#操作元素内容" class="headerlink" title="操作元素内容"></a>操作元素内容</h2><p>通过修改 DOM 的文本内容，动态改变网页的内容。</p>
<ol>
<li><code>innerText</code> 将文本内容添加&#x2F;更新到任意标签位置，<strong>文本中包含的标签不会被解析。</strong></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// innerText 将文本内容添加/更新到任意标签位置</span></span><br><span class="line"><span class="keyword">const</span> intro = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span><br><span class="line"><span class="comment">// intro.innerText = &#x27;我叫小明&#x27;</span></span><br><span class="line"><span class="comment">// intro.innerText = &#x27;&lt;h4&gt;我叫小明&lt;/h4&gt;&#x27;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>innerHTML</code> 将文本内容添加&#x2F;更新到任意标签位置，<strong>文本中包含的标签会被解析。</strong></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// innerHTML 将文本内容添加/更新到任意标签位置</span></span><br><span class="line"><span class="keyword">const</span> intro = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span><br><span class="line">intro.<span class="property">innerHTML</span> = <span class="string">&#x27;我叫小明&#x27;</span></span><br><span class="line">intro.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;h4&gt;我叫小明&lt;/h4&gt;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>总结：如果文本内容中包含 <code>html</code> 标签时推荐使用 <code>innerHTML</code>，否则建议使用 <code>innerText</code> 属性。</p>
<h2 id="操作元素属性"><a href="#操作元素属性" class="headerlink" title="操作元素属性"></a>操作元素属性</h2><p>操作元素属性包含<strong>元素常用属性、元素样式属性、表单元素属性和自定义属性</strong>。</p>
<h3 id="常用属性修改"><a href="#常用属性修改" class="headerlink" title="常用属性修改"></a>常用属性修改</h3><p>语法：<code>对象.属性 = 值</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 获取 img 对应的 DOM 元素</span></span><br><span class="line"><span class="keyword">const</span> pic = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.pic&#x27;</span>)</span><br><span class="line"><span class="comment">// 2. 修改属性</span></span><br><span class="line">pic.<span class="property">src</span> = <span class="string">&#x27;./images/lion.webp&#x27;</span></span><br><span class="line">pic.<span class="property">width</span> = <span class="number">400</span>;</span><br><span class="line">pic.<span class="property">alt</span> = <span class="string">&#x27;图片不见了...&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="样式属性修改"><a href="#样式属性修改" class="headerlink" title="样式属性修改"></a>样式属性修改</h3><h4 id="通过style属性操作CSS"><a href="#通过style属性操作CSS" class="headerlink" title="通过style属性操作CSS"></a>通过style属性操作CSS</h4><p>通过元素节点获得的 <code>style</code> 属性本身的数据类型也是对象，如 <code>box.style.color</code>、<code>box.style.width</code> 分别用来获取元素节点 CSS 样式的 <code>color</code> 和 <code>width</code> 的值。</p>
<p>语法：<code>对象.style.样式属性 = 值</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>随便一些文本内容<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取 DOM 节点</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;300px&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// css 属性的 - 连接符与JavaScript的 减运算符冲突，所以要改成驼峰法</span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;pink&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ol>
<li>DOM 对象的 <code>style</code> 属性可控制 <code>style</code> 行内样式，操作 CSS 属性需要遵循小驼峰命名</li>
<li>修改样式比较少的情况有优势</li>
<li>生成的是<strong>行内样式表</strong>，权重比较高</li>
</ol>
<h4 id="通过className操作CSS"><a href="#通过className操作CSS" class="headerlink" title="通过className操作CSS"></a>通过className操作CSS</h4><p>如果修改的样式比较多，直接通过 <code>style</code> 属性修改比较繁琐，我们可以通过借助于 css 类名的形式。</p>
<p>语法：<code>元素.className = &#39;CSS类名&#39;</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: blue;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.pink</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background</span>: pink;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: hotpink;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 获取 DOM 节点</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      box.<span class="property">className</span> = <span class="string">&quot;pink&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ol>
<li><p>由于 <code>class</code> 是关键字，所以使用 <code>className</code> 去代替</p>
</li>
<li><p><code>className</code> 是使用<strong>新值替换旧值</strong>，如果需要添加一个类，需要保留之前的类名</p>
</li>
</ol>
<h4 id="通过classList操作CSS"><a href="#通过classList操作CSS" class="headerlink" title="通过classList操作CSS"></a>通过classList操作CSS</h4><p>为了解决 <code>className</code> 容易覆盖以前的类名，我们可以通过 <code>classList</code> 方式追加和删除类名。</p>
<p>语法：</p>
<ol>
<li>追加：<code>元素.classList.add(&#39;类名&#39;)</code></li>
<li>删除：<code>元素.classList.remove(&#39;类名&#39;)</code></li>
<li>切换：<code>元素.classList.toggle(&#39;类名&#39;)</code></li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: blue;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.active</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: hotpink;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-left</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      box.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;active&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      box.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;active&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      box.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&quot;active&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="表单元素属性"><a href="#表单元素属性" class="headerlink" title="表单元素属性"></a>表单元素属性</h3><p>表单很多情况，也需要修改属性，比如点击眼睛，可以看到密码，本质是把表单类型转换为文本框。</p>
<p>正常的有属性有取值的跟其他的标签属性没有任何区别。</p>
<p>表单属性中添加有效果，移除没有效果，一律使用布尔值表示；比如<code>disabled</code>、<code>checked</code>、<code>selected</code>。</p>
<p>语法：<code>DOM对象.属性名 = 新值</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;请输入&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;cbox&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">//输入</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      input.<span class="property">value</span> = <span class="string">&quot;小明&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      input.<span class="property">type</span> = <span class="string">&quot;password&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">//复选框</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> checkbox = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.cbox&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      checkbox.<span class="property">checked</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">//按钮</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.btn&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      btn.<span class="property">disabled</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="自定义属性"><a href="#自定义属性" class="headerlink" title="自定义属性"></a>自定义属性</h3><p><strong>标准属性</strong>：标签天生自带的属性 比如 <code>class</code> <code>id</code> <code>title</code> 等。</p>
<p><strong>自定义属性</strong>：</p>
<ol>
<li>在 HTML5 中推出来了专门的 <code>data-</code> 自定义属性  </li>
<li>在标签上一律以 <code>data-</code> 开头</li>
<li>在 DOM 对象上一律以 <code>dataset</code> 对象方式获取</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">data-id</span>=<span class="string">&quot;1&quot;</span>&gt;</span>自定义属性<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 1. 获取元素</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;div&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 2. 获取自定义属性值</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="property">dataset</span>.<span class="property">id</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="DOM事件基础"><a href="#DOM事件基础" class="headerlink" title="DOM事件基础"></a>DOM事件基础</h1><h2 id="事件监听"><a href="#事件监听" class="headerlink" title="事件监听"></a>事件监听</h2><ul>
<li>什么是事件？<ol>
<li>事件是编程语言中的术语，它是用来描述程序的行为或状态的</li>
<li>例如：用户使用鼠标点击网页中的一个按钮、用户使用鼠标拖拽网页中的一张图片</li>
</ol>
</li>
<li>什么是事件监听？<ol>
<li>事件监听就是让程序检测是否有事件产生，一旦行为或状态发生改变，便立即调用一个函数做出响应，也称为绑定事件或注册事件</li>
<li>比如鼠标经过显示下拉菜单，鼠标点击后可以播放轮播图</li>
</ol>
</li>
</ul>
<p>结合 DOM 使用事件时，需要为 DOM 对象<strong>添加事件监听</strong>，<strong>等待事件发生</strong>（触发）时，便<strong>立即调用一个函数</strong>。</p>
<p>语法：<code>元素对象.addEventListener(&#39;事件类型&#39;, 事件回调)</code></p>
<p>事件监听三要素：</p>
<ol>
<li>事件源：那个 DOM 元素被事件触发了</li>
<li>事件类型：用什么方式触发，比如鼠标点击 click、鼠标经过 mouseover</li>
<li>事件回调函数：要做什么事</li>
</ol>
<p>事件监听版本</p>
<ol>
<li>DOM L0：事件源.on事件 &#x3D; function() {}</li>
<li>DOM L2：事件源.addEventListener(事件，事件回调)</li>
<li>区别：on 方式会被覆盖，addEventListener 方式可绑定多次，拥有事件多种特性</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.btn&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      btn.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&quot;按钮被点击&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="事件类型"><a href="#事件类型" class="headerlink" title="事件类型"></a>事件类型</h2><p>将众多的事件类型分类可分为：鼠标事件、键盘事件、表单事件、焦点事件等，我们逐一展开学习。</p>
<ol>
<li><p>鼠标事件：鼠标触发</p>
<ol>
<li><code>click</code>：鼠标点击</li>
<li><code>mouseenter</code>：鼠标经过</li>
<li><code>mouseleave</code>：鼠标离开</li>
</ol>
</li>
<li><p>键盘事件：键盘触发</p>
<ol>
<li><code>keydown</code> ：键盘按下触发</li>
<li><code>keyup</code> ：键盘抬起触发</li>
</ol>
</li>
<li><p>焦点事件：表单获得光标</p>
<ol>
<li><code>focus</code> ：获得焦点</li>
<li><code>blur</code>：失去焦点</li>
</ol>
</li>
<li><p>文本框输入事件：表单输入触发</p>
<ol>
<li><code>input</code> ：输入框的值发生变化</li>
<li><code>submit</code>：表单数据向服务器提交</li>
<li><code>reset</code>：表单重置（所有表单成员变回默认值）</li>
</ol>
</li>
</ol>
<h2 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h2><p>任意事件类型被触发时与事件相关的信息会被以对象的形式记录下来，我们称这个对象为事件对象。</p>
<p>事件回调函数的<strong>第一个参数</strong>即所谓的事件对象，可以命名为 <code>event</code> 。</p>
<p>接下来简单看一下事件对象中包含了哪些有用的信息：</p>
<ol>
<li><code>event.type</code>：当前事件的类型</li>
<li><code>event.clientX/Y</code>：光标相对浏览器窗口的位置</li>
<li><code>event.offsetX/Y</code> ：光标相于当前 DOM 元素的位置</li>
<li><code>event.key</code>：键盘按下的值</li>
</ol>
<p>注：在事件回调函数内部通过 <code>window.event</code> 同样可以获取事件对象。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      input.<span class="title function_">addEventListener</span>(<span class="string">&quot;keyup&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (e.<span class="property">key</span> === <span class="string">&quot;Enter&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Press Enter&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="环境对象"><a href="#环境对象" class="headerlink" title="环境对象"></a>环境对象</h2><p>环境对象指的是函数内部特殊的变量 <code>this</code> ，它代表着当前函数运行时所处的环境。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// this 是一个变量</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明一个对象</span></span><br><span class="line"><span class="keyword">let</span> user = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;张三&#x27;</span>,</span><br><span class="line">    <span class="attr">sayHi</span>: sayHi <span class="comment">// 此处把 sayHi 函数，赋值给 sayHi 属性</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接调用</span></span><br><span class="line"><span class="title function_">sayHi</span>() <span class="comment">// window</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">sayHi</span>() <span class="comment">// window</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 做为对象方法调用</span></span><br><span class="line">user.<span class="title function_">sayHi</span>()  <span class="comment">// user</span></span><br></pre></td></tr></table></figure>

<p>结论：</p>
<ol>
<li><code>this</code> 本质上是一个变量，数据类型为对象</li>
<li>函数的调用方式不同 <code>this</code> 变量的值也不同</li>
<li>谁调用 <code>this</code> 就是指向谁，是判断 <code>this</code> 值的粗略规则</li>
<li>函数直接调用时实际上 <code>window.sayHi()</code> 所以 <code>this</code> 的值为 <code>window</code></li>
</ol>
<h1 id="DOM事件进阶"><a href="#DOM事件进阶" class="headerlink" title="DOM事件进阶"></a>DOM事件进阶</h1><h2 id="事件流"><a href="#事件流" class="headerlink" title="事件流"></a>事件流</h2><p>事件流指的是事件完整执行过程中的流动路径。</p>
<p>事件流只会在父子元素具有相同事件类型时才会产生影响。</p>
<img src="/2024/01/05/WebAPIs/event.png" alt="事件流" style="zoom:60%;">

<p>如上图所示，任意事件被触发时总会经历两个阶段：<strong>捕获阶段和冒泡阶段</strong>。</p>
<p>简言之，捕获阶段是从父到子的传导过程，冒泡阶段是从子向父的传导过程。</p>
<h3 id="事件捕获和冒泡"><a href="#事件捕获和冒泡" class="headerlink" title="事件捕获和冒泡"></a>事件捕获和冒泡</h3><p>捕获概念：从 DOM 的根元素开始去执行对应的事件（从外到里）。</p>
<p>冒泡概念：当一个元素的事件被触发时，同样的事件将会在该元素的所有祖先元素中依次触发。</p>
<p>语法：<code>元素.addEventListener(事件类型, 事件回调, 是否使用捕获机制)</code></p>
<ol>
<li>第三个参数默认是 false，代表冒泡阶段触发；true 代表捕获阶段触发</li>
<li>若使用 L0 事件监听，则只有冒泡阶段，没有捕获阶段</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: blue;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// html 元素添加事件</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">addEventListener</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;click&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">alert</span>(<span class="string">&quot;html...&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">      );</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// body 元素添加事件</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">addEventListener</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;click&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">alert</span>(<span class="string">&quot;body...&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">      );</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 盒子添加事件</span></span></span><br><span class="line"><span class="language-javascript">      box.<span class="title function_">addEventListener</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;click&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">alert</span>(<span class="string">&quot;box...&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">      );</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="阻止冒泡"><a href="#阻止冒泡" class="headerlink" title="阻止冒泡"></a>阻止冒泡</h3><p>阻止冒泡是指阻断事件的流动，保证事件只在当前元素被执行，而不再去影响到其对应的祖先元素。</p>
<p>语法：<code>事件对象.stopPropagetion()</code></p>
<p>注意：此方法可以阻断事件的传播，不光在冒泡阶段有效，捕获阶段也有效。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: blue;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// html 元素添加事件</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&quot;html...&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// body 元素添加事件</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&quot;body...&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 盒子添加事件</span></span></span><br><span class="line"><span class="language-javascript">      box.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        e.<span class="title function_">stopPropagation</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&quot;box...&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>补充：鼠标经过事件</p>
<blockquote>
<p>mouseover 和 mouseout 会有冒泡效果</p>
<p>mouseenter 和 mouseleave 没有冒泡效果 (推荐)</p>
</blockquote>
<p>补充：阻止元素默认行为</p>
<p>某些情况下需要阻止默认元素行为，比如阻止链接跳转，表单域跳转。</p>
<p>语法：<code>事件对象.preventDefault()</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://www.baidu.com&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;跳转&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> form = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;form&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      form.<span class="title function_">addEventListener</span>(<span class="string">&quot;submit&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="解绑事件"><a href="#解绑事件" class="headerlink" title="解绑事件"></a>解绑事件</h3><ol>
<li>on 事件写法，直接使用 <code>null</code> 覆盖就可以解绑事件。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解绑事件</span></span><br><span class="line">btn.<span class="property">onclick</span> = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>addEventListener</code> 方式，必须使用 <code>removeEventListener</code> 函数。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">click</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;click&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, click);</span><br><span class="line"><span class="comment">//解绑事件</span></span><br><span class="line">btn.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;click&#x27;</span>, click);</span><br></pre></td></tr></table></figure>

<p>注意：匿名函数无法解除绑定。</p>
<h2 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h2><p>事件委托是利用事件流的特征解决一些现实开发需求的知识技巧，主要的作用是提升程序效率。</p>
<p>优点：减少注册次数，可以提高程序性能</p>
<p>原理：事件委托其实是利用事件冒泡特点，给父元素注册事件，当我们触发子元素的是时候，会冒泡到父元素上，从而触发父元素的事件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>p标签<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;ul&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      ul.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//this.style.color = &quot;red&quot;;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// target 是点击对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">tagName</span> === <span class="string">&quot;LI&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          e.<span class="property">target</span>.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;red&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>事件对象中的属性 <code>target</code> 或 <code>srcElement</code>属性表示真正触发事件的元素，它是一个元素类型的节点。</p>
<h2 id="其他事件"><a href="#其他事件" class="headerlink" title="其他事件"></a>其他事件</h2><h3 id="页面加载事件"><a href="#页面加载事件" class="headerlink" title="页面加载事件"></a>页面加载事件</h3><p>加载外部资源（如图片、外联 CSS 和 JavaScript 等）加载完毕时触发的事件。</p>
<p>有些时候需要等页面资源全部处理完了做一些事情。</p>
<p>老代码喜欢把 <code>script</code> 写在 <code>head</code> 中，这时候直接找 DOM 元素找不到。</p>
<p><strong>事件名：load</strong></p>
<p>监听页面所有资源加载完毕：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// xxxxx</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>注意：不光可以监听整个页面资源加载完毕，也可以针对某个资源绑定 <code>load</code> 事件。</p>
<p><strong>事件名：DOMContentLoaded</strong></p>
<p>当初始的 HTML 文档被完全加载解析完成之后，<code>DOMContentLoaded</code> 事件被触发，而无需等待样式表、图像等完全加载完毕。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// xxxxx</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="页面滚动事件"><a href="#页面滚动事件" class="headerlink" title="页面滚动事件"></a>页面滚动事件</h3><p>滚动条在滚动的时候持续触发的事件。</p>
<p>很多网页需要检测用户把页面滚动到某个区域后做一些处理，比如固定导航栏，比如返回顶部。</p>
<p><strong>事件名：scroll</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// xxxxx</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>使用 <code>windows</code> 对象或者 <code>document</code> 添加都可以。</p>
<p>注意：不光可以监听整个页面滚动，也可以针对某个资源绑定 <code>scroll</code> 事件。</p>
<p><strong>获取标签位置属性：</strong></p>
<ol>
<li><code>scrollLeft</code> 和 <code>scrollTop</code></li>
<li>获取被卷去的大小</li>
<li>获取元素内容往左、往上滚出去看不到的距离</li>
<li>获取的值是可以读写的，是数值型的</li>
</ol>
<p>在 <code>scroll</code> 事件里面获取被卷去的距离，才会实时更新</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="页面尺寸事件"><a href="#页面尺寸事件" class="headerlink" title="页面尺寸事件"></a>页面尺寸事件</h3><p>会在窗口尺寸改变的时候触发事件。</p>
<p><strong>事件名：resize</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// xxxxx</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>获取屏幕宽高：</strong></p>
<ol>
<li><code>clientWidth</code> 和 <code>clientHeight</code></li>
<li>获得可视区域宽高</li>
<li>不包含边框</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>补充：元素尺寸与位置</strong></p>
<p>使用场景：通过 JavaScript 的方式，得到元素在页面中的位置</p>
<p>获取宽高：</p>
<ol>
<li><code>offsetWidth</code> 和 <code>offsetHeight</code></li>
<li>获取元素的自身宽高、包含元素自身设置的宽高、<code>padding</code>、<code>border</code></li>
<li>获取的是数值型的</li>
</ol>
<p>获取位置：</p>
<ol>
<li><code>offsetLeft</code> 和 <code>offsetTop</code> </li>
<li>获取元素距离自己<strong>定位父级</strong>（CSS 设置 <code>position: relative</code> 属性）元素的左、上距离</li>
<li>注意是只读属性</li>
</ol>
<h2 id="移动端事件"><a href="#移动端事件" class="headerlink" title="移动端事件"></a>移动端事件</h2><p>移动端有独特的地方，不如触屏事件。</p>
<table>
<thead>
<tr>
<th>事件名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>touchstart</td>
<td>手指触摸到一个 DOM 元素时触发</td>
</tr>
<tr>
<td>touchmove</td>
<td>手指在一个 DOM 元素上滑动时触发</td>
</tr>
<tr>
<td>touchend</td>
<td>手指从一个 DOM 元素离开时触发</td>
</tr>
</tbody></table>
<h1 id="DOM操作节点"><a href="#DOM操作节点" class="headerlink" title="DOM操作节点"></a>DOM操作节点</h1><p>回顾之前 DOM 的操作都是针对元素节点的属性或文本的，除此之外也有专门针对元素节点本身的操作，如插入、复制、删除、替换等。</p>
<p>DOM 节点：DOM 树里每一个内容都称之为节点。</p>
<p>节点类型：</p>
<ol>
<li><strong>元素节点</strong>：所有的标签，比如 html、body、div 等（重点）</li>
<li>属性节点：所有的属性，比如 herf</li>
<li>文本节点：所有的文本</li>
<li>其他</li>
</ol>
<h2 id="查找节点"><a href="#查找节点" class="headerlink" title="查找节点"></a>查找节点</h2><p>DOM 树中的任意节点都不是孤立存在的，它们要么是父子关系，要么是兄弟关系，不仅如此，我们可以<strong>依据节点之间的关系查找节点</strong>。</p>
<p><strong>父节点查找</strong></p>
<ol>
<li><code>parentNode</code> 属性</li>
<li>返回最近一级的父节点，找不到返回 <code>null</code></li>
</ol>
<p><strong>子节点查找</strong></p>
<ol>
<li><code>childNodes</code> 属性：获取所有子节点、包括文本节点（空格、换行）、注释节点等</li>
<li><code>children</code> 属性：仅获得最近一级的所有元素子节点，返回的是一个伪数组</li>
</ol>
<p><strong>兄弟节点查找</strong></p>
<ol>
<li>下一个兄弟节点：<code>nextElementSibling</code> 属性</li>
<li>上一个兄弟节点：<code>previousElementSibling</code> 属性</li>
</ol>
<h2 id="增加节点"><a href="#增加节点" class="headerlink" title="增加节点"></a>增加节点</h2><p>在已有的 DOM 节点中插入新的 DOM 节点时，需要关注两个关键因素：首先要得到新的 DOM 节点，其次在哪个位置插入这个节点。</p>
<ol>
<li>创建节点：<code>var 新节点 = document.createElement(&#39;标签名&#39;)</code></li>
<li>追加节点：<ol>
<li>插入到父元素的最后一个子元素：<code>父元素.appendChild(新元素)</code></li>
<li>插入到父元素的某个子元素前面：<code>父元素.insertBefore(新元素, 旧元素)</code></li>
</ol>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>第一个li标签<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;ul&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;li&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      li.<span class="property">innerHTML</span> = <span class="string">&quot;第二个li标签&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">//插入到父元素的最后一个子元素</span></span></span><br><span class="line"><span class="language-javascript">      ul.<span class="title function_">appendChild</span>(li);</span></span><br><span class="line"><span class="language-javascript">             </span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> li2 = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;li&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      li2.<span class="property">innerHTML</span> = <span class="string">&quot;第零个li标签&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">//插入到父元素的某个子元素前面</span></span></span><br><span class="line"><span class="language-javascript">      ul.<span class="title function_">insertBefore</span>(li2, ul.<span class="property">children</span>[<span class="number">0</span>]);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>特殊情况下，克隆节点需要使用：</p>
<ol>
<li><code>var 克隆元素 = 元素.cloneNode(布尔值)</code></li>
<li>布尔值为 true 代表克隆会包含后代节点，否则不会克隆后代节点，默认为 false。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>第一个li标签<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>第二个li标签<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;ul&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      ul.<span class="title function_">appendChild</span>(ul.<span class="property">children</span>[<span class="number">0</span>].<span class="title function_">cloneNode</span>(<span class="literal">true</span>));</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="删除节点"><a href="#删除节点" class="headerlink" title="删除节点"></a>删除节点</h2><p>删除现有的 DOM 节点，也需要关注两个因素：首先由父节点删除子节点，其次是要删除哪个子节点。</p>
<p>删除节点：<code>父元素.removeChild(待删除元素)</code></p>
<p>注意：</p>
<ol>
<li>要删除元素必须通过<strong>父元素删除</strong></li>
<li>如果不存在父子关系则删除失败</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>第一个li标签<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>第二个li标签<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> ul = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;ul&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      ul.<span class="title function_">removeChild</span>(ul.<span class="property">children</span>[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>结论：<code>removeChild</code> 删除节点时一定是由父子关系。</p>
<h1 id="Window对象"><a href="#Window对象" class="headerlink" title="Window对象"></a>Window对象</h1><p>BOM（Browser Object Model）是浏览器对象模型。</p>
<ol>
<li>window 对象是一个全局对象，也可以说是 JavaScript 中的顶级对象</li>
<li>像 document、alert()、console.log() 这些都是 window 的属性，基本 BOM 的属性和方法都是 window 的</li>
<li>所有通过 var 定义在全局作用域中的变量、函数都会变成 window 对象的属性和方法</li>
<li>window 对象下的属性和方法调用的时候可以省略 window</li>
</ol>
<img src="/2024/01/05/WebAPIs/BOM对象模型.png" alt="BOM对象模型" style="zoom:90%;">

<h2 id="JS执行机制"><a href="#JS执行机制" class="headerlink" title="JS执行机制"></a>JS执行机制</h2><p>JavaScript 语言的一大特点就是单线程，也就是说，同一个时间只能做一件事。</p>
<p>这是因为 JavaScript 这门脚本语言诞生的使命所致——JavaScript 是为处理页面中用户的交互，以及操作DOM 而诞生的。比如我们对某个 DOM 元素进行添加和删除操作，不能同时进行。应该先进行添加之后再删除。</p>
<p>单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。这样所导致的问题是：如果 JavaScript 执行的时间过长，这样就会造成页面的渲染不连贯，导致页面渲染加载阻塞的感觉。</p>
<p>为了解决这个问题，利用多核 CPU 的计算能力，HTML5 提出 Web Worker 标准，允许 JavaScript 脚本创建多个线程。于是，JavaScript 中出现了同步和异步。</p>
<p><strong>同步任务</strong></p>
<p>同步任务都在主线程上执行，形成一个执行栈。</p>
<p><strong>异步任务</strong></p>
<p>JavaScript 的异步是通过回调函数实现的。</p>
<p>一般而言，异步任务有以下三种类型：</p>
<ol>
<li>﻿﻿普通事件，如 click、resize 等</li>
<li>﻿﻿资源加载，如 load、error 等</li>
<li>﻿﻿定时器，包括 setlnterval、setTimeout 等</li>
</ol>
<p>异步任务相关添加到任务队列中（任务队列也称为消息队列）。</p>
<p><strong>执行机制</strong></p>
<pre class="mermaid">graph LR
    S(开始)-->M1(执行栈)
    M1--提交异步任务-->M2(异步进程模块)
    M2--处理完毕-->M3(任务队列)
    M1--查询获取任务-->M3</pre>

<p>执行栈是在 JavaScript 主线程中执行，当执行栈中有异步任务，会提交给对应的异步进程（ajax、DOM 事件、timer 模块）处理（提供 Web API 由浏览器多进程处理），异步任务处理完毕后，会推入对应的任务队列中，待由主线程取出任务，推入 JavaScript 主线程处理。</p>
<p>由于主线程不断的重复获得任务、执行任务、再获取任务、再执行，所以这种机制被称为<strong>事件循环</strong>（event loop）。</p>
<h2 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h2><h3 id="间歇函数"><a href="#间歇函数" class="headerlink" title="间歇函数"></a>间歇函数</h3><p>网页中经常需要一种功能：每隔一段时间自动执行一段代码，不需要我们手动去触发。</p>
<p>语法：</p>
<ol>
<li>设置：<code>var ID = setInterval(定时回调, 毫秒时间)</code></li>
<li>清除：<code>clearInterval(ID)</code></li>
</ol>
<p><code>setInterval</code> 是 JavaScript 中内置的函数，它的作用是间隔固定的时间自动重复执行另一个函数，也叫定时器函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义一个普通函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">repeat</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;不知疲倦的执行下去....&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 使用 setInterval 调用 repeat 函数</span></span><br><span class="line"><span class="comment">// 间隔 1000 毫秒，重复调用 repeat，返回值是一个 id 数字</span></span><br><span class="line"><span class="keyword">let</span> id = <span class="built_in">setInterval</span>(repeat, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 关闭定时器</span></span><br><span class="line"><span class="built_in">clearInterval</span>(id);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 重新开启定时器</span></span><br><span class="line">id = <span class="built_in">setInterval</span>(repeat, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<h3 id="延时函数"><a href="#延时函数" class="headerlink" title="延时函数"></a>延时函数</h3><p>如果需要某个函数延迟一段时间后只执行一次，需要用到延时函数。</p>
<p>语法：</p>
<ol>
<li>设置：<code>var ID = setTimeout(回调函数, 延迟时间)</code></li>
<li>清除：<code>clearTimeout(ID)</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 开启延迟函数</span></span><br><span class="line"><span class="keyword">let</span> timerId = <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我只执行一次&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">3000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 关闭延迟函数</span></span><br><span class="line"><span class="built_in">clearTimeout</span>(timerId)</span><br></pre></td></tr></table></figure>

<h2 id="location对象"><a href="#location对象" class="headerlink" title="location对象"></a>location对象</h2><p>location 对象拆分并保存了 URL 地址的各个组成部分。</p>
<table>
<thead>
<tr>
<th>属性&#x2F;方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>href</td>
<td>属性，获取完整的 URL 地址，赋值时用于地址的跳转</td>
</tr>
<tr>
<td>search</td>
<td>属性，获取地址中携带的参数，符号 ？后面部分</td>
</tr>
<tr>
<td>hash</td>
<td>属性，获取地址中的啥希值，符号 # 后面部分</td>
</tr>
<tr>
<td>reload()</td>
<td>方法，用来刷新当前页面，传入参数 true 时表示强制刷新</td>
</tr>
</tbody></table>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;search&quot;</span> /&gt;</span> <span class="tag">&lt;<span class="name">button</span>&gt;</span>搜索<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/music&quot;</span>&gt;</span>音乐<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#/download&quot;</span>&gt;</span>下载<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;reload&quot;</span>&gt;</span>刷新页面<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// location 对象</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 1. href属性 （重点） 得到完整地址，赋值则是跳转到新地址</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">href</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// location.href = &#x27;http://www.itcast.cn&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 2. search属性  得到 ? 后面的地址</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">search</span>); <span class="comment">// ?search=笔记本</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 3. hash属性  得到 # 后面的地址</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(location.<span class="property">hash</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 4. reload 方法  刷新页面</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.reload&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      btn.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// location.reload() // 页面刷新</span></span></span><br><span class="line"><span class="language-javascript">        location.<span class="title function_">reload</span>(<span class="literal">true</span>); <span class="comment">// 强制页面刷新 ctrl+f5</span></span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="navigator对象"><a href="#navigator对象" class="headerlink" title="navigator对象"></a>navigator对象</h2><p>navigator 对象记录了浏览器自身的相关信息。</p>
<p>常用属性和方法：</p>
<ul>
<li>通过 <code>userAgent</code> 检测浏览器的版本及平台</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 检测 userAgent（浏览器信息）</span></span></span><br><span class="line"><span class="language-javascript">      !(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> userAgent = navigator.<span class="property">userAgent</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 验证是否为Android或iPhone</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> android = userAgent.<span class="title function_">match</span>(<span class="regexp">/(Android);?[\s\/]+([\d.]+)?/</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> iphone = userAgent.<span class="title function_">match</span>(<span class="regexp">/(iPhone\sOS)\s([\d_]+)/</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 如果是Android或iPhone，则跳转至移动站点</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (android || iphone) &#123;</span></span><br><span class="line"><span class="language-javascript">          location.<span class="property">href</span> = <span class="string">&quot;http://www.baidu.com&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)();</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    PC页面</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="histroy对象"><a href="#histroy对象" class="headerlink" title="histroy对象"></a>histroy对象</h2><p>history 对象主要管理历史记录， 该对象与浏览器地址栏的操作相对应，如前进、后退等。</p>
<table>
<thead>
<tr>
<th>history 对象方法</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>back()</td>
<td>后退功能</td>
</tr>
<tr>
<td>forward()</td>
<td>前进功能</td>
</tr>
<tr>
<td>go(参数)</td>
<td>前进后退功能 <br>参数 1：前进一个页面，参数 -1：后退一个页面</td>
</tr>
</tbody></table>
<h2 id="本地存储"><a href="#本地存储" class="headerlink" title="本地存储"></a>本地存储</h2><p>本地存储：将数据存储在本地浏览器中。</p>
<p>常见的使用场景：</p>
<p><a target="_blank" rel="noopener" href="https://todomvc.com/examples/vanilla-es6/">https://todomvc.com/examples/vanilla-es6/</a>    页面刷新数据不丢失</p>
<p>好处：</p>
<p>1、页面刷新或者关闭不丢失数据，实现数据持久化</p>
<p>2、容量较大，sessionStorage 和 localStorage 约 5M 左右</p>
<h3 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h3><p>作用： 数据可以<strong>长期保留</strong>在本地浏览器中，刷新页面和关闭页面，数据也不会丢失。</p>
<p>特性：可以多窗口（页面）共享（同一浏览器可以共享），以键值对的形式存储，并且存储的是<strong>字符串</strong>， 省略了 window。</p>
<p>语法：</p>
<ol>
<li>增加&#x2F;修改数据：<code>localStorage.setItem(key, value)</code></li>
<li>查询数据：<code>localStorage.getItem(key)</code></li>
<li>删除数据：<code>localStorage.removeItem(key)</code></li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// localstorage 存储的是字符串 </span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 1. 存储</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;age&#x27;</span>, <span class="number">18</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 2. 获取</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;age&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 3. 删除</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;age&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="sessionStorage"><a href="#sessionStorage" class="headerlink" title="sessionStorage"></a>sessionStorage</h3><p>特性：</p>
<ol>
<li>关闭浏览器窗口数据会被清除</li>
<li>同一个窗口（页面）下数据可以共享</li>
<li>以键值对的形式存储</li>
<li>用法跟 localStorage 基本相同</li>
</ol>
<p>语法：</p>
<ol>
<li>存储：<code>sessionStorage.setItem(key,value)</code></li>
<li>获取：<code>sessionStorage.getItem(key)</code></li>
<li>删除：<code>sessionStorage.removeItem(key)</code></li>
</ol>
<h3 id="存储复杂数据类型"><a href="#存储复杂数据类型" class="headerlink" title="存储复杂数据类型"></a>存储复杂数据类型</h3><p>问题：本地只能存储字符串，无法存储复杂数据类型。</p>
<p>解决：需要将复杂数据类型转换成 JSON 字符串，在存储到本地。</p>
<p>语法：<code>JSON.stringify(复杂数据类型)</code></p>
<p>JSON字符串：</p>
<ul>
<li>属性名使用双引号引起来，不能单引号</li>
<li>属性值如果是字符串型也必须双引号</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 本地存储复杂数据类型</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> goods = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&quot;手机&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">price</span>: <span class="number">1999</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// localStorage.setItem(&#x27;goods&#x27;, goods);</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// console.log(localStorage.getItem(&#x27;goods&#x27;));</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 1. 把对象转换为JSON字符串  JSON.stringify</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;goods&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(goods));</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;goods&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>问题：因为本地存储里面取出来的是字符串，不是对象，无法直接使用</p>
<p>解决： 把取出来的字符串转换为对象</p>
<p>语法：<code>JSON.parse(JSON字符串)</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 本地存储复杂数据类型</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> goods = &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&quot;手机&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">price</span>: <span class="number">1999</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 1. 把对象转换为JSON字符串  JSON.stringify</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;goods&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(goods));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 2. 把JSON字符串转换为对象  JSON.parse</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;goods&quot;</span>)));</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2023/12/30/JavaScript%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/12/30/JavaScript%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">JavaScript基础</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-12-30 22:06:13" itemprop="dateCreated datePublished" datetime="2023-12-30T22:06:13+08:00">2023-12-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-16 18:50:19" itemprop="dateModified" datetime="2024-01-16T18:50:19+08:00">2024-01-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>MDN Web Docs：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/">https://developer.mozilla.org/zh-CN/</a></p>
<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><blockquote>
<p>掌握 JavaScript 的引入方式，初步认识 JavaScript 的作用</p>
</blockquote>
<h2 id="引入方式"><a href="#引入方式" class="headerlink" title="引入方式"></a>引入方式</h2><p>JavaScript 程序不能独立运行，它需要被嵌入 HTML 中，然后浏览器才能执行 JavaScript 代码。通过 <code>script</code> 标签将 JavaScript 代码引入到 HTML 中，有两种方式：</p>
<h3 id="内部方式"><a href="#内部方式" class="headerlink" title="内部方式"></a>内部方式</h3><p>通过 <code>script</code> 标签包裹 JavaScript 代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 引入方式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 内联形式：通过 script 标签包裹 JavaScript 代码 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&quot;hello JavaScript!&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="外部形式"><a href="#外部形式" class="headerlink" title="外部形式"></a>外部形式</h3><p>一般将 JavaScript 代码写在独立的以 .js 结尾的文件中，然后通过 <code>script</code> 标签的 <code>src</code> 属性引入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo.js</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;hello JavaScript!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 引入方式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 外部形式：通过 script 的 src 属性引入独立的 .js 文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;demo.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果 script 标签使用 src 属性引入了某 .js 文件，那么标签的代码会被忽略！！！如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 引入方式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 外部形式：通过 script 的 src 属性引入独立的 .js 文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;demo.js&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">       <span class="comment">// 此处的代码会被忽略掉！！！！</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="number">666</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="注释和结束符"><a href="#注释和结束符" class="headerlink" title="注释和结束符"></a>注释和结束符</h2><p>通过注释可以屏蔽代码被执行或者添加备注信息，JavaScript 支持两种形式注释语法：</p>
<h3 id="单行注释"><a href="#单行注释" class="headerlink" title="单行注释"></a>单行注释</h3><p>使用 <code>// </code> 注释单行代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 注释<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 这种是单行注释的语法</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 一次只能注释一行</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 可以重复注释</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;Hello JavaScript!&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="多行注释"><a href="#多行注释" class="headerlink" title="多行注释"></a>多行注释</h3><p>使用 <code>/* */</code> 注释多行代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 注释<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">/* 这种的是多行注释的语法 */</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    	更常见的多行注释是这种写法</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    	在些可以任意换行</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    	多少行都可以</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">      */</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;Hello JavaScript!&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>注：编辑器中单行注释的快捷键为 <code>ctrl + /</code></strong></p>
<h3 id="结束符"><a href="#结束符" class="headerlink" title="结束符"></a>结束符</h3><p>在 JavaScript 中 <code>;</code> 代表一段代码的结束，多数情况下可以省略 <code>;</code> 使用回车（enter）替代。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 结束符<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">      alert(1);</span><br><span class="line">      alert(2);</span><br><span class="line">      alert(1)</span><br><span class="line">      alert(2)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>实际开发中有许多人主张书写 JavaScript 代码时省略结束符 <code>;</code></p>
<h2 id="输入和输出"><a href="#输入和输出" class="headerlink" title="输入和输出"></a>输入和输出</h2><p>输出和输入也可理解为人和计算机的交互，用户通过键盘、鼠标等向计算机输入信息，计算机处理后再展示结果给用户，这便是一次输入和输出的过程。</p>
<p>举例说明：如按键盘上的方向键，向上&#x2F;下键可以滚动页面，按向上&#x2F;下键这个动作叫作输入，页面发生了滚动了这便叫输出。</p>
<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><p>JavaScript 可以接收用户的输入，然后再将输入的结果输出：</p>
<p><code>alert()</code>、<code>document.wirte()</code></p>
<p>以数字为例，向 <code>alert()</code> 或 <code>document.write()</code>输入任意数字，他都会以弹窗形式展示（输出）给用户。</p>
<h3 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h3><p>向 <code>prompt()</code> 输入任意内容会以弹窗形式出现在浏览器中，一般提示用户输入一些内容。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 输入输出<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 1. 输入的任意数字，都会以弹窗形式展示</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;要输出的内容&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;要输出的内容&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 2. 以弹窗形式提示用户输入姓名，注意这里的文字使用英文的引号</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">prompt</span>(<span class="string">&#x27;请输入您的姓名:&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="变量和常量"><a href="#变量和常量" class="headerlink" title="变量和常量"></a>变量和常量</h1><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><blockquote>
<p>理解变量是计算机存储数据的“容器”，掌握变量的声明方式</p>
</blockquote>
<p>变量是计算机中用来存储数据的“容器”，它可以让计算机变得有记忆，通俗的理解变量就是使用【某个符号】来代表【某个具体的数值】（数据）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// x 符号代表了 5 这个数值</span></span></span><br><span class="line"><span class="language-javascript">  x = <span class="number">5</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// y 符号代表了 6 这个数值</span></span></span><br><span class="line"><span class="language-javascript">  y = <span class="number">6</span></span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//举例： 在 JavaScript 中使用变量可以将某个数据（数值）记录下来！</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 将用户输入的内容保存在 num 这个变量（容器）中</span></span></span><br><span class="line"><span class="language-javascript">  num = <span class="title function_">prompt</span>(<span class="string">&#x27;请输入一数字!&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 通过 num 变量（容器）将用户输入的内容输出出来</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(num)</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="title function_">write</span>(num)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h3><p>声明（定义）变量有两部分构成：声明关键字、变量名（标识）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 声明和赋值<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// let 变量名</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 声明(定义)变量有两部分构成：声明关键字、变量名（标识）</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// let 即关键字，所谓关键字是系统提供的专门用来声明（定义）变量的词语</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// age 即变量的名称，也叫标识符</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> age;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>关键字是 JavaScript 中内置的一些英文词汇（单词或缩写），它们代表某些特定的含义，如 <code>let</code> 的含义是声明变量的，看到 <code>let</code>  后就可想到这行代码的意思是在声明变量，如 <code>let age;</code> </p>
<p><code>let</code> 和 <code>var</code> 都是 JavaScript 中的声明变量的关键字，推荐使用 <code>let</code> 声明变量！！！</p>
<h3 id="变量赋值"><a href="#变量赋值" class="headerlink" title="变量赋值"></a>变量赋值</h3><p>声明（定义）变量相当于创造了一个空的“容器”，通过赋值向这个容器中添加数据。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 声明和赋值<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 声明(定义)变量有两部分构成：声明关键字、变量名（标识）</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// let 即关键字，所谓关键字是系统提供的专门用来声明（定义）变量的词语</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// age 即变量的名称，也叫标识符</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> age;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 赋值，将 18 这个数据存入了 age 这个“容器”中</span></span></span><br><span class="line"><span class="language-javascript">      age = <span class="number">18</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 这样 age 的值就成了 18</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="title function_">write</span>(age);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 也可以声明和赋值同时进行</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> str = <span class="string">&quot;hello world!&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(str);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h3><p>JavaScript 使用专门的关键字 <code>let</code> 和 <code>var</code> 来声明（定义）变量，在使用时需要注意一些细节：</p>
<p>以下是使用 <code>let</code> 时的注意事项：</p>
<ol>
<li>允许声明和赋值同时进行</li>
<li>不允许重复声明</li>
<li>允许同时声明多个变量并赋值</li>
<li>JavaScript 中内置的一些关键字不能被当做变量名</li>
</ol>
<p>以下是使用 <code>var</code> 时的注意事项：</p>
<ol start="2">
<li>允许声明和赋值同时进行</li>
<li>允许重复声明</li>
<li>允许同时声明多个变量并赋值</li>
</ol>
<p>大部分情况使用 <code>let</code> 和 <code>var</code> 区别不大，但是 <code>let</code> 相较 <code>var</code> 更严谨，因此推荐使用 <code>let</code>，后期会更进一步介绍二者间的区别。</p>
<h3 id="命名规则"><a href="#命名规则" class="headerlink" title="命名规则"></a>命名规则</h3><p>关于变量的名称（标识符）有一系列的规则需要遵守：</p>
<ol>
<li>只能是字母、数字、下划线、$，且不能能数字开头</li>
<li>字母区分大小写，如 Age 和 age 是不同的变量</li>
<li>JavaScript 内部已占用于单词（关键字或保留字）不允许使用</li>
<li>尽量保证变量具有一定的语义，见字知义</li>
</ol>
<p>注：所谓关键字是指 JavaScript 内部使用的词语，如 <code>let</code> 和<code>var</code>，保留字是指 JavaScript 内部目前没有使用的词语，但是将来可能会使用词语。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JavaScript 基础 - 变量名命名规则<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> age = <span class="number">18</span>; <span class="comment">// 正确</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> age1 = <span class="number">18</span>; <span class="comment">// 正确</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> _age = <span class="number">18</span>; <span class="comment">// 正确</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// let 1age = 18; // 错误，不可以数字开头</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> $age = <span class="number">18</span>; <span class="comment">// 正确</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> <span class="title class_">Age</span> = <span class="number">24</span>; <span class="comment">// 正确，它与小写的 age 是不同的变量</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// let let = 18; // 错误，let 是关键字</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> int = <span class="number">123</span>; <span class="comment">// 不推荐，int 是保留字</span></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h2><p>概念：使用 const 声明的变量称为“常量”。</p>
<p>使用场景：当某个变量永远不会改变的时候，就可以使用 const 来声明，而不是let。</p>
<p>命名规范：和变量一致</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">PI</span> = <span class="number">3.14</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意： 常量不允许重新赋值,声明的时候必须赋值（初始化）</p>
</blockquote>
<h1 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h1><blockquote>
<p>计算机世界中的万事成物都是数据。</p>
</blockquote>
<p>计算机程序可以处理大量的数据，为了方便数据的管理，将数据分成了不同的类型：</p>
<p><strong>基本数据类型</strong>：</p>
<ol>
<li>number 数字型</li>
<li>string 字符串型</li>
<li>boolean 布尔型</li>
<li>undefined 未定义型</li>
<li>null 空类型</li>
</ol>
<p><strong>引用数据类型</strong>：</p>
<ol>
<li>Array 数组</li>
<li>object 对象</li>
</ol>
<h2 id="检测数据类型"><a href="#检测数据类型" class="headerlink" title="检测数据类型"></a>检测数据类型</h2><p>通过 typeof 关键字检测数据类型。</p>
<ol>
<li>作为运算符：<code>typeof x</code>（常用写法）</li>
<li>函数形式：<code>typeof(x)</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 检测 1 是什么类型数据，结果为 number</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">typeof</span> <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h2 id="数值类型"><a href="#数值类型" class="headerlink" title="数值类型"></a>数值类型</h2><p>即我们数学中学习到的数字，可以是整数、小数、正数、负数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> score = <span class="number">100</span>; <span class="comment">// 正整数</span></span><br><span class="line"><span class="keyword">let</span> price = <span class="number">12.345</span>; <span class="comment">// 小数</span></span><br><span class="line"><span class="keyword">let</span> temperature = -<span class="number">40</span>; <span class="comment">// 负数</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">typeof</span> score); <span class="comment">// 结果为 number</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">typeof</span> price); <span class="comment">// 结果为 number</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">typeof</span> temperature); <span class="comment">// 结果为 number</span></span><br></pre></td></tr></table></figure>

<p>JavaScript 中的数值类型与数学中的数字是一样的，分为正数、负数、小数等。</p>
<p>注：JS 是弱数据类型，变量只有赋值之后，才能确认类型。</p>
<p>补充：<strong>NaN 代表一个计算错误</strong>。它是一个不正确或者一个未定义的数学操作所得到的结果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;字符串&#x27;</span> - <span class="number">2</span>) <span class="comment">//NaN</span></span><br></pre></td></tr></table></figure>

<p>NaN 是粘性的，如何对 NaN 的操作都会返回 NaN。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span> + <span class="number">2</span>) <span class="comment">//NaN</span></span><br></pre></td></tr></table></figure>

<h2 id="字符串类型"><a href="#字符串类型" class="headerlink" title="字符串类型"></a>字符串类型</h2><p>通过单引号（’’）、双引号（””）或反引号（&#96;）包裹的数据都叫字符串，单引号和双引号没有本质上的区别，<strong>推荐使用单引号</strong>。</p>
<p>注意事项：</p>
<ol>
<li>无论单引号或是双引号<strong>必须成对使用</strong></li>
<li>单引号&#x2F;双引号<strong>可以互相嵌套</strong>，但是不以自已嵌套自已</li>
<li>必要时可以使用转义符 <code>\</code>，输出单引号或双引号</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> user_name = <span class="string">&quot;小明&quot;</span>; <span class="comment">// 使用单引号</span></span><br><span class="line"><span class="keyword">let</span> gender = <span class="string">&quot;男&quot;</span>; <span class="comment">// 使用双引号</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">`123`</span>; <span class="comment">// 看上去是数字，但是用引号包裹了就成了字符串了</span></span><br><span class="line"><span class="keyword">let</span> str1 = <span class="string">&quot;&quot;</span>; <span class="comment">// 这种情况叫空字符串</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">typeof</span> user_name); <span class="comment">// 结果为 string</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">typeof</span> gender); <span class="comment">// 结果为 string</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">typeof</span> str); <span class="comment">// 结果为 string</span></span><br></pre></td></tr></table></figure>

<p><strong>字符串拼接</strong></p>
<p>场景：+ 运算符可以实现字符串的拼接。</p>
<p>口诀：数字相加，字符相连。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;小明&#x27;</span></span><br><span class="line"><span class="keyword">let</span> age = <span class="string">&#x27;18&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我的名字叫&#x27;</span> + name)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name + <span class="string">&#x27;的年龄是&#x27;</span> + age)</span><br></pre></td></tr></table></figure>

<p><strong>模板字符串</strong></p>
<p>场景：拼接字符串和变量。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;小明&#x27;</span></span><br><span class="line"><span class="keyword">let</span> age = <span class="string">&#x27;18&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`我的名字叫<span class="subst">$&#123;name&#125;</span>`</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span>的年龄是<span class="subst">$&#123;<span class="number">18</span>&#125;</span>`</span>)</span><br></pre></td></tr></table></figure>

<h2 id="布尔类型"><a href="#布尔类型" class="headerlink" title="布尔类型"></a>布尔类型</h2><p>表示肯定或否定时在计算机中对应的是布尔类型数据，它有两个固定的值 <code>true</code> 和 <code>false</code>，表示肯定的数据用 <code>true</code>，表示否定的数据用 <code>false</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> isCool = <span class="literal">true</span>; </span><br><span class="line">isCool = <span class="literal">false</span>; </span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">typeof</span> isCool); <span class="comment">// 结果为 boolean</span></span><br></pre></td></tr></table></figure>

<h2 id="undefined"><a href="#undefined" class="headerlink" title="undefined"></a>undefined</h2><p>未定义是比较特殊的类型，只有一个值 undefined，只声明变量，<strong>不赋值的情况下，变量的默认值为 undefined</strong>，一般很少【直接】为某个变量赋值为 undefined。</p>
<p>使用场景：</p>
<p>开发中经常声明一个变量，等待传送的数据，如果不知道这个数据是否传递过来，可以检查变量是不是 undefined，来判断用户是否有数据传递过来。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只声明了变量，并末赋值</span></span><br><span class="line"><span class="keyword">let</span> tmp;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="keyword">typeof</span> tmp) <span class="comment">// 结果为 undefined</span></span><br></pre></td></tr></table></figure>

<h2 id="null"><a href="#null" class="headerlink" title="null"></a>null</h2><p>JavaScript  中的 null 仅仅代表”无”、”空”或”值未知”的特殊值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = <span class="literal">null</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj)  <span class="comment">//null</span></span><br></pre></td></tr></table></figure>

<p><strong>null 和 undefined 区别</strong>：</p>
<ol>
<li>undefined 表示没有赋值</li>
<li>null 表示赋值了，但是内容为空</li>
</ol>
<h1 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h1><blockquote>
<p>理解弱类型语言的特征，掌握显式类型转换的方法</p>
</blockquote>
<p>在 JavaScript 中数据被分成了不同的类型，如数值、字符串、布尔值、undefined，在实际编程的过程中，不同数据类型之间存在着转换的关系。</p>
<h2 id="隐式转换"><a href="#隐式转换" class="headerlink" title="隐式转换"></a>隐式转换</h2><p>某些运算符被执行时，系统内部自动将数据类型进行转换，这种转换称为隐式转换。</p>
<p>规则：</p>
<ol>
<li><code>+</code> 号两边只要有一个字符串，都会把另一个转成字符串</li>
<li>除了 <code>+</code> 以外的算数运算符比如<code>- * /</code> 等都会把数据转成数字类型</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">13</span>; <span class="comment">// 数值</span></span><br><span class="line"><span class="keyword">let</span> num2 = <span class="string">&quot;2&quot;</span>; <span class="comment">// 字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果为 132</span></span><br><span class="line"><span class="comment">// 原因是将数值 num 转换成了字符串，相当于 &#x27;13&#x27;</span></span><br><span class="line"><span class="comment">// 然后 + 将两个字符串拼接到了一起</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num + num2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果为 11</span></span><br><span class="line"><span class="comment">// 原因是将字符串 num2 转换成了数值，相当于 2</span></span><br><span class="line"><span class="comment">// 然后数值 13 减去 数值 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num - num2);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="title function_">prompt</span>(<span class="string">&quot;请输入一个数字&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> b = <span class="title function_">prompt</span>(<span class="string">&quot;请再输入一个数字&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(a + b);</span><br></pre></td></tr></table></figure>

<p>注：数据类型的隐式转换是 JavaScript 的特征。</p>
<p>小技巧：</p>
<ol>
<li><code>+</code> 作为正号解析可以转换为数字类型</li>
<li>任何数据和字符串相加结果都是字符串</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(+<span class="string">&#x27;123&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>隐式转换补充： </p>
<ol>
<li><p>有字符串的加法 <code>&#39;&#39; + 1</code> ，结果是 <code>1</code> </p>
</li>
<li><p>减法 <code>-</code>（像大多数数学运算一样）只能用于数字，它会使空字符串 <code>&#39;&#39;</code> 转换为 0</p>
</li>
<li><p>null 经过数字转换之后会变为 0</p>
</li>
<li><p>undefined 经过数字转换之后会变为 NaN</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;&#x27;</span> - <span class="number">1</span>)  <span class="comment">//-1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;小明&#x27;</span> - <span class="number">1</span>)  <span class="comment">//NaN</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span> + <span class="number">1</span>)  <span class="comment">//1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">undefined</span> + <span class="number">1</span>)  <span class="comment">//NaN</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span> + <span class="number">1</span>)  <span class="comment">//NaN</span></span><br></pre></td></tr></table></figure>

<h2 id="显式转换"><a href="#显式转换" class="headerlink" title="显式转换"></a>显式转换</h2><p>编写程序时过度依靠系统内部的隐式转换是不严禁的，因为隐式转换规律并不清晰，大多是靠经验总结的规律。为了避免因隐式转换带来的问题，通常根逻辑需要对数据进行显示转换。</p>
<h3 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h3><ol>
<li>通过 <code>Number</code> 显示转换成数值类型</li>
<li>当转换失败时结果为 NaN（Not a Number）即不是一个数字</li>
<li><strong>NaN 也是 number 类型的数据</strong></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> t = <span class="string">&quot;12&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> f = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 显式将字符串 12 转换成数值 12</span></span><br><span class="line">t = <span class="title class_">Number</span>(t);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检测转换后的类型</span></span><br><span class="line"><span class="comment">// console.log(typeof t);</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(t + f); <span class="comment">// 结果为 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 并不是所有的值都可以被转成数值类型</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"><span class="comment">// 将 hello 转成数值是不现实的，当无法转换成</span></span><br><span class="line"><span class="comment">// 数值时，得到的结果为 NaN （Not a Number）</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(str));</span><br></pre></td></tr></table></figure>

<h3 id="parseInt"><a href="#parseInt" class="headerlink" title="parseInt"></a>parseInt</h3><p>只保留整数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseInt</span>(<span class="string">&#x27;12px&#x27;</span>)) <span class="comment">//12</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseInt</span>(<span class="string">&#x27;abc12px&#x27;</span>)) <span class="comment">//NaN</span></span><br></pre></td></tr></table></figure>

<h3 id="parseFloat"><a href="#parseFloat" class="headerlink" title="parseFloat"></a>parseFloat</h3><p>可以保留小数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseInt</span>(<span class="string">&#x27;12.1px&#x27;</span>)) <span class="comment">//12.1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseInt</span>(<span class="string">&#x27;abc12.1px&#x27;</span>)) <span class="comment">//NaN</span></span><br></pre></td></tr></table></figure>

<h1 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h1><h2 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h2><p>数字是用来计算的，比如：乘法 * 、除法 &#x2F; 、加法 + 、减法 - 等等，所以经常和算术运算符一起。</p>
<p>算术运算符：也叫数学运算符，主要包括加、减、乘、除、取余（求模）等。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>+</td>
<td>求和</td>
</tr>
<tr>
<td>-</td>
<td>求差</td>
</tr>
<tr>
<td>*</td>
<td>求积</td>
</tr>
<tr>
<td>&#x2F;</td>
<td>求商</td>
</tr>
<tr>
<td>%</td>
<td>取模（取余数），开发中经常用于作为某个数字是否被整除</td>
</tr>
</tbody></table>
<p>注意：在计算失败时，显示的结果是 NaN （not a number）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 算术运算符</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span> + <span class="number">2</span> * <span class="number">3</span> / <span class="number">2</span>) <span class="comment">//  4 </span></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">10</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num + <span class="number">10</span>)  <span class="comment">// 20</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num + num)  <span class="comment">// 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 取模(取余数)  使用场景：  用来判断某个数是否能够被整除</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span> % <span class="number">2</span>) <span class="comment">//  0  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">6</span> % <span class="number">3</span>) <span class="comment">//  0</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span> % <span class="number">3</span>) <span class="comment">//  2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span> % <span class="number">5</span>) <span class="comment">//  3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 注意事项 : 如果我们计算失败，则返回的结果是 NaN (not a number)</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;小明&#x27;</span> - <span class="number">2</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;小明&#x27;</span> * <span class="number">2</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;小明&#x27;</span> + <span class="number">2</span>)  </span><br></pre></td></tr></table></figure>

<h2 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h2><p>赋值运算符：对变量进行赋值的运算符。</p>
<p><code>=</code>  将等号右边的值赋予给左边，要求左边必须是一个容器。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>+&#x3D;</td>
<td>加法赋值</td>
</tr>
<tr>
<td>-+</td>
<td>减法赋值</td>
</tr>
<tr>
<td>*&#x3D;</td>
<td>乘法赋值</td>
</tr>
<tr>
<td>&#x2F;&#x3D;</td>
<td>除法赋值</td>
</tr>
<tr>
<td>%&#x3D;</td>
<td>取余赋值</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">1</span></span><br><span class="line"><span class="comment">// num = num + 1</span></span><br><span class="line"><span class="comment">// 采取赋值运算符</span></span><br><span class="line"><span class="comment">// num += 1</span></span><br><span class="line">num += <span class="number">3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num)</span><br></pre></td></tr></table></figure>

<h2 id="自增-自减运算符"><a href="#自增-自减运算符" class="headerlink" title="自增&#x2F;自减运算符"></a>自增&#x2F;自减运算符</h2><table>
<thead>
<tr>
<th>符号</th>
<th>作用</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>++</td>
<td>自增</td>
<td>变量自身的值加1，例如: x++</td>
</tr>
<tr>
<td>–</td>
<td>自减</td>
<td>变量自身的值减1，例如: x–</td>
</tr>
</tbody></table>
<ol>
<li><code>++</code> 在前和 <code>++</code> 在后在单独使用时二者并没有差别</li>
<li>如果自增或自减参与运算就有区别：前置自增（先自加再使用）；后置自增（先使用后自加）</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// let num = 10</span></span><br><span class="line"><span class="comment">// num = num + 1</span></span><br><span class="line"><span class="comment">// num += 1</span></span><br><span class="line"><span class="comment">// // 1. 前置自增</span></span><br><span class="line"><span class="comment">// let i = 1</span></span><br><span class="line"><span class="comment">// ++i</span></span><br><span class="line"><span class="comment">// console.log(i)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let i = 1</span></span><br><span class="line"><span class="comment">// console.log(++i + 1)</span></span><br><span class="line"><span class="comment">// 2. 后置自增</span></span><br><span class="line"><span class="comment">// let i = 1</span></span><br><span class="line"><span class="comment">// i++</span></span><br><span class="line"><span class="comment">// console.log(i)</span></span><br><span class="line"><span class="comment">// let i = 1</span></span><br><span class="line"><span class="comment">// console.log(i++ + 1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 了解 </span></span><br><span class="line"><span class="keyword">let</span> i = <span class="number">1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i++ + ++i + i)</span><br></pre></td></tr></table></figure>

<h2 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h2><p>使用场景：</p>
<ol>
<li>比较两个数据大小、是否相等，根据比较结果返回一个布尔值（true &#x2F; false）</li>
<li>比较两个字符串，是比较字符对应的 ASCII 码</li>
</ol>
<p>注意：</p>
<ol>
<li>NaN 不等于任何值，包括它本身</li>
<li>尽量不要比较小数，因为小数有精度问题</li>
<li>不同类型之间比较会发生隐式转换成 number 类型再比较</li>
</ol>
<table>
<thead>
<tr>
<th>运算符</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>&gt;</td>
<td>左边是否大于右边</td>
</tr>
<tr>
<td>&lt;</td>
<td>左边是否小于右边</td>
</tr>
<tr>
<td>&gt;&#x3D;</td>
<td>左边是否大于或等于右边</td>
</tr>
<tr>
<td>&lt;&#x3D;</td>
<td>左边是否小于或等于右边</td>
</tr>
<tr>
<td>&#x3D;&#x3D;&#x3D;</td>
<td>左右两边是否<code>类型</code>和<code>值</code>都相等（重点）</td>
</tr>
<tr>
<td>&#x3D;&#x3D;</td>
<td>左右两边<code>值</code>是否相等</td>
</tr>
<tr>
<td>!&#x3D;</td>
<td>左右值不相等</td>
</tr>
<tr>
<td>!&#x3D;&#x3D;</td>
<td>左右两边是否不全等</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span> &gt; <span class="number">5</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span> &gt;= <span class="number">3</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span> == <span class="number">2</span>)</span><br><span class="line"><span class="comment">// 比较运算符有隐式转换 把&#x27;2&#x27; 转换为 2  双等号 只判断值</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span> == <span class="string">&#x27;2&#x27;</span>)  <span class="comment">// true</span></span><br><span class="line"><span class="comment">// console.log(undefined === null)</span></span><br><span class="line"><span class="comment">// === 全等 判断 值 和 数据类型都一样才行</span></span><br><span class="line"><span class="comment">// 以后判断是否相等 请用 ===  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span> === <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span> === <span class="title class_">NaN</span>) <span class="comment">// NaN 不等于任何人，包括他自己</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span> !== <span class="string">&#x27;2&#x27;</span>)  <span class="comment">// true  </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span> != <span class="string">&#x27;2&#x27;</span>) <span class="comment">// false </span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---------字符串比较---------&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a&#x27;</span> &lt; <span class="string">&#x27;b&#x27;</span>) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;aa&#x27;</span> &lt; <span class="string">&#x27;ab&#x27;</span>) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;aa&#x27;</span> &lt; <span class="string">&#x27;aac&#x27;</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h2 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h2><p>使用场景：可以把多个值放到一起运算，运算结果都是最后<strong>被执行的表达式值</strong>，<strong>而不是一个布尔值</strong>。</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>名称</th>
<th>日常读法</th>
<th>特点</th>
<th>口诀</th>
</tr>
</thead>
<tbody><tr>
<td>&amp;&amp;</td>
<td>逻辑与</td>
<td>并且</td>
<td>符号两边有一个假的结果为假</td>
<td>一假则假</td>
</tr>
<tr>
<td>||</td>
<td>逻辑或</td>
<td>或者</td>
<td>符号两边有一个真的结果为真</td>
<td>一真则真</td>
</tr>
<tr>
<td>!</td>
<td>逻辑非</td>
<td>取反</td>
<td>true 变 false  false 变 true</td>
<td>真变假，假变真</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
<th>A &amp;&amp; B</th>
<th>A || B</th>
<th>!A</th>
</tr>
</thead>
<tbody><tr>
<td>false</td>
<td>false</td>
<td>false</td>
<td>false</td>
<td>true</td>
</tr>
<tr>
<td>false</td>
<td>true</td>
<td>false</td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td>true</td>
<td>false</td>
<td>false</td>
<td>true</td>
<td>false</td>
</tr>
<tr>
<td>true</td>
<td>true</td>
<td>true</td>
<td>true</td>
<td>false</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 逻辑与 一假则假</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">true</span> &amp;&amp; <span class="literal">true</span>)  <span class="comment">//ture</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">false</span> &amp;&amp; <span class="literal">true</span>)  <span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span> &lt; <span class="number">5</span> &amp;&amp; <span class="number">3</span> &gt; <span class="number">2</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span> &lt; <span class="number">5</span> &amp;&amp; <span class="number">3</span> &lt; <span class="number">2</span>)  <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 逻辑或 一真则真</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">true</span> || <span class="literal">true</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">false</span> || <span class="literal">true</span>)  <span class="comment">//true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">false</span> || <span class="literal">false</span>)  <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 逻辑非  取反</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(!<span class="literal">true</span>)  <span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(!<span class="literal">false</span>)  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p><strong>逻辑中断</strong></p>
<p>短路：只存在于 <code>&amp;&amp;</code> 和 <code>||</code> 中，当满足一定条件会让右边代码不执行。</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>短路条件</th>
</tr>
</thead>
<tbody><tr>
<td>&amp;&amp;</td>
<td>左边为 false 就短路</td>
</tr>
<tr>
<td>||</td>
<td>左边为 true 就短路</td>
</tr>
</tbody></table>
<p>原因：通过左边能得到整个式子的结果，因此没必要再判断右边。</p>
<p>运算结果：无论 <code>&amp;&amp;</code> 还是 <code>||</code> ，运算结果都是最后被执行的表达式值，一般用在变量赋值。</p>
<p><strong>转换为Boolean型</strong></p>
<p><code>&#39;&#39;</code>、<code>0</code>、<code>undefined</code>、<code>null</code>、<code>false</code>、<code>NaN</code> 转换为布尔值后都是 false, 其余则为 true。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">false</span> &amp;&amp; <span class="number">20</span>);  <span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span> &lt; <span class="number">3</span> &amp;&amp; <span class="number">20</span>);  <span class="comment">//false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(undefinded &amp;&amp; <span class="number">20</span>);  <span class="comment">//undefined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span> &amp;&amp; <span class="number">20</span>);  <span class="comment">//null</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> &amp;&amp; <span class="number">20</span>);  <span class="comment">//0</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">10</span> &amp;&amp; <span class="number">20</span>);  <span class="comment">//20</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">false</span> || <span class="number">20</span>);  <span class="comment">//20</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span> &lt; <span class="number">3</span> || <span class="number">20</span>);  <span class="comment">//20</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(undefinded || <span class="number">20</span>);  <span class="comment">//20</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span> || <span class="number">20</span>);  <span class="comment">//20</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> || <span class="number">20</span>);  <span class="comment">//20</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">10</span> || <span class="number">20</span>);  <span class="comment">//10</span></span><br></pre></td></tr></table></figure>

<h2 id="运算符优先级"><a href="#运算符优先级" class="headerlink" title="运算符优先级"></a>运算符优先级</h2><blockquote>
<p>逻辑运算符优先级： ！&gt; &amp;&amp; &gt;  ||  </p>
</blockquote>
<table>
<thead>
<tr>
<th>优先级</th>
<th>运算符</th>
<th>顺序</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>小括号</td>
<td>()</td>
</tr>
<tr>
<td>2</td>
<td>一元运算符</td>
<td>++ – !</td>
</tr>
<tr>
<td>3</td>
<td>算数运算符</td>
<td>先 * &#x2F; % 后 + -</td>
</tr>
<tr>
<td>4</td>
<td>关系运算符</td>
<td>&gt; &gt;&#x3D; &lt; &lt;&#x3D;</td>
</tr>
<tr>
<td>5</td>
<td>相等运算符</td>
<td>&#x3D;&#x3D; !&#x3D; &#x3D;&#x3D;&#x3D; !&#x3D;&#x3D;</td>
</tr>
<tr>
<td>6</td>
<td>逻辑运算符</td>
<td>先 &amp;&amp; 后 ||</td>
</tr>
<tr>
<td>7</td>
<td>赋值运算符</td>
<td>&#x3D;</td>
</tr>
<tr>
<td>8</td>
<td>逗号运算符</td>
<td>,</td>
</tr>
</tbody></table>
<h1 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h1><h2 id="表达式和语句"><a href="#表达式和语句" class="headerlink" title="表达式和语句"></a>表达式和语句</h2><p>表达式：可以<strong>被求值</strong>的代码，并将其计算出一个结果。</p>
<p>语句：一段<strong>可以执行</strong>的代码，是一个行为，例如分支语句和循环语句。</p>
<h2 id="分支语句"><a href="#分支语句" class="headerlink" title="分支语句"></a>分支语句</h2><p>分支语句可以根据条件判定真假，来选择性的执行想要的代码。</p>
<p>分支语句包含：</p>
<ol>
<li>if 分支语句（重点）</li>
<li>三元运算符</li>
<li>switch 语句</li>
</ol>
<h3 id="if分支语句"><a href="#if分支语句" class="headerlink" title="if分支语句"></a>if分支语句</h3><p>语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (条件表达式) &#123;</span><br><span class="line">  <span class="comment">// 满足条件要执行的语句</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>小括号内的条件结果是布尔值，为 true 时，进入大括号里执行代码；为 false，则不执行大括号里面代码。</p>
<p>小括号内的结果若不是布尔类型时，会发生类型转换为布尔值，类似 Boolean()。</p>
<p>如果大括号只有一个语句，大括号可以省略，但是，不提倡这么做。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单分支语句</span></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;执行语句&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">3</span> &gt; <span class="number">5</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;执行语句&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">2</span> === <span class="string">&#x27;2&#x27;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;执行语句&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1. 除了0 所有的数字都为真</span></span><br><span class="line"><span class="keyword">if</span> (<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;执行语句&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2.除了 &#x27;&#x27; 所有的字符串都为真 true</span></span><br><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;小明&#x27;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;执行语句&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="if双分支语句"><a href="#if双分支语句" class="headerlink" title="if双分支语句"></a>if双分支语句</h3><p>如果有两个条件的时候，可以使用 if else 双分支语句。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (条件表达式)&#123;</span><br><span class="line">  <span class="comment">// 满足条件要执行的语句</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// 不满足条件要执行的语句</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 用户输入</span></span><br><span class="line"><span class="keyword">let</span> uname = <span class="title function_">prompt</span>(<span class="string">&#x27;请输入用户名:&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> pwd = <span class="title function_">prompt</span>(<span class="string">&#x27;请输入密码:&#x27;</span>)</span><br><span class="line"><span class="comment">// 2. 判断输出</span></span><br><span class="line"><span class="keyword">if</span> (uname === <span class="string">&#x27;小明&#x27;</span> &amp;&amp; pwd === <span class="string">&#x27;123456&#x27;</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;恭喜登录成功&#x27;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;用户名或者密码错误&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="if多分支语句"><a href="#if多分支语句" class="headerlink" title="if多分支语句"></a>if多分支语句</h3><p>使用场景： 适合于有多个条件的时候。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 用户输入</span></span><br><span class="line"><span class="keyword">let</span> score = +<span class="title function_">prompt</span>(<span class="string">&#x27;请输入成绩：&#x27;</span>)</span><br><span class="line"><span class="comment">// 2. 判断输出</span></span><br><span class="line"><span class="keyword">if</span> (score &gt;= <span class="number">90</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;成绩优秀&#x27;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &gt;= <span class="number">70</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;成绩良好&#x27;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;成绩及格&#x27;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;成绩不及格&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h3><p><strong>使用场景</strong>： 一些简单的双分支，可以使用三元运算符（三元表达式），写起来比 if  else 双分支更简单。</p>
<p><strong>符号</strong>：? 与 : 配合使用</p>
<p>语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">条件 ? 满足条件执行的代码 ：不满足条件执行的代码</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5 &gt; 3 ? &#x27;真的&#x27; : &#x27;假的&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span> &lt; <span class="number">3</span> ? <span class="string">&#x27;真的&#x27;</span> : <span class="string">&#x27;假的&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 补0操作</span></span><br><span class="line"><span class="comment">// 1. 用户输入 </span></span><br><span class="line"><span class="keyword">let</span> num = <span class="title function_">prompt</span>(<span class="string">&#x27;请您输入一个数字:&#x27;</span>)</span><br><span class="line"><span class="comment">// 2. 判断输出</span></span><br><span class="line">num = num &gt;= <span class="number">10</span> ? num : <span class="number">0</span> + num</span><br><span class="line"><span class="title function_">alert</span>(num)</span><br></pre></td></tr></table></figure>

<h3 id="switch语句"><a href="#switch语句" class="headerlink" title="switch语句"></a>switch语句</h3><p>使用场景：适合于有多个条件的时候，也属于分支语句，大部分情况下和 if 多分支语句功能相同。</p>
<p>注意：</p>
<ol>
<li>switch case 语句一般用于等值（<code>===</code>）判断</li>
<li>switch case 一般需要配合 break 关键字使用，没有 break 会造成 case 穿透</li>
</ol>
<p>语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (表达式) &#123;</span><br><span class="line">  <span class="keyword">case</span> 值<span class="number">1</span>:</span><br><span class="line">    代码<span class="number">1</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">case</span> 值<span class="number">2</span>:</span><br><span class="line">    代码<span class="number">2</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">   ...</span><br><span class="line">  <span class="attr">default</span>:</span><br><span class="line">    代码n</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;您选择的是1&#x27;</span>)</span><br><span class="line">    <span class="keyword">break</span>  <span class="comment">// 退出switch</span></span><br><span class="line">  <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;您选择的是2&#x27;</span>)</span><br><span class="line">    <span class="keyword">break</span>  <span class="comment">// 退出switch</span></span><br><span class="line">  <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;您选择的是3&#x27;</span>)</span><br><span class="line">    <span class="keyword">break</span>  <span class="comment">// 退出switch</span></span><br><span class="line">  <span class="attr">default</span>:</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;没有符合条件的&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>补充：断点调试</p>
<p>作用：学习时可以帮助更好的理解代码运行，工作时可以更快找到 bug。</p>
<p>浏览器打开调试界面</p>
<ol>
<li>按 F12 打开开发者工具</li>
<li>点到源代码一栏 （ sources ）</li>
<li>选择代码文件</li>
</ol>
<p><strong>断点：</strong>在某句代码上加的标记就叫断点，当程序执行到这句有标记的代码时会暂停下来。</p>
<h2 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h2><p>使用场景：重复执行指定的一段代码。</p>
<p>学习路径：</p>
<ol>
<li>while循环</li>
<li>for 循环（重点）</li>
</ol>
<h3 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a>while循环</h3><p>在…. 期间， 所以 while 循环就是在满足条件期间，重复执行某些代码。</p>
<p>循环三要素：</p>
<ol>
<li>初始值 （经常用变量）</li>
<li>终止条件</li>
<li>变量的变化量</li>
</ol>
<p>语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (条件表达式) &#123;</span><br><span class="line">   <span class="comment">// 循环体    </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 需求: 利用循环重复打印3次 &#x27;我的名字叫小明&#x27;</span></span><br><span class="line"><span class="keyword">let</span> i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> (i &lt;= <span class="number">3</span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;我的名字叫小明~&lt;br&gt;&#x27;</span>)</span><br><span class="line">  i++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>break</code>  中止整个循环，一般用于结果已经得到, 后续的循环不需要的时候可以使用（提高效率） 。</p>
<p><code>continue</code> 中止本次循环，一般用于排除或者跳过某一个选项的时候。</p>
<p><code>break</code> 示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> (i &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">    <span class="keyword">if</span> (i === <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">break</span>  <span class="comment">// 退出循环</span></span><br><span class="line">    &#125;</span><br><span class="line">    i++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>continue</code> 示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> (i &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i === <span class="number">3</span>) &#123;</span><br><span class="line">    i++</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">  i++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>无限循环：</p>
<ol>
<li><code>while(true)</code> 来构造“无限”循环，需要使用 <code>break</code> 退出循环。（常用）</li>
<li><code>for(;;)</code> 也可以来构造“无限”循环，同样需要使用 <code>break</code> 退出循环。</li>
</ol>
<h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h3><p><code>for</code> 是 JavaScript 提供的另一种循环控制的话句，它和 <code>while</code> 只是语法上存在差异。</p>
<p>语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(起始值; 终止条件; 变化量) &#123;</span><br><span class="line">    <span class="comment">// 要重复执行的代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例：在网页中输入标题标签</span></span><br><span class="line"><span class="comment">// 起始值为 1</span></span><br><span class="line"><span class="comment">// 变化量 i++</span></span><br><span class="line"><span class="comment">// 终止条件 i &lt;= 6</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">6</span>; i++) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">`&lt;h<span class="subst">$&#123;i&#125;</span>&gt;循环控制，即重复执行&lt;h<span class="subst">$&#123;i&#125;</span>&gt;`</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>变化量和死循环，<code>for</code> 循环和 <code>while</code> 一样，如果不合理设置增量和终止条件，便会产生死循环。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. continue </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i === <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment">// 结束本次循环，继续下一次循环</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2. break</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i === <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">break</span>  <span class="comment">// 退出结束整个循环</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="循环嵌套"><a href="#循环嵌套" class="headerlink" title="循环嵌套"></a>循环嵌套</h3><p>外层循环循环一次，里层循环循环全部。</p>
<p>语法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(外部声明记录循环次数起始值; 循环条件; 变化量) &#123;</span><br><span class="line">    <span class="keyword">for</span>(内部声明记录循环次数起始值; 循环条件; 变化量) &#123;</span><br><span class="line">        <span class="comment">// 要重复执行的代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="倒三角"><a href="#倒三角" class="headerlink" title="倒三角"></a>倒三角</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 外层打印几行</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="comment">// 里层打印几个星星</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt;= i; j++) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;★&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;br&gt;&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="九九乘法表"><a href="#九九乘法表" class="headerlink" title="九九乘法表"></a>九九乘法表</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">2px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">183</span>, <span class="number">183</span>, <span class="number">236</span>, <span class="number">0.5</span>);</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: black;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 外层打印几行</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">9</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 里层打印几个星星</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt;= i; j++) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 只需要吧 ★ 换成  1 x 1 = 1</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      		&lt;span&gt;<span class="subst">$&#123;j&#125;</span> x <span class="subst">$&#123;i&#125;</span> = <span class="subst">$&#123;j * i&#125;</span>&lt;/span&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">           `</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;br&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><blockquote>
<p>知道什么是数组及其应用的场景，掌握数组声明及访问的语法。</p>
</blockquote>
<h2 id="数组介绍"><a href="#数组介绍" class="headerlink" title="数组介绍"></a>数组介绍</h2><p><strong>数组：</strong>（Array）是一种可以按顺序保存数据的数据类型。</p>
<p><strong>使用场景：</strong>如果有多个数据可以用数组保存起来，然后放到一个变量中，管理非常方便。</p>
<h3 id="定义数组和数组单元"><a href="#定义数组和数组单元" class="headerlink" title="定义数组和数组单元"></a>定义数组和数组单元</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 语法，使用 [] 来定义一个空数组</span></span><br><span class="line"><span class="comment">// 定义一个空数组，然后赋值给变量 classes</span></span><br><span class="line"><span class="comment">// let classes = [];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 定义非空数组</span></span><br><span class="line"><span class="keyword">let</span> classes = [<span class="string">&#x27;小明&#x27;</span>, <span class="string">&#x27;小刚&#x27;</span>, <span class="string">&#x27;小红&#x27;</span>, <span class="string">&#x27;小丽&#x27;</span>, <span class="string">&#x27;小米&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>通过 <code>[]</code> 定义数组，数据中可以存放真正的数据，如小明、小刚、小红等这些都是数组中的数据，我们这些数据称为数组单元，数组单元之间使用英文逗号分隔。</p>
<h3 id="访问数组和数组索引"><a href="#访问数组和数组索引" class="headerlink" title="访问数组和数组索引"></a>访问数组和数组索引</h3><p>使用数组存放数据并不是最终目的，关键是能够随时的访问到数组中的数据（单元）。其实 JavaScript 为数组中的每一个数据单元都编了号，通过数据单元在数组中的编号便可以轻松访问到数组中的数据单元了。</p>
<p>我们将数据单元在数组中的编号称为索引值，也有人称其为下标。</p>
<p>索引值实际是按着数据单元在数组中的位置依次排列的，注意是从<code> 0</code> 开始的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> classes = [<span class="string">&#x27;小明&#x27;</span>, <span class="string">&#x27;小刚&#x27;</span>, <span class="string">&#x27;小红&#x27;</span>, <span class="string">&#x27;小丽&#x27;</span>, <span class="string">&#x27;小米&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 访问数组，语法格式为：变量名[索引值]</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(classes[<span class="number">0</span>]) <span class="comment">// 结果为：小明</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(classes[<span class="number">1</span>]) <span class="comment">// 结果为：小刚</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(classes[<span class="number">4</span>]) <span class="comment">// 结果为：小米</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 通过索引值还可以为数组单重新赋值</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(classes[<span class="number">3</span>]) <span class="comment">// 结果为：小丽</span></span><br><span class="line"><span class="comment">// 重新为索引值为 3 的单元赋值</span></span><br><span class="line">classes[<span class="number">3</span>] = <span class="string">&#x27;小小丽&#x27;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">wirte</span>(classes[<span class="number">3</span>]); <span class="comment">// 结果为： 小小丽</span></span><br></pre></td></tr></table></figure>

<h3 id="数据单元值类型"><a href="#数据单元值类型" class="headerlink" title="数据单元值类型"></a>数据单元值类型</h3><p>数组做为数据的集合，它的单元值可以是<strong>任意</strong>数据类型。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a) 数组单元值的类型为字符类型</span></span><br><span class="line"><span class="keyword">let</span> list = [<span class="string">&#x27;HTML&#x27;</span>, <span class="string">&#x27;CSS&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>]</span><br><span class="line"><span class="comment">// b) 数组单元值的类型为数值类型</span></span><br><span class="line"><span class="keyword">let</span> scores = [<span class="number">78</span>, <span class="number">84</span>, <span class="number">70</span>, <span class="number">62</span>, <span class="number">75</span>]</span><br><span class="line"><span class="comment">// c) 混合多种类型</span></span><br><span class="line"><span class="keyword">let</span> mixin = [<span class="literal">true</span>, <span class="number">1</span>, <span class="literal">false</span>, <span class="string">&#x27;hello&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="数组长度属性"><a href="#数组长度属性" class="headerlink" title="数组长度属性"></a>数组长度属性</h3><p>重申一次，数组在 JavaScript 中并不是新的数据类型，它属于对象类型。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个数组</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;css&#x27;</span>, <span class="string">&#x27;javascript&#x27;</span>]</span><br><span class="line"><span class="comment">// 数组对应着一个 length 属性，它的含义是获取数组的长度</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="property">length</span>) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<h2 id="操作数组"><a href="#操作数组" class="headerlink" title="操作数组"></a>操作数组</h2><p>数组做为对象数据类型，不但有 <code>length</code> 属性可以使用，还提供了许多方法：</p>
<ol>
<li><code>push</code> 动态向数组的尾部添加一个或多个单元</li>
<li><code>unshit</code> 动态向数组头部添加一个或多个单元</li>
<li><code>pop</code> 删除最后一个单元</li>
<li><code>shift</code> 删除第一个单元</li>
<li><code>splice</code> 动态删除任意单元</li>
</ol>
<p>使用以上4个方法时，都是直接在原数组上进行操作，即成功调任何一个方法，原数组都跟着发生相应的改变。并且在添加或删除单元时 <code>length</code> 并不会发生错乱。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个数组</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;css&#x27;</span>, <span class="string">&#x27;javascript&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. push 动态向数组的尾部添加一个单元</span></span><br><span class="line">arr.<span class="title function_">push</span>(<span class="string">&#x27;Nodejs&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr)</span><br><span class="line">arr.<span class="title function_">push</span>(<span class="string">&#x27;Vue&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. unshit 动态向数组头部添加一个单元</span></span><br><span class="line">arr.<span class="title function_">unshift</span>(<span class="string">&#x27;VS Code&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. splice 动态删除任意单元</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">2</span>, <span class="number">1</span>) <span class="comment">// 从索引值为2的位置开始删除1个单元</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. pop 删除最后一个单元</span></span><br><span class="line">arr.<span class="title function_">pop</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. shift 删除第一个单元</span></span><br><span class="line">arr.<span class="title function_">shift</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr)</span><br></pre></td></tr></table></figure>

<p>数组补充：</p>
<p><code>forEach</code> 方法：主要用于遍历数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>];</span><br><span class="line">arr.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">ele, index</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(ele);  <span class="comment">// 数组元素</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(index);  <span class="comment">//  数组索引号</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>map</code> 方法：通过遍历数组，并且返回新的数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> newArr = arr.<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">ele, index</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(ele);  <span class="comment">// 数组元素</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(index);  <span class="comment">//  数组索引号</span></span><br><span class="line">    <span class="keyword">return</span> ele + <span class="string">&#x27;颜色&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newArr)  <span class="comment">// [&#x27;red颜色&#x27;, &#x27;green颜色&#x27;, &#x27;blue颜色&#x27;]</span></span><br></pre></td></tr></table></figure>

<p><code>filter</code> 方法：通过遍历数组，并且返回过滤后的新数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> newArr = arr.<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">ele, index</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(ele);  <span class="comment">// 数组元素</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(index);  <span class="comment">//  数组索引号</span></span><br><span class="line">    <span class="keyword">return</span> item === <span class="string">&#x27;red&#x27;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newArr)  <span class="comment">// [&#x27;red&#x27;]</span></span><br></pre></td></tr></table></figure>

<p><code>join</code> 方法：可以把数组中的所有元素转换成一个字符串。数组元素是通过参数里面指定的分隔符进行分隔的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>))  <span class="comment">// red green blue</span></span><br></pre></td></tr></table></figure>

<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><blockquote>
<p>理解函数的封装特性，掌握函数的语法规则</p>
</blockquote>
<h2 id="函数介绍"><a href="#函数介绍" class="headerlink" title="函数介绍"></a>函数介绍</h2><p>函数可以把具有相同或相似逻辑的代码“包裹”起来，通过函数调用执行这些被“包裹”的代码逻辑，这么做的优势是有利于<strong>精简代码方便复用</strong>。</p>
<p><strong>声明</strong></p>
<p>声明（定义）一个完整函数包括关键字、函数名、形式参数、函数体、返回值5个部分。</p>
<p><strong>调用</strong></p>
<p>声明（定义）的函数必须调用才会真正被执行，使用 <code>()</code> 调用函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明（定义）了最简单的函数，既没有形式参数，也没有返回值</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;嗨~&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 函数调用，这些函数体内的代码逻辑会被执行</span></span><br><span class="line"><span class="comment">// 函数名()</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">sayHi</span>()</span><br><span class="line"><span class="comment">// 可以重复被调用，多少次都可以</span></span><br><span class="line"><span class="title function_">sayHi</span>()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：函数名的命名规则与变量是一致的，并且尽量保证函数名的语义。</p>
</blockquote>
<h2 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h2><p>通过向函数传递参数，可以让函数更加灵活多变，参数可以理解成是一个变量。</p>
<p>示例：声明（定义）一个功能为打招呼的函数</p>
<ul>
<li>传入数据列表</li>
<li>声明这个函数需要传入几个数据</li>
<li>多个数据用逗号隔开</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="comment">// 参数 name 可以被理解成是一个变量</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;嗨~&#x27;</span> + name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用 sayHi 函数，括号中多了 &#x27;小明&#x27;</span></span><br><span class="line"><span class="comment">// 这时相当于为参数 name 赋值了</span></span><br><span class="line"><span class="title function_">sayHi</span>(<span class="string">&#x27;小明&#x27;</span>)<span class="comment">// 结果为 小明</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 再次调用 sayHi 函数，括号中多了 &#x27;小红&#x27;</span></span><br><span class="line"><span class="comment">// 这时相当于为参数 name 赋值了</span></span><br><span class="line"><span class="title function_">sayHi</span>(<span class="string">&#x27;小红&#x27;</span>) <span class="comment">// 结果为 小红</span></span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>声明（定义）函数时的形参没有数量限制，当有多个形参时使用 <code>,</code> 分隔</li>
<li>调用函数传递的实参要与形参的顺序一致</li>
</ol>
<p><strong>形参和实参</strong></p>
<p>形参：声明函数时写在函数名右边小括号里的叫形参（形式上的参数）。</p>
<p>实参：调用函数时写在函数名右边小括号里的叫实参（实际上的参数）。</p>
<p>形参可以理解为是在这个函数内声明的变量（比如 num1 &#x3D; 10）实参可以理解为是给这个变量赋值。</p>
<p>开发中尽量保持形参和实参个数一致，如果实参少于形参，则没有提供实参的值默认是 undefined；如果实参多于形参，则多余的部分实参忽略。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明（定义）一个计算任意两数字和的函数</span></span><br><span class="line"><span class="comment">// 形参 x 和 y 分别表示任意两个数字，它们是两个变量</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">count</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用函数，传入两个具体的数字做为实参</span></span><br><span class="line"><span class="comment">// 此时 10 赋值给了形参 x</span></span><br><span class="line"><span class="comment">// 此时 5  赋值给了形参 y</span></span><br><span class="line"><span class="title function_">count</span>(<span class="number">10</span>, <span class="number">5</span>); <span class="comment">// 结果为 15</span></span><br></pre></td></tr></table></figure>

<p><strong>参数默认值</strong></p>
<p>形参可以看作变量，如果一个变量不给值，默认是 <code>undefined</code>。</p>
<p>可以改进在用户不输入实参的情况下，<strong>给形参默认值</strong>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//提供默认形参</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">count</span>(<span class="params">x = <span class="number">0</span>, y = <span class="number">0</span></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x + y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">count</span>();</span><br></pre></td></tr></table></figure>

<h2 id="函数返回值"><a href="#函数返回值" class="headerlink" title="函数返回值"></a>函数返回值</h2><p>函数的本质是封装（包裹），函数体内的逻辑执行完毕后，函数外部如何获得函数内部的执行结果呢？要想获得函数内部逻辑的执行结果，需要通过 <code>return</code> 这个关键字，将内部执行结果传递到函数外部，这个被传递到外部的结果就是返回值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义求和函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">count</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> s = a + b</span><br><span class="line">  <span class="comment">// s 即为 a + b 的结果</span></span><br><span class="line">  <span class="comment">// 通过 return 将 s 传递到外部</span></span><br><span class="line">  <span class="keyword">return</span> s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用函数，如果一个函数有返回值</span></span><br><span class="line"><span class="comment">// 那么可将这个返回值赋值给外部的任意变量</span></span><br><span class="line"><span class="keyword">let</span> total = <span class="title function_">count</span>(<span class="number">5</span>, <span class="number">12</span>)</span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ol>
<li>在函数体中使用 return 关键字能将内部的执行结果交给函数外部使用</li>
<li>函数内部只能出现 1 次 return，并且 return 下一行代码不会再被执行</li>
<li>return 会立即结束当前函数</li>
<li>函数可以没有 return，这种情况默认返回值为 undefined</li>
</ol>
<h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><p>通常来说，一段程序代码中所用到的名字并不总是有效和可用的，而限定这个名字的<strong>可用性的代码范围</strong>就是这个名字的作用域。</p>
<p>作用域的使用提高了程序逻辑的局部性，增强了程序的可靠性，减少了名字冲突。</p>
<p><strong>全局作用域</strong></p>
<p>作用于所有代码执行的环境（整个 script 标签内部）或者一个独立的 js 文件。</p>
<p>处于全局作用域内的变量，称为全局变量。</p>
<p><strong>局部作用域</strong></p>
<p>作用于函数内的代码环境，就是局部作用域。 因为跟函数有关系，所以也称为函数作用域。</p>
<p>处于局部作用域内的变量称为局部变量。</p>
<blockquote>
<p>如果函数内部，变量没有声明，直接赋值，也当全局变量看，但是强烈不推荐。</p>
<p>但是有一种情况，函数内部的形参可以看做是局部变量。</p>
</blockquote>
<h2 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h2><p>匿名函数：没有名字的函数，无法直接使用。</p>
<p>函数表达式：将匿名函数赋值给一个变量，并且通过变量名称进行调用。</p>
<p>示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明</span></span><br><span class="line"><span class="keyword">let</span> fn = <span class="keyword">function</span>(<span class="params"></span>) &#123; </span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;函数表达式&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="title function_">fn</span>()</span><br></pre></td></tr></table></figure>

<p><strong>立即执行函数</strong></p>
<p>场景：避免全局变量之间污染。</p>
<p>示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式一</span></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;立即执行函数&#x27;</span>)</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">//方式二</span></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;立即执行函数&#x27;</span>)</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure>

<p>注：立即执行函数也可以加函数名。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> <span class="title function_">print</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;立即执行函数&#x27;</span>)</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure>

<h1 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h1><blockquote>
<p>对象是 JavaScript 数据类型的一种，之前已经学习了数值类型、字符串类型、布尔类型、undefined。对象数据类型可以被理解成是一种数据集合。它由属性和方法两部分构成。</p>
</blockquote>
<h2 id="对象介绍"><a href="#对象介绍" class="headerlink" title="对象介绍"></a>对象介绍</h2><p>声明一个对象类型的变量与之前声明一个数值或字符串类型的变量没有本质上的区别。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明字符串类型变量</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&#x27;hello world!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明数值类型变量</span></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">199</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明对象类型变量，使用一对花括号</span></span><br><span class="line"><span class="comment">// user 便是一个对象了，目前它是一个空对象</span></span><br><span class="line"><span class="keyword">let</span> user = &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>对象有属性和方法组成。</p>
<ol>
<li>属性：信息或叫特征（名词）。</li>
<li>方法：功能或叫行为（动词）。</li>
</ol>
<h2 id="对象属性"><a href="#对象属性" class="headerlink" title="对象属性"></a>对象属性</h2><h3 id="对象属性定义"><a href="#对象属性定义" class="headerlink" title="对象属性定义"></a>对象属性定义</h3><p>数据描述性的信息称为属性，如人的姓名、身高、年龄、性别等，一般是名词性的。</p>
<ol>
<li>属性都是成对出现的，包括属性名和值，它们之间使用英文 <code>:</code> 分隔</li>
<li>多个属性之间使用英文 <code>,</code> 分隔</li>
<li>属性就是依附在对象上的变量</li>
<li>属性名可以使用 <code>&quot;&quot;</code> 或 <code>&#39;&#39;</code>，<strong>一般情况下省略</strong>，除非名称遇到特殊符号如空格、中横线等</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过对象描述一个人的数据信息</span></span><br><span class="line"><span class="comment">// person 是一个对象，它包含了一个属性 name</span></span><br><span class="line"><span class="comment">// 属性都是成对出现的，属性名和值，它们之间使用英文:分隔</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;小明&#x27;</span>, <span class="comment">// 描述人的姓名</span></span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>, <span class="comment">// 描述人的年龄</span></span><br><span class="line">  <span class="attr">stature</span>: <span class="number">185</span>, <span class="comment">// 描述人的身高</span></span><br><span class="line">  <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span>, <span class="comment">// 描述人的性别</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="对象属性操作"><a href="#对象属性操作" class="headerlink" title="对象属性操作"></a>对象属性操作</h3><p><strong>查询</strong></p>
<p>声明对象，并添加了若干属性后，可以使用 <code>.</code> 或 <code>[]</code> 获得对象中属性对应的值，我称之为属性访问。</p>
<p>语法：<code>对象名.属性</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">uname</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 访问人的名字</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">uname</span>) <span class="comment">//小明</span></span><br><span class="line"><span class="comment">// 访问人性别</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">gender</span>) <span class="comment">//男</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person[<span class="string">&#x27;gender&#x27;</span>]) <span class="comment">//男</span></span><br></pre></td></tr></table></figure>

<p><strong>增加</strong></p>
<p>语法：<code>对象名.新属性 = 新值</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">uname</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//增加age属性</span></span><br><span class="line">person.<span class="property">age</span> = <span class="number">18</span></span><br></pre></td></tr></table></figure>

<p><strong>修改</strong></p>
<p>语法：<code>对象名.属性 = 新值</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明一个空的对象（没有任何属性）</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;&#125;</span><br><span class="line"><span class="comment">// 动态追加属性</span></span><br><span class="line">person.<span class="property">uname</span> = <span class="string">&#x27;小明&#x27;</span></span><br><span class="line">person[<span class="string">&#x27;age&#x27;</span>] = <span class="number">18</span></span><br></pre></td></tr></table></figure>

<p><strong>删除</strong></p>
<p>语法：<code>delete 对象名.属性</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">uname</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除gender属性</span></span><br><span class="line"><span class="keyword">delete</span> person.<span class="property">gender</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person)</span><br></pre></td></tr></table></figure>

<h2 id="对象方法"><a href="#对象方法" class="headerlink" title="对象方法"></a>对象方法</h2><h3 id="对象方法定义"><a href="#对象方法定义" class="headerlink" title="对象方法定义"></a>对象方法定义</h3><p>数据行为性的信息称为方法，如跑步、唱歌等，一般是动词性的，其本质是函数。</p>
<ol>
<li>方法是由方法名和函数两部分构成，它们之间使用<code>:</code>分隔</li>
<li>多个属性之间使用英文 <code>,</code> 分隔</li>
<li>方法是依附在对象中的函数</li>
<li>方法名可以使用 <code>&quot;&quot;</code> 或 <code>&#39;&#39;</code>，一般情况下省略，除非名称遇到特殊符号如空格、中横线等</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法是依附在对象上的函数</span></span><br><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;小红&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// 方法是由方法名和函数两部分构成，它们之间使用 : 分隔</span></span><br><span class="line">  <span class="attr">sayHi</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hi&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用对象中sayHi方法，并且增删改查类似对象属性操作</span></span><br><span class="line">person.<span class="title function_">sayHi</span>()</span><br></pre></td></tr></table></figure>

<h3 id="遍历对象"><a href="#遍历对象" class="headerlink" title="遍历对象"></a>遍历对象</h3><p>对象里面是无序的键值对，没有规律，不像数组里有规律的下标。</p>
<p>数组遍历示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&#x27;pink&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;red&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> colors) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i);    <span class="comment">//输出数组下标，是字符串类型</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(colors[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>for in</code>  不提倡遍历数组因为 <code>i</code> 是 字符串。</p>
<p>对象遍历示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;</span><br><span class="line">    <span class="attr">uname</span>: <span class="string">&#x27;小明&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;男&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> person) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key)  <span class="comment">//输出属性名 是字符串类型</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">key</span>)  <span class="comment">//错误 person.&#x27;uname&#x27;</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(person[key])  <span class="comment">//正确输出值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="null对象"><a href="#null对象" class="headerlink" title="null对象"></a>null对象</h3><p><code>null</code> 也是 JavaScript 中数据类型的一种，通常只用它来表示不存在的对象。使用 typeof 检测类型它的类型时，结果为 <code>object</code>。</p>
<h2 id="内置对象"><a href="#内置对象" class="headerlink" title="内置对象"></a>内置对象</h2><h3 id="数学对象"><a href="#数学对象" class="headerlink" title="数学对象"></a>数学对象</h3><p><code>Math</code> 是 JavaScript 中内置的对象，称为数学对象，这个对象下即包含了属性，也包含了许多的方法。</p>
<p><strong>属性和方法</strong></p>
<table>
<thead>
<tr>
<th>方法&#x2F;属性</th>
<th>作用</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>PI</td>
<td>获取圆周率</td>
<td></td>
</tr>
<tr>
<td>random()</td>
<td>生成 0 到 1 间的随机数</td>
<td>包含 0 不包含 1</td>
</tr>
<tr>
<td>ceil()</td>
<td>数字向上取整</td>
<td>舍弃小数部分，整数部分加1</td>
</tr>
<tr>
<td>floor()</td>
<td>数字向下取整</td>
<td>舍弃小数部分，整数部分不变</td>
</tr>
<tr>
<td>round()</td>
<td>四舍五入取整</td>
<td></td>
</tr>
<tr>
<td>max()</td>
<td>在一组数中找出最大值</td>
<td></td>
</tr>
<tr>
<td>min()</td>
<td>在一组数中找出最小值</td>
<td></td>
</tr>
<tr>
<td>pow()</td>
<td>幂方法</td>
<td></td>
</tr>
<tr>
<td>sqrt()</td>
<td>平方根</td>
<td></td>
</tr>
</tbody></table>
<h3 id="日期对象"><a href="#日期对象" class="headerlink" title="日期对象"></a>日期对象</h3><p>JavaScript 中内置了获取系统时间的对象 <code>Date</code>，使用 <code>Date</code> 时与之前学习的内置对象 <code>console</code> 和 <code>Math</code> 不同，它需要借助 <code>new</code> 关键字才能使用。</p>
<p><strong>实例化</strong></p>
<p>一般使用 <code>new</code> 关键字，这个操作称为实例化。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实例化</span></span><br><span class="line"><span class="keyword">const</span> curDate = <span class="keyword">new</span> <span class="title class_">Date</span>(); <span class="comment">// 系统当前时间</span></span><br><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2020-05-01&#x27;</span>) <span class="comment">// 指定时间</span></span><br></pre></td></tr></table></figure>

<p><strong>方法</strong></p>
<p>日期对象返回的数据有时候不能使用，需要转换成开发中常用的格式。</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>作用</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>getFullYear()</td>
<td>获取年份</td>
<td>获取四位年份</td>
</tr>
<tr>
<td>getMonth()</td>
<td>获取月份</td>
<td>取值为 0 ~ 11</td>
</tr>
<tr>
<td>getDate()</td>
<td>获取月份中的每一天</td>
<td>不同月份取值也不相同</td>
</tr>
<tr>
<td>getDay()</td>
<td>获取星期</td>
<td>取值为 0 ~ 6</td>
</tr>
<tr>
<td>getHours()</td>
<td>获取小时</td>
<td>取值为 0 ~ 23</td>
</tr>
<tr>
<td>getMinutes()</td>
<td>获取分钟</td>
<td>取值为 0 ~ 59</td>
</tr>
<tr>
<td>getSeconds()</td>
<td>获取秒</td>
<td>取值为 0 ~ 59</td>
</tr>
</tbody></table>
<p><strong>时间戳</strong></p>
<p>时间戳是指1970年01月01日00时00分00秒起至现在的总秒数或毫秒数，它是一种特殊的计量时间的方式。</p>
<p>注：JavaScript 中时间戳是以毫秒计的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"><span class="comment">// 获取时间戳</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(date.<span class="title function_">getTime</span>())</span><br><span class="line"><span class="comment">// 还有一种获取时间戳的方法</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(+<span class="keyword">new</span> <span class="title class_">Date</span>())</span><br><span class="line"><span class="comment">// 还有一种获取时间戳的方法，该方法只能获取当前时间戳</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>())</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://fang0407.github.io/2023/12/28/CSS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Fang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="NOTE">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | NOTE">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/12/28/CSS/" class="post-title-link" itemprop="url">CSS</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-12-28 18:50:40" itemprop="dateCreated datePublished" datetime="2023-12-28T18:50:40+08:00">2023-12-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-16 18:48:56" itemprop="dateModified" datetime="2024-01-16T18:48:56+08:00">2024-01-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CSS/" itemprop="url" rel="index"><span itemprop="name">CSS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="CSS介绍"><a href="#CSS介绍" class="headerlink" title="CSS介绍"></a>CSS介绍</h1><p>层叠样式表（Cascading Style Sheets，缩写为 CSS），是一种样式表语言，<strong>用来描述 HTML 文档的呈现</strong>（美化内容）。</p>
<p>书写位置：<code>title</code> 标签下方添加 <code>style</code> 双标签，<code>style</code> 标签里面书写 <code>CSS</code> 代码。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>CSS 示例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="comment">/*CSS 代码*/</span></span></span><br><span class="line"><span class="language-css">      <span class="comment">/*选择器 &#123;CSS 属性&#125;*/</span></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>CSS 介绍<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="CSS引入方式"><a href="#CSS引入方式" class="headerlink" title="CSS引入方式"></a>CSS引入方式</h1><h2 id="内部样式表"><a href="#内部样式表" class="headerlink" title="内部样式表"></a>内部样式表</h2><ul>
<li><p>学习使用。</p>
</li>
<li><p><code>CSS</code> 代码在 <code>style</code> 里面</p>
</li>
</ul>
<h2 id="外部样式表"><a href="#外部样式表" class="headerlink" title="外部样式表"></a>外部样式表</h2><ul>
<li><p>开发使用</p>
</li>
<li><p><code>CSS</code> 代码单独写在 <code>.css</code> 文件中</p>
</li>
<li><p>在 <code>HTML</code> 中使用 <code>link</code> 标签引入</p>
</li>
<li><p><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;./css.css&quot;&gt;</code></p>
</li>
</ul>
<p><code>.html</code> 文件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>CSS 引入方式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./css.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>CSS 引入方式<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>.css</code> 文件：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="行内样式"><a href="#行内样式" class="headerlink" title="行内样式"></a>行内样式</h2><ul>
<li><p>配合 <code>JavaScript</code> 使用</p>
</li>
<li><p><code>CSS</code> 写在标签的 <code>style</code> 属性值里面</p>
</li>
<li><p><code>&lt;div style=&quot;color:red;font-size:30px;&quot;&gt;这是div标签&lt;/div&gt;</code></p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>CSS 引入方式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;color: red;font-size: 30px;&quot;</span>&gt;</span>CSS 引入方式<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="基本选择器"><a href="#基本选择器" class="headerlink" title="基本选择器"></a>基本选择器</h1><p>作用：<strong>查找标签</strong>，设置样式。</p>
<p>基本选择器：</p>
<ul>
<li>标签选择器</li>
<li>类选择器</li>
<li>id 选择器</li>
<li>通配符选择器</li>
</ul>
<h2 id="标签选择器"><a href="#标签选择器" class="headerlink" title="标签选择器"></a>标签选择器</h2><p>作用：使用<strong>标签名</strong>作为选择器，选中<strong>同名标签设置相同样式</strong>。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>段落1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>段落2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="类选择器"><a href="#类选择器" class="headerlink" title="类选择器"></a>类选择器</h2><p>作用：查找标签，<strong>差异化</strong>设置标签的显示效果。</p>
<p>步骤：</p>
<ul>
<li>定义类选择器（.类名）</li>
<li>使用类选择器（标签添加 class&#x3D;”类名”）</li>
</ul>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.red</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.size</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;red&quot;</span>&gt;</span>段落1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;size&quot;</span>&gt;</span>段落2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;red size&quot;</span>&gt;</span>段落3<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注：</p>
<ul>
<li><strong>一个类选择器可以给多个标签使用</strong></li>
<li><strong>一个标签可以使用多个类名</strong>，class 属性值写多个类名，<strong>多个类名使用空格隔开</strong></li>
<li>类名自定义，<strong>不要用纯数字或中文</strong>，尽量用英文命名，类名多个单词可以用<code>-</code>进行连接，例如：<code>news-hd</code></li>
</ul>
<h2 id="id选择器"><a href="#id选择器" class="headerlink" title="id选择器"></a>id选择器</h2><p>作用：查找标签，<strong>差异化</strong>设置标签的显示效果。</p>
<p>场景：<code>id</code> 选择器一般配合 <code>JavaScript</code> 使用，很少用来设置 <code>CSS</code> 样式。</p>
<p>步骤：</p>
<ul>
<li>定义 id 选择器（#id名）</li>
<li>使用 id 选择器（标签添加id&#x3D;”id名”）</li>
</ul>
<p>规则：同一个 <code>id</code> 选择器在一个页面只能使用一次。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#red</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;red&quot;</span>&gt;</span>段落1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="通配符选择器"><a href="#通配符选择器" class="headerlink" title="通配符选择器"></a>通配符选择器</h2><p>作用：查找页面<strong>所有标签</strong>，设置相同样式。</p>
<p>通配符选择器：<code>*</code>，不需要调用，浏览器自动查找页面所有标签，设置相同样式。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>p 标签<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>div 标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>h2 标签<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="文字控制属性"><a href="#文字控制属性" class="headerlink" title="文字控制属性"></a>文字控制属性</h1><p>常见文字控制属性：</p>
<table>
<thead>
<tr>
<th>描述</th>
<th>属性</th>
</tr>
</thead>
<tbody><tr>
<td>字体大小</td>
<td>font-size</td>
</tr>
<tr>
<td>字体粗细</td>
<td>font-weight</td>
</tr>
<tr>
<td>字体倾斜</td>
<td>font-style</td>
</tr>
<tr>
<td>行高</td>
<td>line-height</td>
</tr>
<tr>
<td>字体族</td>
<td>font-family</td>
</tr>
<tr>
<td>字体复合属性</td>
<td>font</td>
</tr>
<tr>
<td>文本缩进</td>
<td>text-indent</td>
</tr>
<tr>
<td>文本对齐</td>
<td>text-alian</td>
</tr>
<tr>
<td>修饰线</td>
<td>text-decoration</td>
</tr>
<tr>
<td>颜色</td>
<td>color</td>
</tr>
</tbody></table>
<h2 id="字体大小"><a href="#字体大小" class="headerlink" title="字体大小"></a>字体大小</h2><p>属性名：<code>font-size</code></p>
<p>属性值：文字尺寸，<code>PC</code> 端网页最常用的单位是 <code>px</code>。</p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="字体粗细"><a href="#字体粗细" class="headerlink" title="字体粗细"></a>字体粗细</h2><p>属性名：<code>font-weight</code></p>
<p>属性值：</p>
<ul>
<li>关键字写法</li>
</ul>
<table>
<thead>
<tr>
<th>属性值</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td>normal</td>
<td>正常</td>
</tr>
<tr>
<td>bold</td>
<td>加粗</td>
</tr>
</tbody></table>
<ul>
<li>数字写法：100 - 900 逐渐加粗。</li>
</ul>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">400</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="字体倾斜"><a href="#字体倾斜" class="headerlink" title="字体倾斜"></a>字体倾斜</h2><p>作用：清楚文字默认的倾斜效果。</p>
<p>属性名：<code>font-style</code></p>
<p>属性值：</p>
<table>
<thead>
<tr>
<th>属性值</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td>normal</td>
<td>正常</td>
</tr>
<tr>
<td>italic</td>
<td>倾斜</td>
</tr>
</tbody></table>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">font-style</span>: normal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="行高"><a href="#行高" class="headerlink" title="行高"></a>行高</h2><p>作用：设置多行文本的间距。</p>
<p>属性名：<code>line-height</code></p>
<p>属性值：</p>
<ul>
<li>数字 + <code>px</code></li>
<li>数字（当前标签 <code>font-size</code> 属性值的倍数）</li>
</ul>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">2</span>; <span class="comment">/* 40px */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>垂直居中技巧：行高属性值等于盒子高度属性值。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.div1</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: skyblue;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">line-height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;div1&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="字体族"><a href="#字体族" class="headerlink" title="字体族"></a>字体族</h2><p>属性名：<code>font-family</code></p>
<p>属性值：字体名</p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: 楷体;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>了解：<code>font-family</code> 属性值可以书写多个字体名，各个字体名用<strong>逗号</strong>隔开，执行顺序是从左向右依次查找。</p>
<h2 id="字体复合属性"><a href="#字体复合属性" class="headerlink" title="字体复合属性"></a>字体复合属性</h2><p>属性名： <code>font</code></p>
<p>复合属性：属性的简写方式，一个属性对应多个值的写法，各个属性值之间用空格隔开。</p>
<p>使用场景：设置网页文字公共样式。</p>
<p>注意：<strong>字号和字体值必须书写</strong>，否则 <code>font</code> 属性不生效。</p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="comment">/*font: 是否倾斜 是否加粗 字号/行高 字体;*/</span></span><br><span class="line">    <span class="attribute">font</span>: italic <span class="number">700</span> <span class="number">30px</span>/<span class="number">2</span> 楷体   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">font</span>: <span class="number">30px</span> 楷体;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="文本缩进"><a href="#文本缩进" class="headerlink" title="文本缩进"></a>文本缩进</h2><p>属性名：<code>text-indent</code></p>
<p>属性值：</p>
<ul>
<li>数字 + px</li>
<li>数字 + em（推荐：1em&#x3D;当前标签的字号大小）</li>
</ul>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">text-indent</span>: <span class="number">2em</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="文本对齐"><a href="#文本对齐" class="headerlink" title="文本对齐"></a>文本对齐</h2><p>作用：控制内容水平对齐方式。</p>
<p>属性名：<code>text-alian</code></p>
<p>属性值：</p>
<table>
<thead>
<tr>
<th>属性值</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td>left</td>
<td>左对齐（默认）</td>
</tr>
<tr>
<td>center</td>
<td>居中对齐</td>
</tr>
<tr>
<td>right</td>
<td>右对齐</td>
</tr>
</tbody></table>
<p>注意：<strong>控制的是内容对齐方式</strong>，不是标签。</p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    text-alian: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="修饰线"><a href="#修饰线" class="headerlink" title="修饰线"></a>修饰线</h2><p>属性名：<code>text-decoration</code></p>
<p>属性值：</p>
<table>
<thead>
<tr>
<th>属性值</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td>none</td>
<td>无</td>
</tr>
<tr>
<td>underline</td>
<td>下划线</td>
</tr>
<tr>
<td>line-through</td>
<td>删除线</td>
</tr>
<tr>
<td>overline</td>
<td>上划线</td>
</tr>
</tbody></table>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="文字颜色"><a href="#文字颜色" class="headerlink" title="文字颜色"></a>文字颜色</h2><p>属性名：<code>color</code></p>
<p>属性值：</p>
<table>
<thead>
<tr>
<th>颜色表示方式</th>
<th>属性值</th>
<th>说明</th>
<th>使用场景</th>
</tr>
</thead>
<tbody><tr>
<td>颜色关键字</td>
<td>颜色英文单词</td>
<td>red、green、blue</td>
<td>学习测试</td>
</tr>
<tr>
<td>rgb表示法</td>
<td>rgb(r, g, b)</td>
<td>r, g, b表示红绿蓝三原色，取值：0 - 255</td>
<td>了解</td>
</tr>
<tr>
<td>reba表示法</td>
<td>reba(r, g, b, a)</td>
<td>a表示透明度，取值：0 - 1</td>
<td>开发使用，实现透明色</td>
</tr>
<tr>
<td>十六进制表示法</td>
<td>#RRGGBB</td>
<td>#000000, #ffcc00；简写：#000, #fc0</td>
<td>开发使用</td>
</tr>
</tbody></table>
<h1 id="复合选择器"><a href="#复合选择器" class="headerlink" title="复合选择器"></a>复合选择器</h1><p>定义：由<strong>两个或多个基础选择器</strong>，通过不同的方式组合而成。</p>
<p>作用：更准确、更高效的选择目标元素（标签）。</p>
<p>复合选择器：</p>
<ul>
<li>后代选择器</li>
<li>子代选择器</li>
<li>并集选择器</li>
<li>交集选择器</li>
</ul>
<h2 id="后代选择器"><a href="#后代选择器" class="headerlink" title="后代选择器"></a>后代选择器</h2><p>后代选择器：选中某元素的<strong>后代</strong>元素。</p>
<p>选择器写法：<code>父选择器 子选择器&#123;CSS 属性&#125;</code>；父子选择器之间用<strong>空格</strong>隔开。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span> div标签中的span标签 <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span> div标签中的p标签的span标签 <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="子代选择器"><a href="#子代选择器" class="headerlink" title="子代选择器"></a>子代选择器</h2><p>子代选择器：选中某元素的<strong>子代</strong>元素。</p>
<p>选择器写法：<code>父选择器 &gt; 子选择器&#123;CSS 属性&#125;</code>；父子选择器之间用<code>&gt;</code>隔开。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span> &gt; <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span> div标签中的span标签 <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span> div标签中的p标签的span标签<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="并集选择器"><a href="#并集选择器" class="headerlink" title="并集选择器"></a>并集选择器</h2><p>并集选择器：选中<strong>多组</strong>标签设置<strong>相同</strong>样式。</p>
<p>选择器写法：<code>选择器1,选择器2,...,选择器N&#123;CSS 属性&#125;</code>，选择器之间用<code>,</code>隔开。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span>,</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">p</span>,</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>p标签<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span> span标签 <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="交集选择器"><a href="#交集选择器" class="headerlink" title="交集选择器"></a>交集选择器</h2><p>交集选择器：选中同时满足<strong>多个条件</strong>的元素。</p>
<p>选择器写法：<code>选择器1选择器2&#123;CSS 属性&#125;</code>；选择器之间连写没有任何符号。</p>
<p>注意：如果交集选择器中有标签选择器，<strong>标签选择器必须书写在最前面</strong>。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">p</span><span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>p标签1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>p标签2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="伪选择器"><a href="#伪选择器" class="headerlink" title="伪选择器"></a>伪选择器</h1><p>伪类与伪元素<strong>都属于伪选择器</strong>；都是为了<strong>改变样式</strong>而存在的。</p>
<p><strong>什么是伪类？</strong></p>
<p>伪类通常是添加一个实际的类，并为它添加效果；它可以通过选择器找到那些不存在DOM树中的信息，并且不能被常规CSS选择器找到的信息。一般之前会添加一个冒号表示这是一个伪类。</p>
<p><strong>什么是伪元素？</strong></p>
<p>伪元素类似于添加一个实际的元素，完成普通选择器不能完成的工作；本身是基于元素的抽象，并不存在于文档结构中。一般之前会添加两个冒号表示这是一个伪选择器。</p>
<h2 id="伪类选择器"><a href="#伪类选择器" class="headerlink" title="伪类选择器"></a>伪类选择器</h2><p>作用：伪类选择器用于像某些<strong>元素添加特殊效果</strong>，比如第一个元素、某个元素的子元素、鼠标滑过的元素。</p>
<p>伪类选择器：</p>
<ul>
<li>动态伪类选择器</li>
<li>结构伪类选择器</li>
</ul>
<h3 id="状态伪类选择器"><a href="#状态伪类选择器" class="headerlink" title="状态伪类选择器"></a>状态伪类选择器</h3><p>作用：选中元素的某个状态设置样式。</p>
<p>选择器写法（鼠标悬停状态 <code>hover</code>）：<code>选择器:hover&#123;CSS 属性&#125;</code></p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>超链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>拓展：伪类-超链接</p>
<p>超链接一共四个状态。</p>
<table>
<thead>
<tr>
<th>选择器</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>:link</td>
<td>访问前</td>
</tr>
<tr>
<td>:visited</td>
<td>访问后</td>
</tr>
<tr>
<td>:hover</td>
<td>鼠标悬停</td>
</tr>
<tr>
<td>:active</td>
<td>点击时</td>
</tr>
</tbody></table>
<p>提示：如果要给超链接设置以上四个状态，需要按 <code>LVHA</code> 的顺序书写。</p>
<h3 id="结构伪类选择器"><a href="#结构伪类选择器" class="headerlink" title="结构伪类选择器"></a>结构伪类选择器</h3><p>作用：根据元素的<strong>结构关系</strong>查找元素。</p>
<table>
<thead>
<tr>
<th>选择器</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>E:first-child</td>
<td>查找第一个 E 元素</td>
</tr>
<tr>
<td>E:last-child</td>
<td>查找最后一个 E 元素</td>
</tr>
<tr>
<td>E:nth-child(N)</td>
<td>查找第 N 个 E 元素（第一个元素 N 值为 1）</td>
</tr>
</tbody></table>
<p><code>:nth-child(公式)</code>：可以根据元素的结构关系查找多个元素。</p>
<table>
<thead>
<tr>
<th>功能</th>
<th>公式</th>
</tr>
</thead>
<tbody><tr>
<td>偶数标签</td>
<td>2n</td>
</tr>
<tr>
<td>奇数标签</td>
<td>2n+1; 2n-1</td>
</tr>
<tr>
<td>找到5的倍数的标签</td>
<td>5n</td>
</tr>
<tr>
<td>找到第5个以后的标签</td>
<td>n+5</td>
</tr>
<tr>
<td>找到第5个以前的标签</td>
<td>-n+5</td>
</tr>
</tbody></table>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">li</span><span class="selector-pseudo">:first</span>-child &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">li</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: orange;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">li</span><span class="selector-pseudo">:last-child</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: green;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>li 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>li 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>li 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>li 4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="伪元素选择器"><a href="#伪元素选择器" class="headerlink" title="伪元素选择器"></a>伪元素选择器</h2><p>作用：创建<strong>虚拟</strong>元素（伪元素），用来摆放装饰性内容。</p>
<table>
<thead>
<tr>
<th>选择器</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>E::before</td>
<td>在 E 元素里面最前面添加一个伪元素</td>
</tr>
<tr>
<td>E::after</td>
<td>在 E 元素里面最后面添加一个伪元素</td>
</tr>
</tbody></table>
<p>注意：</p>
<ul>
<li><strong>必须</strong>设置<code>content:&quot;&quot;</code>属性，用来设置伪元素内容，如果没有内容，则引号留空即可</li>
<li>伪元素默认是<strong>行内</strong>显示模式</li>
<li>权重和标签选择器相同</li>
</ul>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">content</span>: <span class="string">&quot;老鼠&quot;</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">content</span>: <span class="string">&quot;大米&quot;</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>爱<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="CSS特性"><a href="#CSS特性" class="headerlink" title="CSS特性"></a>CSS特性</h1><p>CSS 特性：化简代码 &#x2F; 定位问题，解决问题。</p>
<ul>
<li>继承性</li>
<li>层叠性</li>
<li>优先级</li>
</ul>
<h2 id="继承性"><a href="#继承性" class="headerlink" title="继承性"></a>继承性</h2><p>继承性：子级默认继承父级的<strong>文字控制属性</strong>。</p>
<p>注意：如果标签自身有样式则生效自身的样式，不继承。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-weight</span>: <span class="number">100</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">line-height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>超链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>p标签<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="层叠性"><a href="#层叠性" class="headerlink" title="层叠性"></a>层叠性</h2><p>层叠性特点：</p>
<ul>
<li>相同的属性会<strong>覆盖</strong>：后面的 CSS 属性覆盖<strong>前面</strong>的 CSS 属性。</li>
<li>不同的属性会<strong>叠加</strong>：不同的 CSS 属性<strong>都生效</strong>。</li>
</ul>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-weight</span>: <span class="number">800</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>p标签<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h2><p>优先级：也叫权重，当一个标签使用了多种选择器时，基于不同种类的选择器的<strong>匹配规则</strong>。</p>
<p>规则：<strong>选择器优先级高的样式生效</strong>。</p>
<p>公式：通配符选择器 &lt; 标签选择器 &lt; 类选择器 &lt; id选择器 &lt; 行内样式 &lt; !important（即<strong>选中的范围越大，优先级越低</strong>）</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: green <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: black;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: orange;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span> , <span class="attr">id</span>=<span class="string">&quot;box&quot;</span> , <span class="attr">style</span>=<span class="string">&quot;color: pink&quot;</span>&gt;</span>div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>叠加计算规则：如果是<strong>复合选择器</strong>，则需要权重叠加计算。</p>
<p>规则：（行内样式，id选择器个数，类选择器个数，标签选择器个数）</p>
<ul>
<li>从左向右依次比较选个数，同一级个数多的优先级高，如果个数相同，则向后比较</li>
<li><code>!important</code> 权重最高</li>
<li>继承权重最低</li>
</ul>
<p>示例代码：</p>
<p>计算选择器个数：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.c1</span> <span class="selector-class">.c2</span> <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span> <span class="selector-id">#box3</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="language-css">      &#125;        </span></span><br><span class="line"><span class="language-css">      <span class="comment">/*优先级最高*/</span></span></span><br><span class="line"><span class="language-css">      <span class="selector-id">#box1</span> <span class="selector-class">.c3</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: orange;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;box1&quot;</span> , <span class="attr">class</span>=<span class="string">&quot;c1&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;box2&quot;</span> , <span class="attr">class</span>=<span class="string">&quot;c2&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;box3&quot;</span> , <span class="attr">class</span>=<span class="string">&quot;c3&quot;</span>&gt;</span>div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>继承优先级最低：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;p&quot;</span>&gt;</span>文字<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="背景属性"><a href="#背景属性" class="headerlink" title="背景属性"></a>背景属性</h1><table>
<thead>
<tr>
<th>描述</th>
<th>属性</th>
</tr>
</thead>
<tbody><tr>
<td>背景色</td>
<td>background-color</td>
</tr>
<tr>
<td>背景图</td>
<td>background-image</td>
</tr>
<tr>
<td>背景图平铺方式</td>
<td>background-repeat</td>
</tr>
<tr>
<td>背景图位置</td>
<td>background-position</td>
</tr>
<tr>
<td>背景图缩放</td>
<td>background-size</td>
</tr>
<tr>
<td>背景图固定</td>
<td>background-attachment</td>
</tr>
<tr>
<td>背景复合属性</td>
<td>background</td>
</tr>
</tbody></table>
<h2 id="背景色"><a href="#背景色" class="headerlink" title="背景色"></a>背景色</h2><p>属性名：<code>background-color</code></p>
<p>属性值：</p>
<table>
<thead>
<tr>
<th>颜色表示方式</th>
<th>属性值</th>
<th>说明</th>
<th>使用场景</th>
</tr>
</thead>
<tbody><tr>
<td>颜色关键字</td>
<td>颜色英文单词</td>
<td>red、green、blue</td>
<td>学习测试</td>
</tr>
<tr>
<td>rgb表示法</td>
<td>rgb(r, g, b)</td>
<td>r, g, b表示红绿蓝三原色，取值：0 - 255</td>
<td>了解</td>
</tr>
<tr>
<td>reba表示法</td>
<td>reba(r, g, b, a)</td>
<td>a表示透明度，取值：0 - 1</td>
<td>开发使用，实现透明色</td>
</tr>
<tr>
<td>十六进制表示法</td>
<td>#RRGGBB</td>
<td>#000000, #ffcc00；简写：#000, #fc0</td>
<td>开发使用</td>
</tr>
</tbody></table>
<h2 id="背景图"><a href="#背景图" class="headerlink" title="背景图"></a>背景图</h2><p>作用：网页中，使用背景图实现装饰性的图片效果。</p>
<p>属性名：<code>background-image</code>，默认是平铺效果。</p>
<p>属性值：url(背景图 URL)</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">400</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">400</span>;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">./image.png</span>);</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="背景图平铺方式"><a href="#背景图平铺方式" class="headerlink" title="背景图平铺方式"></a>背景图平铺方式</h2><p>属性名：<code>background-repeat</code></p>
<p>属性值：</p>
<table>
<thead>
<tr>
<th>属性值</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td>no-repeat</td>
<td>不平铺</td>
</tr>
<tr>
<td>repeat</td>
<td>平铺（默认效果）</td>
</tr>
<tr>
<td>repeat-x</td>
<td>水平方向平铺</td>
</tr>
<tr>
<td>repeat-y</td>
<td>竖直方向平铺</td>
</tr>
</tbody></table>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;    </span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">./image.png</span>);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="背景图位置"><a href="#背景图位置" class="headerlink" title="背景图位置"></a>背景图位置</h2><p>属性名：<code>background-position</code></p>
<p>属性值：水平方向位置 垂直方向位置</p>
<ul>
<li>关键字写法</li>
</ul>
<table>
<thead>
<tr>
<th>属性值</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td>left</td>
<td>左侧</td>
</tr>
<tr>
<td>right</td>
<td>右侧</td>
</tr>
<tr>
<td>center</td>
<td>居中</td>
</tr>
<tr>
<td>top</td>
<td>顶部</td>
</tr>
<tr>
<td>button</td>
<td>底部</td>
</tr>
</tbody></table>
<ul>
<li>坐标（数字+px，正负都可以）<ul>
<li>水平：正数向右；负数向左</li>
<li>垂直：正数向下；负数向上</li>
</ul>
</li>
</ul>
<p>提示：</p>
<ul>
<li><strong>关键字</strong>取值方式写法，可以<strong>颠倒</strong>取值顺序</li>
<li>只写一个关键字，另一个方向<strong>默认居中</strong>；数字只写一个值表示<strong>水平方向</strong>，<strong>垂直方向为居中</strong></li>
</ul>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">background</span>: pink;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">./image.png</span>);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-position</span>: left top;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="背景图缩放"><a href="#背景图缩放" class="headerlink" title="背景图缩放"></a>背景图缩放</h2><p>属性名：<code>background-size</code></p>
<p>属性值：</p>
<ul>
<li>关键字写法</li>
</ul>
<table>
<thead>
<tr>
<th>属性值</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td>cover</td>
<td>等比例缩放背景图片以完全覆盖背景区，可能背景图片部分看不见</td>
</tr>
<tr>
<td>contain</td>
<td>等比例缩放背景图片以完全装入背景区，可能背景区部分空白</td>
</tr>
</tbody></table>
<ul>
<li>百分比写法：根据盒子尺寸计算图片大小</li>
<li>数字+单位写法：例如：px</li>
</ul>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">background</span>: pink;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">./image.png</span>);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-size</span>: cover;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="背景图固定"><a href="#背景图固定" class="headerlink" title="背景图固定"></a>背景图固定</h2><p>作用：背景不会随着元素的内容滚动。</p>
<p>属性名：<code>background-attachment</code></p>
<p>属性值：<code>fixed</code></p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">background</span>: pink;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">./image.png</span>);</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-attachment</span>: fixed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="背景复合属性"><a href="#背景复合属性" class="headerlink" title="背景复合属性"></a>背景复合属性</h2><p>属性名：<code>background</code></p>
<p>属性值：背景色 背景图 背景图平铺方式 背景图位置&#x2F;背景图缩放 背景图固定（空格隔开各个属性值，不区分顺序）</p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">background</span>: pink <span class="built_in">url</span>(<span class="string">./image.png</span>) no-repeat center button/cover fixed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="显示模式"><a href="#显示模式" class="headerlink" title="显示模式"></a>显示模式</h1><p>显示模式：标签（元素）的显示方式。</p>
<p>作用：布局网页的时候，根据标签的显示模式选择合适的标签摆放位置。</p>
<h2 id="块级元素"><a href="#块级元素" class="headerlink" title="块级元素"></a>块级元素</h2><ul>
<li>典型标签 <code>div</code></li>
<li><strong>独占一行</strong></li>
<li>宽度默认是父级的100%</li>
<li>设置<strong>宽高属性生效</strong></li>
</ul>
<h2 id="行内元素"><a href="#行内元素" class="headerlink" title="行内元素"></a>行内元素</h2><ul>
<li><p>典型标签 <code>span</code></p>
</li>
<li><p><strong>一行可以显示多个</strong></p>
</li>
<li><p>设置<strong>宽高属性不生效</strong></p>
</li>
<li><p>宽高尺寸由<strong>内容撑开</strong></p>
</li>
</ul>
<h2 id="行内块元素"><a href="#行内块元素" class="headerlink" title="行内块元素"></a>行内块元素</h2><ul>
<li>典型标签 <code>img</code></li>
<li><strong>一行可以显示多个</strong></li>
<li>设置<strong>宽高属性生效</strong></li>
<li>宽高尺寸也可以由<strong>内容撑开</strong></li>
</ul>
<h2 id="转换显示模式"><a href="#转换显示模式" class="headerlink" title="转换显示模式"></a>转换显示模式</h2><p>属性名：<code>display</code></p>
<p>属性值：</p>
<table>
<thead>
<tr>
<th>属性值</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td>block</td>
<td>块级</td>
</tr>
<tr>
<td>inline</td>
<td>行内</td>
</tr>
<tr>
<td>inline-block</td>
<td>行内块</td>
</tr>
</tbody></table>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="盒子模型"><a href="#盒子模型" class="headerlink" title="盒子模型"></a>盒子模型</h1><p>作用：布局网页，摆放盒子和内容。</p>
<p>组成：</p>
<ul>
<li>内容区域：<code>width&amp;height</code></li>
<li>内边距：<code>padding</code>（出现在内容与盒子边缘之间）</li>
<li>边框线：<code>border</code>（出现在盒子的边框）</li>
<li>外边距：<code>margin</code> （出现在盒子外边）</li>
</ul>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="边框线"><a href="#边框线" class="headerlink" title="边框线"></a>边框线</h2><p>属性名：<code>border</code>（简写bd）</p>
<p>属性值：边框线粗细 线条样式 颜色 （不区分顺序）</p>
<p>常用线条样式：</p>
<table>
<thead>
<tr>
<th>属性值</th>
<th>线条样式</th>
</tr>
</thead>
<tbody><tr>
<td>solid</td>
<td>实线</td>
</tr>
<tr>
<td>dashed</td>
<td>虚线</td>
</tr>
<tr>
<td>dotted</td>
<td>点线</td>
</tr>
</tbody></table>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: red;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> dashed <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>设置单方向边框线</strong></p>
<p>属性名：<code>border-方位名词</code>（简写bd+方位名词首字母，例如bdl）</p>
<p>属性值：边框线粗细 线条样式 颜色 （不区分顺序）</p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: red;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">border-right</span>: <span class="number">2px</span> dashed green;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">5px</span> dotted black;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">10px</span> solid orange;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="内边距"><a href="#内边距" class="headerlink" title="内边距"></a>内边距</h2><p>作用：设置内容与盒子边缘之间的距离。</p>
<p>属性值：<code>padding</code>&#x2F;<code>padding-方位名词</code></p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: red;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>内边距多值写法</strong></p>
<p>记忆：从上开始顺时针转一圈，如果当前方位没有数字，取值和对面一样。</p>
<table>
<thead>
<tr>
<th>示例</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>padding: 10px;</code></td>
<td>四个方向内边距均为10px</td>
</tr>
<tr>
<td><code>padding: 10px 20px 40px 80px;</code></td>
<td>上：10px；右：20px；下：40px；左：80px</td>
</tr>
<tr>
<td><code>padding: 10px 40px 80px;</code></td>
<td>上：10px；左右：40px；下：80px</td>
</tr>
<tr>
<td><code>padding: 10px 80px;</code></td>
<td>上下：10px；左右：80px</td>
</tr>
</tbody></table>
<p><strong>尺寸计算</strong></p>
<ul>
<li><p>默认情况：盒子尺寸 &#x3D; 内容尺寸 + border尺寸 + 内边距尺寸</p>
</li>
<li><p>结论：给盒子加 <code>border/padding</code>会撑大盒子</p>
</li>
<li><p>解决：</p>
<ul>
<li>手动做减法，减掉 <code>border/padding</code> 的尺寸</li>
<li>内减模式：添加属性 <code>box-sizing: border-box</code></li>
</ul>
</li>
</ul>
<h2 id="外边距"><a href="#外边距" class="headerlink" title="外边距"></a>外边距</h2><p>作用：拉开两个盒子之间的距离。</p>
<p>属性名：<code>margin</code></p>
<p>属性值：与 <code>padding</code> 属性值写法、含义相同	</p>
<p>版心居中示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: red;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="清楚默认样式"><a href="#清楚默认样式" class="headerlink" title="清楚默认样式"></a>清楚默认样式</h2><p>作用：清楚标签默认样式，比如：默认的内外边距。</p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="元素溢出"><a href="#元素溢出" class="headerlink" title="元素溢出"></a>元素溢出</h2><p>作用：控制溢出元素的内容的显示方式。</p>
<p>属性名：<code>overflow</code></p>
<p>属性值：</p>
<table>
<thead>
<tr>
<th>属性值</th>
<th>效果</th>
</tr>
</thead>
<tbody><tr>
<td>hidden</td>
<td>溢出隐藏</td>
</tr>
<tr>
<td>scroll</td>
<td>溢出滚动（无论是否溢出，都显示滚动条位置）</td>
</tr>
<tr>
<td>auto</td>
<td>溢出滚动（溢出才显示滚动条位置）</td>
</tr>
</tbody></table>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: red;</span><br><span class="line">    <span class="attribute">overflow</span>: scroll;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="外边距-合并和塌陷"><a href="#外边距-合并和塌陷" class="headerlink" title="外边距-合并和塌陷"></a>外边距-合并和塌陷</h2><h3 id="合并现象"><a href="#合并现象" class="headerlink" title="合并现象"></a>合并现象</h3><p>场景：垂直排列的兄弟元素，上下 <code>margin</code> 会合并。</p>
<p>现象：取两个 <code>margin</code> 中的<strong>较大值</strong>生效。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.box1</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.box2</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: green;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box1&quot;</span>&gt;</span>div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box2&quot;</span>&gt;</span>div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="塌陷现象"><a href="#塌陷现象" class="headerlink" title="塌陷现象"></a>塌陷现象</h3><p>场景：父子级的标签，子级的添加<strong>上外边距</strong>会产生塌陷现象。</p>
<p>现象：导致父级一起向下移动。</p>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.son</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: green;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>解决：</p>
<ul>
<li>取消子级 <code>margin</code>，父级设置 <code>padding</code></li>
</ul>
<p>示例代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding-top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.son</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: green;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>父级设置 <code>overflow: hidden</code></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.son</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: green;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>父级设置 <code>border-top</code></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: red;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#000</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.son</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: green;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-top</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="行内元素-内外边距"><a href="#行内元素-内外边距" class="headerlink" title="行内元素-内外边距"></a>行内元素-内外边距</h2><p>场景：<strong>行内</strong>元素添加 <code>margin</code> 和 <code>padding</code> ，无法改变元素<strong>垂直</strong>位置。</p>
<p>解决：给行内元素添加 <code>line-height</code> 可以改变垂直位置。</p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">100px</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="圆角"><a href="#圆角" class="headerlink" title="圆角"></a>圆角</h2><p>作用：设置元素的外边框为圆角。</p>
<p>属性名：<code>border-radius</code></p>
<p>属性值：数字+px &#x2F; 百分比</p>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: red;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>应用</strong></p>
<ul>
<li><p>正圆形状：给<strong>正方形</strong>盒子设置圆角属性值为宽高的一半 &#x2F; 50%</p>
</li>
<li><p>胶囊形状：给<strong>长方形</strong>盒子盒子圆角属性值为<strong>盒子高度的一半</strong></p>
</li>
</ul>
<h2 id="阴影"><a href="#阴影" class="headerlink" title="阴影"></a>阴影</h2><p>作用：给元素设置阴影效果。</p>
<p>属性名：<code>box-shadow</code></p>
<p>属性值：x 轴偏移量 y 轴偏移量 模糊半径 扩散半径 颜色 内外阴影</p>
<p>注意：</p>
<ul>
<li><p>x 轴偏移量和 y 轴偏移量必须书写</p>
</li>
<li><p>默认是外阴影，内阴影需要添加 <code>inset</code></p>
</li>
</ul>
<p>示例代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: red;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">2px</span> <span class="number">5px</span> <span class="number">10px</span> <span class="number">1px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="案例代码"><a href="#案例代码" class="headerlink" title="案例代码"></a>案例代码</h1><h2 id="热词"><a href="#热词" class="headerlink" title="热词"></a>热词</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>热词<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#3064bb</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">line-height</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#608dd9</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>HTML<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>CSS<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>JavaScript<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>React<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Banner效果"><a href="#Banner效果" class="headerlink" title="Banner效果"></a>Banner效果</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>banner效果<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.banner</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#f3f3f4</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">./image.png</span>);</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-repeat</span>: no-repeat;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-position</span>: left bottom;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-align</span>: right;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.banner</span> <span class="selector-tag">h2</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">36px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-weight</span>: <span class="number">400</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">line-height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.banner</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.banner</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">125px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#f06b1f</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">line-height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;banner&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>让创造产生价值<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>我们希望让每一个创作者可以传递他们的才华和创意传递给用户。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>我要报名<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span>  </span><br></pre></td></tr></table></figure>

<h2 id="产品卡片"><a href="#产品卡片" class="headerlink" title="产品卡片"></a>产品卡片</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>产品卡片<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#f1f1f1</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.product</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">50px</span> auto;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding-top</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">270px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">253px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.product</span> <span class="selector-tag">img</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.product</span> <span class="selector-tag">h4</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-bottom</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">18px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-weight</span>: <span class="number">400</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.product</span> <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#555</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;product&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./image.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h4</span>&gt;</span>应用SDK<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>包含应用软件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="新闻"><a href="#新闻" class="headerlink" title="新闻"></a>新闻</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">list-style</span>: none;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.news</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">100px</span> auto;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">360px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.news</span> <span class="selector-class">.hd</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">34px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#dbdee1</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.news</span> <span class="selector-class">.hd</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-top</span>: -<span class="number">1px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-top</span>: <span class="number">3px</span> solid <span class="number">#ff8400</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-right</span>: <span class="number">1px</span> solid <span class="number">#dbdee1</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">34px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">line-height</span>: <span class="number">32px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.news</span> <span class="selector-class">.bd</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.news</span> <span class="selector-class">.bd</span> <span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">./image1.png</span>);</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-repeat</span>: no-repeat;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-position</span>: <span class="number">0</span> center;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.news</span> <span class="selector-class">.bd</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding-left</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">./image2.png</span>) no-repeat <span class="number">0</span> center;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">line-height</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.news</span> <span class="selector-class">.bd</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#ff8400</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;news&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;hd&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>新闻<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bd&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>追着雪花看新疆｜来“温暖雪场”吃雪地火锅<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>多所学校元旦晚会花式“整活”节日氛围拉满<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>援外医疗六十载:中国援几内亚医疗队的一天<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span>出行注意 元旦假期首日 川内多条高速受大雾影响收费站关闭&lt;/a</span><br><span class="line">            &gt;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>刷身份证即可入校!北京等地多所高校官宣向社会开放校园<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Fang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"neutral","dark":"neutral"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.3.0/mermaid.min.js","integrity":"sha256-9y71g5Lz/KLsHjB8uXwnkuWDtAMDSzD/HdIbqhJfTAI="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
